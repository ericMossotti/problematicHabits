<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-02-04">

<title>Problematic Internet Habits in Children</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f4a2a43ba14ef66c805582f2b7fdaf64.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


</head>

<body class="floating slimcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataset-context" id="toc-dataset-context" class="nav-link active" data-scroll-target="#dataset-context"><span class="header-section-number">1</span> Dataset Context</a>
  <ul class="collapse">
  <li><a href="#output-notes" id="toc-output-notes" class="nav-link" data-scroll-target="#output-notes"><span class="header-section-number">1.1</span> Output Notes</a></li>
  </ul></li>
  <li><a href="#importextract" id="toc-importextract" class="nav-link" data-scroll-target="#importextract"><span class="header-section-number">2</span> Import/Extract</a></li>
  <li><a href="#establish-connection" id="toc-establish-connection" class="nav-link" data-scroll-target="#establish-connection"><span class="header-section-number">3</span> Establish Connection</a>
  <ul class="collapse">
  <li><a href="#customize-database-settings" id="toc-customize-database-settings" class="nav-link" data-scroll-target="#customize-database-settings"><span class="header-section-number">3.1</span> Customize Database Settings</a></li>
  </ul></li>
  <li><a href="#setup-database" id="toc-setup-database" class="nav-link" data-scroll-target="#setup-database"><span class="header-section-number">4</span> Setup Database</a>
  <ul class="collapse">
  <li><a href="#create-new-data-types" id="toc-create-new-data-types" class="nav-link" data-scroll-target="#create-new-data-types"><span class="header-section-number">4.1</span> Create New Data Types</a></li>
  <li><a href="#initial-extraction-transformation-and-load-pipeline" id="toc-initial-extraction-transformation-and-load-pipeline" class="nav-link" data-scroll-target="#initial-extraction-transformation-and-load-pipeline"><span class="header-section-number">4.2</span> Initial Extraction Transformation and Load Pipeline</a></li>
  </ul></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda"><span class="header-section-number">5</span> EDA</a>
  <ul class="collapse">
  <li><a href="#actigraphy-physical-and-demographics" id="toc-actigraphy-physical-and-demographics" class="nav-link" data-scroll-target="#actigraphy-physical-and-demographics"><span class="header-section-number">5.1</span> Actigraphy, Physical, and Demographics</a></li>
  </ul></li>
  <li><a href="#summary-profiles" id="toc-summary-profiles" class="nav-link" data-scroll-target="#summary-profiles"><span class="header-section-number">6</span> Summary Profiles</a></li>
  <li><a href="#close-connection" id="toc-close-connection" class="nav-link" data-scroll-target="#close-connection"><span class="header-section-number">7</span> Close Connection</a></li>
  <li><a href="#closing-thoughts" id="toc-closing-thoughts" class="nav-link" data-scroll-target="#closing-thoughts"><span class="header-section-number">8</span> Closing Thoughts</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Problematic Internet Habits in Children</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Eric Mossotti </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            None
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Objective</div>
    Explore a Kaggle dataset with an in-memory, analytical SQL database. Utilize a ‘best-of-both-worlds’ hybrid Python and R environment.
  </div>
</div>


</header>


<section id="dataset-context" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="dataset-context"><span class="header-section-number">1</span> Dataset Context</h2>
<div class="p-1 page-columns page-full">
<p>The grounds for analyses in this case is the problematic behavior as it pertains to the subjects’ experience and their parents’ via questionnaires, physical fitness tests, worn instrument measurements and demographics. The resulting data is to be processed and connections drawn. <span class="citation" data-cites="santorelli_child_2024">(<a href="#ref-santorelli_child_2024" role="doc-biblioref">Santorelli et al., 2024</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-santorelli_child_2024" class="csl-entry" role="listitem">
Santorelli, A., Zuanazzi, A., Leyden, M., Lawler, L., Devkin, M., Kotani, Y., &amp; Kiar, G. (2024). <em>Child mind institute — problematic internet use. Kaggle</em>. <a href="https://kaggle.com/competitions/child-mind-institute-problematic-internet-use">https://kaggle.com/competitions/child-mind-institute-problematic-internet-use</a>
</div></div></div>
<section id="output-notes" class="level3 page-columns page-full" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="output-notes"><span class="header-section-number">1.1</span> Output Notes</h3>
<section id="palettes" class="level4 page-columns page-full" data-number="1.1.1">
<h4 data-number="1.1.1" class="anchored" data-anchor-id="palettes"><span class="header-section-number">1.1.1</span> Palettes</h4>
<p>A notable and comprehensive R library was used to give the tables and plots some styling. <span class="citation" data-cites="hvitfeldt_paletteer_2021">(<a href="#ref-hvitfeldt_paletteer_2021" role="doc-biblioref">Hvitfeldt, 2021</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-hvitfeldt_paletteer_2021" class="csl-entry" role="listitem">
Hvitfeldt, E. (2021). <em>Paletteer: Comprehensive collection of color palettes</em>. <a href="https://github.com/EmilHvitfeldt/paletteer">https://github.com/EmilHvitfeldt/paletteer</a>
</div></div></section>
<section id="tables" class="level4 page-columns page-full" data-number="1.1.2">
<h4 data-number="1.1.2" class="anchored" data-anchor-id="tables"><span class="header-section-number">1.1.2</span> Tables</h4>
<div class="p-1 page-columns page-full">
<p>This is a means to apply formatting to every column in a table using a desired paletteer palette if desired using the gt tables. Table output were customized to a high degree. Some functional programming, in particular, are implemented here as they seem to be most appropriate to achieve the desired effect. <span class="citation" data-cites="iannone_gt_2025">(<a href="#ref-iannone_gt_2025" role="doc-biblioref">Iannone et al., 2025</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-iannone_gt_2025" class="csl-entry" role="listitem">
Iannone, R., Cheng, J., Schloerke, B., Hughes, E., Lauer, A., Seo, J., Brevoort, K., &amp; Roy, O. (2025). <em>Gt: Easily create presentation-ready display tables</em>. <a href="https://gt.rstudio.com">https://gt.rstudio.com</a>
</div></div><p>The following R script defines two functions, <em>eval_palette</em> and <em>r_table_theming</em>, which work together to create and style a table using the <em>gt</em> package. The table is customized with colors, headers, footnotes, and other visual elements.</p>
<p><strong>Features:</strong></p>
<ul>
<li><p><em>Dynamic Palette Evaluation</em>: The eval_palette function is flexible and supports multiple palette types, making it reusable for different visualization needs.</p></li>
<li><p><em>Iterative Styling</em>: The use of reduce to iteratively apply styles and footnotes is a clean and efficient approach, especially for tables with many columns or complex styling requirements.</p></li>
<li><p><em>Customizability</em>: The function allows for extensive customization, including font sizes, multiline footnotes, and targeted column coloring.</p></li>
</ul>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Table formatting code.</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paletteer)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>eval_palette <span class="ot">&lt;-</span> <span class="cf">function</span>(pal_name, <span class="at">n =</span> <span class="dv">10</span>, pal_type, <span class="at">direction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pal_type <span class="sc">==</span> <span class="st">"c"</span>) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">paletteer_c</span>(pal_name, n, direction))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (pal_type <span class="sc">==</span> <span class="st">"d"</span>) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paletteer_d</span>(pal_name, n, direction))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (pal_type <span class="sc">==</span> <span class="st">"dynamic"</span>) {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paletteer_dynamic</span>(pal_name, n, direction))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>r_table_theming <span class="ot">&lt;-</span> <span class="cf">function</span>(r_df,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                            title,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                            subtitle,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                            footnotes_df,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                            source_note,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                            pal_df,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">multiline_feet =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tbl_font_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color_by_columns =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                            <span class="at">do_col_labels =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                            <span class="at">target_everything =</span> <span class="cn">FALSE</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                            ) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  r_table <span class="ot">&lt;-</span> <span class="fu">gt</span>(r_df)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(r_df) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> target_everything <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    r_table <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(pal_df)) <span class="sc">|&gt;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce</span>(\(acc, i) {</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        acc,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> pal_df<span class="sc">$</span>pals[[i]],</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> pal_df<span class="sc">$</span>cols[[i]]</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    },<span class="at">.init =</span> r_table)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">nrow</span>(r_df) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> target_everything <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    r_table <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(pal_df)) <span class="sc">|&gt;</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce</span>(\(acc, i) {</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data_color</span>(</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        acc,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> color_by_columns,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> pal_df<span class="sc">$</span>pals[[i]],</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">target_columns =</span> <span class="fu">everything</span>()</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    },<span class="at">.init =</span> r_table)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  r_table <span class="ot">&lt;-</span> r_table <span class="sc">|&gt;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(<span class="at">title =</span> title, <span class="at">subtitle =</span> subtitle)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  r_table <span class="ot">&lt;-</span> r_table <span class="sc">|&gt;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.padding =</span> <span class="fu">px</span>(<span class="dv">10</span>),</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.background.color =</span> <span class="st">'#333'</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.color =</span> <span class="st">'black'</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.vlines.width =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.lr.width =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.lr.color =</span> <span class="st">'black'</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.vlines.color =</span> <span class="st">'black'</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">footnotes.padding =</span> <span class="fu">px</span>(<span class="dv">5</span>),</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">footnotes.background.color =</span> <span class="st">'#222'</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">footnotes.sep =</span> <span class="st">", "</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">footnotes.multiline =</span> multiline_feet,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.padding =</span> <span class="fu">px</span>(<span class="dv">20</span>),</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.background.color =</span> <span class="st">'#222'</span>,</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.title.font.size =</span> <span class="fu">pct</span>(<span class="dv">125</span>),</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.subtitle.font.size =</span> <span class="fu">pct</span>(<span class="dv">110</span>),</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.striping.include_table_body   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.striping.background_color =</span> <span class="st">'#333'</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">source_notes.background.color =</span> <span class="st">'#222'</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.margin.left =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.margin.right =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.align =</span> <span class="st">"center"</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.background.color =</span> <span class="st">'#222'</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.font.size =</span> tbl_font_size,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.layout =</span> <span class="st">"auto"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.hlines.color =</span> <span class="st">'black'</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.hlines.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.vlines.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.color =</span> <span class="st">'black'</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.top.color =</span> <span class="st">'black'</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">0</span>),</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.top.width =</span> <span class="fu">px</span>(<span class="dv">0</span>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  r_table <span class="ot">&lt;-</span> r_table <span class="sc">|&gt;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> source_note)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Footnotes are added to the accumulator, building up to the final result</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  r_table <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(footnotes_df)) <span class="sc">|&gt;</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce</span>(\(acc, i) {</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_footnote</span>(</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>        acc,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">footnote =</span> footnotes_df<span class="sc">$</span>notes[[i]],</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">location =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> footnotes_df<span class="sc">$</span>locations[[i]]),</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">placement =</span> <span class="st">"auto"</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">.init =</span> r_table)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(r_df) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> do_col_labels <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>      cell_col_fills <span class="ot">=</span> pal_df<span class="sc">$</span>pals[[<span class="dv">1</span>]]</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>      r_table <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(pal_df)) <span class="sc">|&gt;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>        <span class="fu">reduce</span>(\(acc, i) {</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tab_style</span>(</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>            acc,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            <span class="at">style =</span> <span class="fu">cell_fill</span>(</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> cell_col_fills[i]</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>              ), <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> pal_df<span class="sc">$</span>cols[[i]]))</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">.init =</span> r_table)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r_table)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="plots" class="level4 page-columns page-full" data-number="1.1.3">
<h4 data-number="1.1.3" class="anchored" data-anchor-id="plots"><span class="header-section-number">1.1.3</span> Plots</h4>
<div class="p-1 page-columns page-full">
<p>Here are some relatively simpler functions developed with the intention to append and apply consistent theming to ggplots. R libraries are currently preferred for plotting outputs as they can be extensively customized. <span class="citation" data-cites="wickham_ggplot2_2016">(<a href="#ref-wickham_ggplot2_2016" role="doc-biblioref">Wickham, 2016</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-wickham_ggplot2_2016" class="csl-entry" role="listitem">
Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>
</div></div></div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Plot theming code.</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># normal axes</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ggplot_theming <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#222'</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#222'</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">'solid'</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">'black'</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">'gray'</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">'dashed'</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">'black'</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">'dotted'</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">'gray'</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'gray100'</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'gray'</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#222'</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'gray'</span>),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># flipped axes</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>ggplot_theming_flipped_axes <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#222'</span>),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#222'</span>),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">'dashed'</span>),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">'solid'</span>),</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">'dotted'</span>),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'gray100'</span>),</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'gray'</span>),</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'#222'</span>),</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'gray'</span>),</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">'white'</span>))</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
</section>
</section>
<section id="importextract" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="importextract"><span class="header-section-number">2</span> Import/Extract</h2>
<p>The data was imported from Kaggle. It only needed to be done once, so the code chunk’s eval setting is set to false during most of this project’s development.</p>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Executed once to import the data from the Kaggle server.</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kaggle competitions download <span class="op">-</span>c child<span class="op">-</span>mind<span class="op">-</span>institute<span class="op">-</span>problematic<span class="op">-</span>internet<span class="op">-</span>use</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p>Although not necessary, creating the data directory can be made programmatic.</p>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Checked if the directory, ‘data’, exists.</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  os.mkdir(<span class="st">'./data'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">FileExistsError</span>:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"data exists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>data exists</code></pre>
</div>
</div>
</div>
<div class="p-1">
<p>Extracting the downloaded files was also done programmatically, but it is not necessary. It did seem useful to visualize the data directory following extraction to verify the files and folders that now exist in the ./data directory of this project.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Extracted the compressed files and list files.</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> zipfile <span class="im">import</span> ZipFile</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>zip_path <span class="op">=</span> <span class="st">"child-mind-institute-problematic-internet-use.zip"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="st">'./data/train.csv'</span>):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">with</span> ZipFile(zip_path) <span class="im">as</span> zf:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    ZipFile.extractall(zf, path <span class="op">=</span> <span class="st">'./data'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Extracted files"</span>, sep <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Files already exist"</span>, sep <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">*</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Files already exist</code></pre>
</div>
<details class="code-fold">
<summary>Extracted the compressed files and list files.</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>extracts <span class="op">=</span> pd.DataFrame(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> os.listdir(path <span class="op">=</span> <span class="st">'./data'</span>), columns <span class="op">=</span> [<span class="st">'./data'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>extracts</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(<span class="st">"directory contents"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"./data"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table dataframe, or tibble, of footnotes</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">notes =</span> notes_list, <span class="at">locations =</span> locations_list)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">list</span>(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"./data"</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval_palette</span>(<span class="st">"ggsci::legacy_tron"</span>, <span class="dv">7</span>, <span class="st">'d'</span>, <span class="dv">1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Directory Files"</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: '/data/'"</span>),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tbl_font_size =</span> <span class="fu">pct</span>(<span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-dataDirectory" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dataDirectory-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Files and folders
</figcaption>
<div aria-describedby="tbl-dataDirectory-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="wwlmcmgviu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wwlmcmgviu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wwlmcmgviu thead, #wwlmcmgviu tbody, #wwlmcmgviu tfoot, #wwlmcmgviu tr, #wwlmcmgviu td, #wwlmcmgviu th {
  border-style: none;
}

#wwlmcmgviu p {
  margin: 0;
  padding: 0;
}

#wwlmcmgviu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 80%;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wwlmcmgviu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wwlmcmgviu .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#wwlmcmgviu .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#wwlmcmgviu .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wwlmcmgviu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#wwlmcmgviu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#wwlmcmgviu .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wwlmcmgviu .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wwlmcmgviu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wwlmcmgviu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wwlmcmgviu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wwlmcmgviu .gt_spanner_row {
  border-bottom-style: hidden;
}

#wwlmcmgviu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wwlmcmgviu .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wwlmcmgviu .gt_from_md > :first-child {
  margin-top: 0;
}

#wwlmcmgviu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wwlmcmgviu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wwlmcmgviu .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wwlmcmgviu .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wwlmcmgviu .gt_row_group_first td {
  border-top-width: 2px;
}

#wwlmcmgviu .gt_row_group_first th {
  border-top-width: 2px;
}

#wwlmcmgviu .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwlmcmgviu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wwlmcmgviu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wwlmcmgviu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwlmcmgviu .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwlmcmgviu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wwlmcmgviu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wwlmcmgviu .gt_striped {
  background-color: #333333;
}

#wwlmcmgviu .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#wwlmcmgviu .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wwlmcmgviu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwlmcmgviu .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wwlmcmgviu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwlmcmgviu .gt_left {
  text-align: left;
}

#wwlmcmgviu .gt_center {
  text-align: center;
}

#wwlmcmgviu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wwlmcmgviu .gt_font_normal {
  font-weight: normal;
}

#wwlmcmgviu .gt_font_bold {
  font-weight: bold;
}

#wwlmcmgviu .gt_font_italic {
  font-style: italic;
}

#wwlmcmgviu .gt_super {
  font-size: 65%;
}

#wwlmcmgviu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wwlmcmgviu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wwlmcmgviu .gt_indent_1 {
  text-indent: 5px;
}

#wwlmcmgviu .gt_indent_2 {
  text-indent: 10px;
}

#wwlmcmgviu .gt_indent_3 {
  text-indent: 15px;
}

#wwlmcmgviu .gt_indent_4 {
  text-indent: 20px;
}

#wwlmcmgviu .gt_indent_5 {
  text-indent: 25px;
}

#wwlmcmgviu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wwlmcmgviu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="1" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Directory Files</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a./data">./data<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="./data" class="gt_row gt_left" style="background-color: #A3CFDC; color: #000000;">privateLeaderboard.csv</td></tr>
    <tr><td headers="./data" class="gt_row gt_left gt_striped" style="background-color: #E89A3C; color: #000000;">test.csv</td></tr>
    <tr><td headers="./data" class="gt_row gt_left" style="background-color: #FF410D; color: #FFFFFF;">data_dictionary.csv</td></tr>
    <tr><td headers="./data" class="gt_row gt_left gt_striped" style="background-color: #C3CA4D; color: #000000;">sample_submission.csv</td></tr>
    <tr><td headers="./data" class="gt_row gt_left" style="background-color: #B1D499; color: #000000;">series_test.parquet</td></tr>
    <tr><td headers="./data" class="gt_row gt_left gt_striped" style="background-color: #E5CCB1; color: #000000;">series_train.parquet</td></tr>
    <tr><td headers="./data" class="gt_row gt_left" style="background-color: #748AA6; color: #FFFFFF;">train.csv</td></tr>
    <tr><td headers="./data" class="gt_row gt_left gt_striped" style="background-color: #E3CD75; color: #000000;">profiles</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="1"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IOKAmC9kYXRhL+KAmQ=="><span class="gt_from_md"><strong>source</strong>: ‘/data/’</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="1"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> directory contents</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="establish-connection" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="establish-connection"><span class="header-section-number">3</span> Establish Connection</h2>
<div class="p-1">
<p>An in-memory, DuckDB database connection was established for this project. The analysis in this project heavily relies on SQL syntax, and most of the computations are performed in database for efficiency.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Set up an in-memory database.</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> duckdb</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> duckdb.<span class="ex">connect</span>(<span class="st">':memory:'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<section id="customize-database-settings" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="customize-database-settings"><span class="header-section-number">3.1</span> Customize Database Settings</h3>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Set the database memory limit.</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  conn.sql(<span class="ss">f"SET memory_limit = '24GB';"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Successfully changed memory limit to 24GB"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"An error occurred in changing the memory limit."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Successfully changed memory limit to 24GB</code></pre>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Set the default ordering for the database.</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  conn.sql(<span class="ss">f"SET default_order = 'ASC';"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Successfully changed the default order to ascending."</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"The default order could not be changed."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Successfully changed the default order to ascending.</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="setup-database" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="setup-database"><span class="header-section-number">4</span> Setup Database</h2>
<section id="create-new-data-types" class="level3 page-columns page-full" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="create-new-data-types"><span class="header-section-number">4.1</span> Create New Data Types</h3>
<div class="p-1 page-columns page-full">
<p>Enum data types significantly sped up many database operations. Enums are similar to the category data type in Python, and the factor datatype in R. <span class="citation" data-cites="holanda_duckdb_2021">(<a href="#ref-holanda_duckdb_2021" role="doc-biblioref">Holanda, 2021</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-holanda_duckdb_2021" class="csl-entry" role="listitem">
Holanda, P. (2021, November 26). <em><span>DuckDB</span> – the lord of enums: The fellowship of the categorical and factors. <span>DuckDB</span></em>. <a href="https://duckdb.org/2021/11/26/duck-enum.html">https://duckdb.org/2021/11/26/duck-enum.html</a>
</div></div></div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Data structures setup for new data types.</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>enums <span class="op">=</span> [<span class="st">'internet_hours_enum'</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'enroll_season_enum'</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'disease_risk_enum'</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'sii_enum'</span>, <span class="st">'age_enum'</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'sex_enum'</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'pciat_season_enum'</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'weekday_enum'</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'quarter_enum'</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'hour_enum'</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'minute_enum'</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'second_enum'</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         ,<span class="st">'id_actigraphy_enum'</span>]</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#siiSeries = pd.Series(data = ['None', 'Mild', 'Moderate', 'Severe'], dtype = str)</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>siiSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> [<span class="st">'0'</span>, <span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>], dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>ageSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">5</span>, <span class="dv">23</span>), dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>sexSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> [<span class="st">'0'</span>, <span class="st">'1'</span>], dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>pciatSeasonSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> [<span class="st">'Fall'</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Spring'</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Summer'</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Winter'</span>], dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>internetHrsSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> [<span class="st">'0'</span>, <span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>], dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>quarterSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">5</span>), dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>weekdaySeries <span class="op">=</span> pd.Series(data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">8</span>), dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>hourSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">24</span>), dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>minuteSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">60</span>), dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>secondSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">60</span>), dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>diseaseRiskSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> [<span class="st">'Underweight'</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Normal'</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Increased'</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'High'</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Very High'</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                                      ,<span class="st">'Extremely High'</span>], dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>id_df <span class="op">=</span> conn.execute(<span class="ss">f"""</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="ss">     SELECT </span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="ss">         DISTINCT(id) AS id</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="ss">     FROM </span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="ss">         read_parquet('data/series_train*/*/*'</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="ss">         ,hive_partitioning = true)</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="ss">     ORDER BY </span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="ss">         id ASC;</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="ss">     """</span>).df() </span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>idList <span class="op">=</span> id_df[<span class="st">'id'</span>].to_list()</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>idSeries <span class="op">=</span> pd.Series(data <span class="op">=</span> idList, dtype <span class="op">=</span> <span class="bu">str</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>enumDict <span class="op">=</span> {</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>  <span class="st">'disease_risk_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(diseaseRiskSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'enroll_season_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(pciatSeasonSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'sii_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(siiSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'age_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(ageSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'sex_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(sexSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'pciat_season_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(pciatSeasonSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'quarter_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(quarterSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'weekday_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(weekdaySeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'hour_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(hourSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'minute_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(minuteSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'second_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(secondSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'id_actigraphy_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(idSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'internet_hours_enum'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">tuple</span>(internetHrsSeries)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(enumDict) <span class="op">==</span> <span class="bu">len</span>(enums):</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"drops and creates are same length"</span>)</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"drops and creates are not the same length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>drops and creates are same length</code></pre>
</div>
</div>
</div>
<div class="p-1">
<p>This is designed to manage ENUM types in a DuckDB database in a modular and user-friendly way. It provides functions to create and drop ENUM types, and it uses Python data structures like pandas Series and dictionaries to handle inputs and outputs.</p>
<p>It is part of the data preprocessing and database setup pipeline in this project. It ensures that the database schema (specifically ENUM types) is properly configured before performing further operations, such as aggregating light exposure data.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>An approach for defining and verifying custom data types in the database.</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_create(conn,type_str: <span class="bu">str</span>, enum_str: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">  :::WHY(s):::</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Is there a modular approach to creating ENUM types in a database?</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">  :::HOW(s):::</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Utilize python data structures such as pandas Series and dictionary as parameters.</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the try, except can help categorize the outputs for ui/ux</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    conn.execute(<span class="ss">f"CREATE TYPE </span><span class="sc">{</span>type_str<span class="sc">}</span><span class="ss"> AS ENUM </span><span class="sc">{</span>enum_str<span class="sc">}</span><span class="ss">;"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series(type_str, index <span class="op">=</span> [<span class="st">'created'</span>])</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> duckdb.duckdb.CatalogException:</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series(type_str, index <span class="op">=</span> [<span class="st">'already existed'</span>])</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_drop(conn, type_str: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">  :::WHY(s):::</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Is there a modular approach to dropping ENUM types in a database?</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">  :::HOW(s):::</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Utilize python data structures such as pandas Series and dictionary as parameters.</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    conn.execute(<span class="ss">f"DROP TYPE </span><span class="sc">{</span>type_str<span class="sc">}</span><span class="ss">;"</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series(type_str, index <span class="op">=</span> [<span class="st">'dropped'</span>])</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> duckdb.duckdb.CatalogException:</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series(type_str, index <span class="op">=</span> [<span class="st">'did not exist'</span>])</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>droplist <span class="op">=</span> []</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> e <span class="kw">in</span> enums:   </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>   droplist.append(try_drop(conn, type_str <span class="op">=</span> e))</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>dropFrame <span class="op">=</span> pd.DataFrame(droplist)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>dropFrame <span class="op">=</span> dropFrame.sort_values(by <span class="op">=</span> dropFrame.columns.to_list(),</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                                  ascending <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                                  ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>createList <span class="op">=</span> []</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> eType, eSeries <span class="kw">in</span> enumDict.items():</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    createList.append(try_create(conn,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>                                 type_str <span class="op">=</span> eType,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>                                 enum_str <span class="op">=</span> eSeries))</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>createFrame <span class="op">=</span> pd.DataFrame(createList)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>createFrame <span class="op">=</span> createFrame.sort_values(by <span class="op">=</span> createFrame.columns.to_list(),</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>                                      ascending <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>                                      ignore_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>pydf <span class="op">=</span> pd.concat([dropFrame, createFrame], axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>pydf</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">colnames</span>(r_df[<span class="dv">1</span>]) <span class="sc">==</span> <span class="st">"did not exist"</span>){</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  locations_list <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"did not exist"</span>, <span class="st">"created"</span>) </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  notes_list <span class="ot">=</span>  <span class="fu">list</span>(<span class="st">"Enums that did not exist."</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Enums that now exist."</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  locations_list <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"dropped"</span>, <span class="st">"created"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  notes_list <span class="ot">=</span>  <span class="fu">list</span>(<span class="st">"Enums that were dropped."</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Enums that now exist."</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table dataframe, or tibble, of footnotes</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">notes =</span> notes_list, <span class="at">locations =</span> locations_list)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval_palette</span>(<span class="st">"ggsci::legacy_tron"</span>, <span class="dv">7</span>, <span class="st">'d'</span>, <span class="dv">1</span>))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#tbl_font_size = pct(80))</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Custom Data Types"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tbl_font_size =</span> <span class="fu">pct</span>(<span class="dv">80</span>)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-enumOutput" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-enumOutput-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Enums dropped and created.
</figcaption>
<div aria-describedby="tbl-enumOutput-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qksswmfrji" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qksswmfrji table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qksswmfrji thead, #qksswmfrji tbody, #qksswmfrji tfoot, #qksswmfrji tr, #qksswmfrji td, #qksswmfrji th {
  border-style: none;
}

#qksswmfrji p {
  margin: 0;
  padding: 0;
}

#qksswmfrji .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 80%;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qksswmfrji .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qksswmfrji .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#qksswmfrji .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#qksswmfrji .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qksswmfrji .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#qksswmfrji .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#qksswmfrji .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qksswmfrji .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qksswmfrji .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qksswmfrji .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qksswmfrji .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qksswmfrji .gt_spanner_row {
  border-bottom-style: hidden;
}

#qksswmfrji .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qksswmfrji .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qksswmfrji .gt_from_md > :first-child {
  margin-top: 0;
}

#qksswmfrji .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qksswmfrji .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qksswmfrji .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qksswmfrji .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qksswmfrji .gt_row_group_first td {
  border-top-width: 2px;
}

#qksswmfrji .gt_row_group_first th {
  border-top-width: 2px;
}

#qksswmfrji .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksswmfrji .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qksswmfrji .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qksswmfrji .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qksswmfrji .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksswmfrji .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qksswmfrji .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qksswmfrji .gt_striped {
  background-color: #333333;
}

#qksswmfrji .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#qksswmfrji .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qksswmfrji .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksswmfrji .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qksswmfrji .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksswmfrji .gt_left {
  text-align: left;
}

#qksswmfrji .gt_center {
  text-align: center;
}

#qksswmfrji .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qksswmfrji .gt_font_normal {
  font-weight: normal;
}

#qksswmfrji .gt_font_bold {
  font-weight: bold;
}

#qksswmfrji .gt_font_italic {
  font-style: italic;
}

#qksswmfrji .gt_super {
  font-size: 65%;
}

#qksswmfrji .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qksswmfrji .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qksswmfrji .gt_indent_1 {
  text-indent: 5px;
}

#qksswmfrji .gt_indent_2 {
  text-indent: 10px;
}

#qksswmfrji .gt_indent_3 {
  text-indent: 15px;
}

#qksswmfrji .gt_indent_4 {
  text-indent: 20px;
}

#qksswmfrji .gt_indent_5 {
  text-indent: 25px;
}

#qksswmfrji .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qksswmfrji div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Custom Data Types</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="did-not-exist">did not exist<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="created">created<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #FF410D; color: #FFFFFF;">age_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #FF410D; color: #FFFFFF;">age_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left gt_striped" style="background-color: #E09D88; color: #000000;">disease_risk_enum</td>
<td headers="created" class="gt_row gt_left gt_striped" style="background-color: #E09D88; color: #000000;">disease_risk_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #6EE2FF; color: #000000;">enroll_season_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #6EE2FF; color: #000000;">enroll_season_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left gt_striped" style="background-color: #CED39F; color: #000000;">hour_enum</td>
<td headers="created" class="gt_row gt_left gt_striped" style="background-color: #CED39F; color: #000000;">hour_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #F7C530; color: #000000;">id_actigraphy_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #F7C530; color: #000000;">id_actigraphy_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left gt_striped" style="background-color: #CACA49; color: #000000;">internet_hours_enum</td>
<td headers="created" class="gt_row gt_left gt_striped" style="background-color: #CACA49; color: #000000;">internet_hours_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #95CC5E; color: #000000;">minute_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #95CC5E; color: #000000;">minute_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left gt_striped" style="background-color: #B6D6A3; color: #000000;">pciat_season_enum</td>
<td headers="created" class="gt_row gt_left gt_striped" style="background-color: #B6D6A3; color: #000000;">pciat_season_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #D0DFE6; color: #000000;">quarter_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #D0DFE6; color: #000000;">quarter_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left gt_striped" style="background-color: #EEBE89; color: #000000;">second_enum</td>
<td headers="created" class="gt_row gt_left gt_striped" style="background-color: #EEBE89; color: #000000;">second_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #F79D1E; color: #000000;">sex_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #F79D1E; color: #000000;">sex_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left gt_striped" style="background-color: #C1936C; color: #FFFFFF;">sii_enum</td>
<td headers="created" class="gt_row gt_left gt_striped" style="background-color: #C1936C; color: #FFFFFF;">sii_enum</td></tr>
    <tr><td headers="did not exist" class="gt_row gt_left" style="background-color: #748AA6; color: #FFFFFF;">weekday_enum</td>
<td headers="created" class="gt_row gt_left" style="background-color: #748AA6; color: #FFFFFF;">weekday_enum</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="2"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Enums that did not exist.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="2"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Enums that now exist.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="initial-extraction-transformation-and-load-pipeline" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="initial-extraction-transformation-and-load-pipeline"><span class="header-section-number">4.2</span> Initial Extraction Transformation and Load Pipeline</h3>
<div class="p-1">
<p>Transformations are applied while reading in data from files to minimize steps needed. Not sure why the data had hyphens in the columns names, originally. These hyphens interfere with SQL database queries, so it might be useful to replace them with underscore characters. There is no need to overwrite the original CSV’s to maintain a clear trail of data transformations.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Initial data pipeline extraction, transformation and loading to the database.</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup_duckdb_pipeline(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  csvDict: <span class="bu">dict</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  parquetDict: <span class="bu">dict</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  conn: duckdb.DuckDBPyConnection) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      table_name: duckdb.sql(<span class="ss">f"""</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="ss">      CREATE OR REPLACE TABLE </span><span class="sc">{</span>table_name<span class="sc">}</span><span class="ss"> AS </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="ss">      SELECT </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="ss">        *</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="ss">      FROM </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="ss">        df;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="ss">      """</span>, connection <span class="op">=</span> conn) </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> table_name, df <span class="kw">in</span> csvDict.items()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> csvDict.items():</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>      result <span class="op">=</span> conn.execute(<span class="ss">f"SELECT COUNT(*) FROM </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>).fetchone()</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Successfully created table: </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">, Row count: </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error loading table: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> parquetDict:</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    write_datasets(conn, parquetDict)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create tables from Parquet files</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> write_datasets (</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  conn: duckdb.DuckDBPyConnection, parquetDict: <span class="bu">dict</span>):</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">try</span>:</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>          table_name: duckdb.sql(<span class="ss">f"""</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="ss">           CREATE OR REPLACE TABLE </span><span class="sc">{</span>table_name<span class="sc">}</span><span class="ss"> AS</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="ss">           SELECT </span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="ss">             id::id_actigraphy_enum AS id</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="ss">             ,quarter::TEXT::quarter_enum AS quarter</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="ss">             ,weekday::TEXT::weekday_enum AS weekday</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="ss">             ,light</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="ss">             ,(time_of_day / 3_600_000_000_000) AS hour_of_day</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="ss">             ,relative_date_PCIAT</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="ss">           FROM read_parquet(</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="ss">             '</span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="ss">             ,hive_partitioning = true</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="ss">             );"""</span>, connection<span class="op">=</span>conn)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>           <span class="cf">for</span> table_name, file_path <span class="kw">in</span> parquetDict.items()</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>           }</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> key, value <span class="kw">in</span> parquetDict.items():</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>          result <span class="op">=</span> conn.execute(<span class="ss">f"SELECT COUNT(*) FROM </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>).fetchone()</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Successfully created table: </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">, Row count, </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>      <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error writing dataset: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>trainCsvDf <span class="op">=</span> pd.read_csv(<span class="st">"data/train.csv"</span>)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>testCsvDf <span class="op">=</span> pd.read_csv(<span class="st">"data/test.csv"</span>)</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>dictDf <span class="op">=</span> pd.read_csv(<span class="st">"data/data_dictionary.csv"</span>)</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>trainCsvDf.columns <span class="op">=</span> trainCsvDf.columns.<span class="bu">str</span>.replace(<span class="st">'-'</span>,<span class="st">'_'</span>) </span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>trainCsvDf.columns <span class="op">=</span> trainCsvDf.columns.<span class="bu">str</span>.lower() </span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>testCsvDf.columns <span class="op">=</span> testCsvDf.columns.<span class="bu">str</span>.replace(<span class="st">'-'</span>,<span class="st">'_'</span>) </span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>testCsvDf.columns <span class="op">=</span> testCsvDf.columns.<span class="bu">str</span>.lower() </span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>dictDf.Field <span class="op">=</span> dictDf.Field.replace(<span class="st">"-"</span>, <span class="st">"_"</span>, regex <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>csvDict <span class="op">=</span> {</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TrainCsv"</span>: trainCsvDf</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"TestCsv"</span>: testCsvDf</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"DataDict"</span>: dictDf</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>parquetDict <span class="op">=</span> {</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ActigraphyTrain"</span>: <span class="st">'data/series_train.parquet*/*/*'</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"ActigraphyTest"</span>: <span class="st">'data/series_test*/*/*'</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>  setup_duckdb_pipeline(csvDict, parquetDict, conn)</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Could not set up data pipeline."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Successfully created table: TrainCsv, Row count: 3960
Successfully created table: TestCsv, Row count: 20
Successfully created table: DataDict, Row count: 81
Successfully created table: ActigraphyTrain, Row count, 314569149
Successfully created table: ActigraphyTest, Row count, 439726</code></pre>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Verify ActigraphyTrain in the database.</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pydf <span class="op">=</span> conn.sql(<span class="ss">f"""</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT *</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="ss">FROM ActigraphyTrain</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="ss">ORDER BY </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  id ASC</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,relative_date_PCIAT ASC</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,hour_of_day ASC</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="ss">LIMIT 10;"""</span>).df()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>pydf</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> r_df <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, quarter, weekday, relative_date_PCIAT, light, hour_of_day)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Unique participant identifier code, to track related data from actigraphy to hbn datasets."</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Annual quarter related to month of observation."</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Day of the week (Monday = 1)"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Light exposure, measured in 'lux'"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"24-hour time converted to a float for easier conversion for time-series analysis."</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Days since questionairre, also convenient to help order daily values for time-series analysis."</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"id"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"quarter"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"weekday"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"light"</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"hour_of_day"</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"relative_date_PCIAT"</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> notes_list, </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> locations_list)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(<span class="fu">eval_palette</span>(<span class="st">"harrypotter::ravenclaw"</span>, <span class="dv">7</span>, <span class="st">'c'</span>, <span class="dv">1</span>)))</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Actigraphy Data - Training Set"</span>,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">TRUE</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#tbl_font_size = pct(85)</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>                          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-ActigraphyTrain" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ActigraphyTrain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: A preview of ActigraphyTrain database table.
</figcaption>
<div aria-describedby="tbl-ActigraphyTrain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="acbizmcmzq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#acbizmcmzq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#acbizmcmzq thead, #acbizmcmzq tbody, #acbizmcmzq tfoot, #acbizmcmzq tr, #acbizmcmzq td, #acbizmcmzq th {
  border-style: none;
}

#acbizmcmzq p {
  margin: 0;
  padding: 0;
}

#acbizmcmzq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#acbizmcmzq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#acbizmcmzq .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#acbizmcmzq .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#acbizmcmzq .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#acbizmcmzq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#acbizmcmzq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#acbizmcmzq .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#acbizmcmzq .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#acbizmcmzq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#acbizmcmzq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#acbizmcmzq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#acbizmcmzq .gt_spanner_row {
  border-bottom-style: hidden;
}

#acbizmcmzq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#acbizmcmzq .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#acbizmcmzq .gt_from_md > :first-child {
  margin-top: 0;
}

#acbizmcmzq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#acbizmcmzq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#acbizmcmzq .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#acbizmcmzq .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#acbizmcmzq .gt_row_group_first td {
  border-top-width: 2px;
}

#acbizmcmzq .gt_row_group_first th {
  border-top-width: 2px;
}

#acbizmcmzq .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#acbizmcmzq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#acbizmcmzq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#acbizmcmzq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#acbizmcmzq .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#acbizmcmzq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#acbizmcmzq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#acbizmcmzq .gt_striped {
  background-color: #333333;
}

#acbizmcmzq .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#acbizmcmzq .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#acbizmcmzq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#acbizmcmzq .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#acbizmcmzq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#acbizmcmzq .gt_left {
  text-align: left;
}

#acbizmcmzq .gt_center {
  text-align: center;
}

#acbizmcmzq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#acbizmcmzq .gt_font_normal {
  font-weight: normal;
}

#acbizmcmzq .gt_font_bold {
  font-weight: bold;
}

#acbizmcmzq .gt_font_italic {
  font-style: italic;
}

#acbizmcmzq .gt_super {
  font-size: 65%;
}

#acbizmcmzq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#acbizmcmzq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#acbizmcmzq .gt_indent_1 {
  text-indent: 5px;
}

#acbizmcmzq .gt_indent_2 {
  text-indent: 10px;
}

#acbizmcmzq .gt_indent_3 {
  text-indent: 15px;
}

#acbizmcmzq .gt_indent_4 {
  text-indent: 20px;
}

#acbizmcmzq .gt_indent_5 {
  text-indent: 25px;
}

#acbizmcmzq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#acbizmcmzq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Actigraphy Data - Training Set</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="id">id<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="quarter">quarter<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="weekday">weekday<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="relative_date_PCIAT">relative_date_PCIAT<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="light">light<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="hour_of_day">hour_of_day<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="id" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">53.00000</td>
<td headers="hour_of_day" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">15.81667</td></tr>
    <tr><td headers="id" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right gt_striped" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right gt_striped" style="background-color: #BD630A; color: #FFFFFF;">51.66667</td>
<td headers="hour_of_day" class="gt_row gt_right gt_striped" style="background-color: #03689B; color: #FFFFFF;">15.81806</td></tr>
    <tr><td headers="id" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right" style="background-color: #C86C14; color: #FFFFFF;">50.33333</td>
<td headers="hour_of_day" class="gt_row gt_right" style="background-color: #066B9E; color: #FFFFFF;">15.81944</td></tr>
    <tr><td headers="id" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right gt_striped" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right gt_striped" style="background-color: #C76B12; color: #FFFFFF;">50.50000</td>
<td headers="hour_of_day" class="gt_row gt_right gt_striped" style="background-color: #096DA0; color: #FFFFFF;">15.82083</td></tr>
    <tr><td headers="id" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right" style="background-color: #3EA2D5; color: #FFFFFF;">33.16667</td>
<td headers="hour_of_day" class="gt_row gt_right" style="background-color: #C56911; color: #FFFFFF;">15.89861</td></tr>
    <tr><td headers="id" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right gt_striped" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right gt_striped" style="background-color: #3093C6; color: #FFFFFF;">31.33333</td>
<td headers="hour_of_day" class="gt_row gt_right gt_striped" style="background-color: #C1660D; color: #FFFFFF;">15.90000</td></tr>
    <tr><td headers="id" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right" style="background-color: #2185B8; color: #FFFFFF;">29.50000</td>
<td headers="hour_of_day" class="gt_row gt_right" style="background-color: #BE630A; color: #FFFFFF;">15.90139</td></tr>
    <tr><td headers="id" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right gt_striped" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right gt_striped" style="background-color: #167AAD; color: #FFFFFF;">27.66667</td>
<td headers="hour_of_day" class="gt_row gt_right gt_striped" style="background-color: #BA5F06; color: #FFFFFF;">15.90278</td></tr>
    <tr><td headers="id" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right" style="background-color: #0C70A3; color: #FFFFFF;">25.83333</td>
<td headers="hour_of_day" class="gt_row gt_right" style="background-color: #B75C03; color: #FFFFFF;">15.90417</td></tr>
    <tr><td headers="id" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">3</td>
<td headers="weekday" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">4</td>
<td headers="relative_date_PCIAT" class="gt_row gt_right gt_striped" style="background-color: #98C2D9; color: #000000;">41</td>
<td headers="light" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">24.00000</td>
<td headers="hour_of_day" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">15.90556</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="6"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Unique participant identifier code, to track related data from actigraphy to hbn datasets.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Annual quarter related to month of observation.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Day of the week (Monday = 1)</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Days since questionairre, also convenient to help order daily values for time-series analysis.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> Light exposure, measured in 'lux'</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span> 24-hour time converted to a float for easier conversion for time-series analysis.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="eda" class="level2 page-columns page-full" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="eda"><span class="header-section-number">5</span> EDA</h2>
<div class="p-1">
<p>This is designed to filter and create new database tables based on regular expression (regexp) patterns applied to column names. It is part of the data preprocessing pipeline. The code modularizes the process of selecting columns and creating new tables, making it reusable and efficient.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Creates several tables based on column label strings.</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> filter_columns_by_regex(col_dict: <span class="bu">dict</span>, regex_pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">  :::WHY(s):::</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Can there be a way to use dictionaries to specify columns?</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">  :::GOAL(s):::</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Regex selection of column names from a dictionary.</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    col: dtype </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col, dtype <span class="kw">in</span> col_dict.items() </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> re.search(regex_pattern, col)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_table_with_regex_columns(</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  conn: duckdb.duckdb</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  ,source_table: <span class="bu">str</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  ,new_table_name: <span class="bu">str</span> </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  ,regex_pattern: <span class="bu">str</span> </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  ,col_dict: <span class="bu">dict</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">-&gt;</span> <span class="va">None</span>:  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co">  :::WHY(s):::</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="co">    There should to be a more streamlined way to utilize columnar information following regular string patterns to generate tables based on such information. This could follow and carry out pre-existing data modeling plans.</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co">  :::GOAL(s):::</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co">    To create new database tables with modularized SQL queries generated with the help of regex pattern matching selection.</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co">  :::EXAMPLE(s):::</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co">    The dictionary item:</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="co">      "Demographic": r"^id|^sii|^basic\S+"</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="co"> </span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="co">    Would generate a table named 'Demographic' from data with columns for 'id', 'sii' and all columns starting with 'basic' strings. </span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter columns</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  filtered_col_dict <span class="op">=</span> filter_columns_by_regex(col_dict, regex_pattern)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># regex column selecting via dict comprehension and vectorized filtering</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  regex_select_sql <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="ss">  CREATE OR REPLACE TABLE </span><span class="sc">{</span>new_table_name<span class="sc">}</span><span class="ss"> AS </span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="ss">  SELECT</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="sc">{</span><span class="st">', '</span><span class="sc">.</span>join([<span class="ss">f'"</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">"'</span> <span class="cf">for</span> col <span class="kw">in</span> filtered_col_dict.keys()])<span class="sc">}</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="ss">  FROM </span><span class="sc">{</span>source_table<span class="sc">}</span><span class="ss">;</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="ss">  """</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  conn.execute(regex_select_sql)</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="co"># It'd be useful to get the data types for creating a new table of values</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>coltype_overview <span class="op">=</span> conn.sql(<span class="ss">f"""</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a><span class="ss">  SELECT column_name</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a><span class="ss">         ,data_type</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="ss">  FROM </span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    information_schema.columns</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="ss">  WHERE </span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    table_name = 'TrainCsv';"""</span>).df()</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the column names with data types</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>col_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(coltype_overview.column_name, coltype_overview.data_type))</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>regex_dict_train <span class="op">=</span> {</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Demographic"</span>: <span class="vs">r"^id|^sii|^basic\S+"</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"Physical"</span>: <span class="vs">r"^id|^sii|^physical\S+"</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"FgVital"</span>: <span class="vs">r"^id|^sii|^fitness_E\S+"</span></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"FgChild"</span>: <span class="vs">r"^id|^sii|^fgc\S+"</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"Bia"</span>: <span class="vs">r"^id|^sii|^bia\S+"</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"Paqa"</span>: <span class="vs">r"^id|^sii|^paq_a\S+"</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"Pciat"</span>: <span class="vs">r"^id|^sii|^pciat\S+"</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"Sds"</span>: <span class="vs">r"^id|^sii|^sds\S+"</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"InternetUse"</span>: <span class="vs">r"^id|^sii|^preint\S+"</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a><span class="co"># There's no Pciat in the test set</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>regex_dict_test <span class="op">=</span> {</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DemographicTest"</span>: <span class="vs">r"^id|^basic\S+"</span></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"PhysicalTest"</span>: <span class="vs">r"^id|^physical\S+"</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"FgVitalTest"</span>: <span class="vs">r"^id|^fitness_E\S+"</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"FgChildTest"</span>: <span class="vs">r"^id|^fgc\S+"</span></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"BiaTest"</span>: <span class="vs">r"^id|^bia\S+"</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"PaqaTest"</span>: <span class="vs">r"^id|^paq_a\S+"</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"SdsTest"</span>: <span class="vs">r"^id|^sds\S+"</span></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"InternetUseTest"</span>: <span class="vs">r"^id|^preint\S+"</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through the data structures to create tables for the train set</span></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> new_table_name, regex_pattern <span class="kw">in</span> regex_dict_train.items():</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>  create_table_with_regex_columns(</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>    conn </span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'TrainCsv'</span></span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>    ,new_table_name</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>    ,regex_pattern</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>    ,col_dict</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through the data structures to create tables for the test set</span></span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> new_table_name, regex_pattern <span class="kw">in</span> regex_dict_test.items():</span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>  create_table_with_regex_columns(</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>    conn</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'TestCsv'</span></span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>    ,new_table_name</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>    ,regex_pattern </span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>    ,col_dict</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Perform a join on matching Ids to combine demographics data with actigraphy data such as time and light exposure.</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"""</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE OR REPLACE TABLE IntermediateActigraphy AS</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT id</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">       ,basic_demos_enroll_season::TEXT::enroll_season_enum AS enroll_season</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">       ,basic_demos_age::TEXT::age_enum AS age</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">       ,basic_demos_sex::TEXT AS sex</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">       ,sii::INTEGER::TEXT::sii_enum AS sii</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM </span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Demographic</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="st">  id ASC;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"""</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE OR REPLACE TABLE </span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="st">  ActigraphyTrain</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="st">AS</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">    ia.*</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.hour_of_day</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.weekday</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.quarter</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.light</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM </span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="st">    ActigraphyTrain at </span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN </span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="st">    IntermediateActigraphy ia</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="st">  ON </span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="st">    ia.id = at.id;</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"""</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE OR REPLACE TABLE IntermediateActigraphy AS</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="st">  id</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="st">  ,basic_demos_enroll_season::TEXT::enroll_season_enum AS enroll_season</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="st">  ,basic_demos_age::TEXT::age_enum AS age</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="st">  ,basic_demos_sex::TEXT AS sex</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="st">FROM </span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="st">  DemographicTest</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="st">  id ASC;</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"""</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE OR REPLACE TABLE </span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="st">  ActigraphyTest</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="st">AS</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="st">    ia.*</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.hour_of_day</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.quarter</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.weekday</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="st">    ,at.light</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM </span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="st">    ActigraphyTest at </span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN </span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="st">    IntermediateActigraphy ia</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="st">  ON </span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="st">    ia.id = at.id;</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="st">"DROP TABLE IntermediateActigraphy;"</span>)</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a> conn.sql(<span class="ss">f"CHECKPOINT;"</span>)</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a> <span class="bu">print</span>(<span class="ss">f"Cleared unused allocated space from memory."</span>)</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Could not clear from memory."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>┌─────────┐
│ Success │
│ boolean │
├─────────┤
│ 0 rows  │
└─────────┘

Cleared unused allocated space from memory.</code></pre>
</div>
</div>
</div>
<section id="actigraphy-physical-and-demographics" class="level3 page-columns page-full" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="actigraphy-physical-and-demographics"><span class="header-section-number">5.1</span> Actigraphy, Physical, and Demographics</h3>
<div class="p-1">
<p>It might be useful to explore how the time of day and associated exposure to light might correlate to other factors, such as sii, physical characteristics, and internet use.</p>
</div>
<section id="informal-hypothesis" class="level4 page-columns page-full" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="informal-hypothesis"><span class="header-section-number">5.1.1</span> Informal Hypothesis</h4>
<div class="p-1 page-columns page-full">
<p><em>Hypothesis</em>: More time spent indoors on the internet might be associated with lower light exposure during daytime (Q1-Q2, Q2-Q3) and higher light exposure during nighttime (min-Q1, Q3-max).</p>
<p>The BMI risk categories found at, <span class="citation" data-cites="zierle_physiology_2024">(<a href="#ref-zierle_physiology_2024" role="doc-biblioref">Zierle-Ghosh &amp; Jan, 2024</a>)</span>, have been borrowed for this project. The SQL query syntax, therefore, aims to reflect a structure of evidence-based classification. Though not used in this project, it might be useful to classify lux statistics in a way that reflect a classification standard <span class="citation" data-cites="actigraphcorp_lux_2024">(<a href="#ref-actigraphcorp_lux_2024" role="doc-biblioref"><em>Lux Measurements</em>, n.d.</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-zierle_physiology_2024" class="csl-entry" role="listitem">
Zierle-Ghosh, A., &amp; Jan, A. (2024). Physiology, body mass index. In <em><span>StatPearls</span></em>. <span>StatPearls</span> Publishing. <a href="http://www.ncbi.nlm.nih.gov/books/NBK535456/">http://www.ncbi.nlm.nih.gov/books/NBK535456/</a>
</div><div id="ref-actigraphcorp_lux_2024" class="csl-entry" role="listitem">
<em>Lux measurements</em>. (n.d.). Retrieved November 24, 2024, from <a href="https://actigraphcorp.my.site.com/support/s/article/Lux-Measurements">https://actigraphcorp.my.site.com/support/s/article/Lux-Measurements</a>
</div></div></div>
</section>
<section id="lux-by-hour-of-day-quartile" class="level4" data-number="5.1.2">
<h4 data-number="5.1.2" class="anchored" data-anchor-id="lux-by-hour-of-day-quartile"><span class="header-section-number">5.1.2</span> Lux by Hour of Day Quartile</h4>
<div class="p-1">
<p>Repetitive SQL commands are quite verbose and repetitive, at times. Python functions, alongside data structures, such as dataframes, and dictionaries could actually help make running SQL commands less repetitive and more modular.</p>
<p>The code is designed to process and aggregate light exposure data from actigraphy datasets (likely from wearable devices) using DuckDB as an in-memory database. The code is modularized into several functions to handle different tasks, such as calculating quartiles, detecting specific columns, creating intermediate tables, and joining these tables into a final aggregated result.</p>
<p>Additionally, the code is useful for analyzing light exposure data over different times of the day (based on quartiles of hour_of_day). It aggregates the data into meaningful segments and creates a final table that can be used for further analysis or visualization. Included is a try-except block to handle any potential errors during the table joining process, ensuring that the user is informed if something goes wrong.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Extract actigraphy data based on the time of day quartile.</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quartiler(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  conn: duckdb.duckdb, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  col_name: <span class="bu">str</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  source_name: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">  ::WHY(s):: </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">    SQL can sometimes require a lot of code for repetitive commands, but in a Python environment, database queries can be modularized.</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">  ::GOAL(s)::  </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">    To process SQL queries into useful quartile information represented by intuitive key labels.</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  summaryDf <span class="op">=</span> conn.sql(<span class="ss">f"""</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="ss">  SUMMARIZE</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="ss">  SELECT</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="sc">{</span>col_name<span class="sc">}</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="ss">  FROM </span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="sc">{</span>source_name<span class="sc">}</span><span class="ss">;"""</span>).df()</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  quartileDict <span class="op">=</span> {</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min'</span>: summaryDf[<span class="st">'min'</span>][<span class="dv">0</span>]</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Q1'</span>: summaryDf.q25[<span class="dv">0</span>]</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Q2'</span>: summaryDf.q50[<span class="dv">0</span>]</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Q3'</span>: summaryDf.q75[<span class="dv">0</span>]</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'max'</span>: summaryDf[<span class="st">'max'</span>][<span class="dv">0</span>]</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> quartileDict</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> siiDetect (detect_frame: pd.DataFrame) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="st">'sii'</span> <span class="kw">in</span> detect_frame.column_name.values:</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> intermediateLighter(</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  conn: duckdb.duckdb,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  new_tables: <span class="bu">list</span>,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  quarters: <span class="bu">dict</span>, </span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  quartuples: pd.Series,</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>  from_table: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co">  :::WHY(s):::</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="co">    Tables based on the same parameters but different parameter values could be modularized.</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="co">  :::GOAL(s):::</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="co">    Process repetitive SQL efficiently and intuitively using data structures that simplify the process. </span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  detect_frame <span class="op">=</span> conn.execute(<span class="ss">f"""</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="ss">  SELECT *</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="ss">  FROM </span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="ss">    information_schema.columns</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="ss">  WHERE </span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="ss">    table_name = '</span><span class="sc">{</span>from_table<span class="sc">}</span><span class="ss">';</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="ss">  """</span>).df()</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">4</span>)):</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> siiDetect(detect_frame) <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>      conn.sql(<span class="ss">f"""</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="ss">        CREATE OR REPLACE TABLE </span><span class="sc">{</span>new_tables[i]<span class="sc">}</span><span class="ss"> AS</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a><span class="ss">        SELECT</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="ss">          id</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,enroll_season</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,age</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,sex</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,sii</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,AVG(light) AS </span><span class="sc">{</span>quartuples<span class="sc">.</span>index[i]<span class="sc">}</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a><span class="ss">        FROM </span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a><span class="ss">          '</span><span class="sc">{</span>from_table<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE </span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a><span class="ss">          hour_of_day BETWEEN </span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a><span class="ss">              </span><span class="sc">{</span>quarters[quartuples.iloc[i][<span class="dv">0</span>]]<span class="sc">}</span><span class="ss">::DOUBLE </span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a><span class="ss">            AND </span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a><span class="ss">              </span><span class="sc">{</span>quarters[quartuples.iloc[i][<span class="dv">1</span>]]<span class="sc">}</span><span class="ss">::DOUBLE</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a><span class="ss">        GROUP BY </span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a><span class="ss">          ALL</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a><span class="ss">        ORDER BY </span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a><span class="ss">          id ASC;"""</span>)</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>      conn.sql(<span class="ss">f"""</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a><span class="ss">        CREATE OR REPLACE TABLE </span><span class="sc">{</span>new_tables[i]<span class="sc">}</span><span class="ss"> AS</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a><span class="ss">        SELECT</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a><span class="ss">          id</span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,enroll_season</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,age</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,sex</span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a><span class="ss">          ,AVG(light) AS </span><span class="sc">{</span>quartuples<span class="sc">.</span>index[i]<span class="sc">}</span></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a><span class="ss">        FROM </span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a><span class="ss">          '</span><span class="sc">{</span>from_table<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a><span class="ss">        WHERE </span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a><span class="ss">          hour_of_day BETWEEN </span></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a><span class="ss">              </span><span class="sc">{</span>quarters[quartuples.iloc[i][<span class="dv">0</span>]]<span class="sc">}</span><span class="ss">::DOUBLE </span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a><span class="ss">            AND </span></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a><span class="ss">              </span><span class="sc">{</span>quarters[quartuples.iloc[i][<span class="dv">1</span>]]<span class="sc">}</span><span class="ss">::DOUBLE</span></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a><span class="ss">        GROUP BY </span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a><span class="ss">          ALL</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a><span class="ss">        ORDER BY </span></span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a><span class="ss">          id ASC;"""</span>)</span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> joinLights (from_to_tables: <span class="bu">dict</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> from_table, to_table <span class="kw">in</span> from_to_tables.items():</span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>    new_tables <span class="op">=</span> [<span class="st">'Light1'</span>, <span class="st">'Light2'</span>, <span class="st">'Light3'</span>, <span class="st">'Light4'</span>]</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>    quarters <span class="op">=</span> quartiler(conn, <span class="st">'hour_of_day'</span>, from_table)</span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>    intermediateLighter(conn, new_tables, quarters, quartuples, from_table)</span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>    conn.sql(<span class="ss">f"""</span></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a><span class="ss">    CREATE OR REPLACE TABLE </span><span class="sc">{</span>to_table<span class="sc">}</span><span class="ss"> AS</span></span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a><span class="ss">    SELECT </span></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a><span class="ss">      l1.*</span></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a><span class="ss">      ,l2.q1_q2</span></span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a><span class="ss">      ,l3.q2_q3</span></span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a><span class="ss">      ,l4.q3_max</span></span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a><span class="ss">    FROM </span></span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a><span class="ss">      Light1 l1</span></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a><span class="ss">    LEFT JOIN Light2 l2 ON l1.id = l2.id</span></span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a><span class="ss">    LEFT JOIN Light3 l3 ON l1.id = l3.id</span></span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a><span class="ss">    LEFT JOIN Light4 l4 ON l1.id = l4.id;</span></span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span>)</span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> table <span class="kw">in</span> new_tables:</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a>      conn.sql(<span class="ss">f"DROP TABLE </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss">;"</span>)</span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a>quartuples <span class="op">=</span> pd.Series(</span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> </span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>  [(<span class="st">'min'</span>,<span class="st">'Q1'</span>)</span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>  ,(<span class="st">'Q1'</span>, <span class="st">'Q2'</span>)</span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a>  ,(<span class="st">'Q2'</span>, <span class="st">'Q3'</span>)</span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>  ,(<span class="st">'Q3'</span> ,<span class="st">'max'</span>)]</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a>  ,index <span class="op">=</span></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'min_q1'</span></span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'q1_q2'</span></span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'q2_q3'</span></span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'q3_max'</span>])</span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a>from_to_tables <span class="op">=</span> {</span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ActigraphyTrain'</span>: <span class="st">'AggregatedLights'</span></span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'ActigraphyTest'</span>: <span class="st">'AggregatedLightsTest'</span></span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a>  joinLights(from_to_tables)</span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>  pydf <span class="op">=</span> conn.sql(<span class="st">"SELECT * FROM AggregatedLights LIMIT 10;"</span>).df()</span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Joined the lux tables and saved a preview of the aggregated table."</span>)</span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Lux tables were not joined."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Joined the lux tables and saved a preview of the aggregated table.</code></pre>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Free unused database memory from dropped tables and such.</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  conn.sql(<span class="ss">f"CHECKPOINT;"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Cleared unused memory."</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Could not clean unused memory."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>┌─────────┐
│ Success │
│ boolean │
├─────────┤
│ 0 rows  │
└─────────┘

Cleared unused memory.</code></pre>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>pydf</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Unique participant identifier."</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Participant enrollment into study season."</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Age in years."</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sex (0 = Female, 1 = Male)"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Severity Impairment Index"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean light exposure across Q1 of a 24 hour time scale."</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean light exposure across Q2 of a 24 hour time scale."</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean light exposure across Q3 of a 24 hour time scale."</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean light exposure across Q4 of a 24 hour time scale."</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"id"</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"enroll_season"</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"age"</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"sex"</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">"sii"</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'min_q1'</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'q1_q2'</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'q2_q3'</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  ,<span class="st">'q3_max'</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">notes =</span> notes_list, </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">locations =</span> locations_list)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval_palette</span>(<span class="st">"harrypotter::ravenclaw"</span>, <span class="dv">7</span>, <span class="st">'c'</span>, <span class="dv">1</span>))</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Quartile Data - Lights"</span>,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="p-1">
<p><a href="#tbl-AggregatedLights" class="quarto-xref">Table&nbsp;4</a>, returns the averages of light exposure, grouped by individual participants across the 4 6-hour time-frames of the day.</p>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-AggregatedLights" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-AggregatedLights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Quantiles related to mean lux exposure.
</figcaption>
<div aria-describedby="tbl-AggregatedLights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="iujlnaznfa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iujlnaznfa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iujlnaznfa thead, #iujlnaznfa tbody, #iujlnaznfa tfoot, #iujlnaznfa tr, #iujlnaznfa td, #iujlnaznfa th {
  border-style: none;
}

#iujlnaznfa p {
  margin: 0;
  padding: 0;
}

#iujlnaznfa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iujlnaznfa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iujlnaznfa .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#iujlnaznfa .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#iujlnaznfa .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iujlnaznfa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#iujlnaznfa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#iujlnaznfa .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iujlnaznfa .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iujlnaznfa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iujlnaznfa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iujlnaznfa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iujlnaznfa .gt_spanner_row {
  border-bottom-style: hidden;
}

#iujlnaznfa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iujlnaznfa .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iujlnaznfa .gt_from_md > :first-child {
  margin-top: 0;
}

#iujlnaznfa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iujlnaznfa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iujlnaznfa .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iujlnaznfa .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iujlnaznfa .gt_row_group_first td {
  border-top-width: 2px;
}

#iujlnaznfa .gt_row_group_first th {
  border-top-width: 2px;
}

#iujlnaznfa .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iujlnaznfa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iujlnaznfa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iujlnaznfa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iujlnaznfa .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iujlnaznfa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iujlnaznfa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iujlnaznfa .gt_striped {
  background-color: #333333;
}

#iujlnaznfa .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#iujlnaznfa .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iujlnaznfa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#iujlnaznfa .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iujlnaznfa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iujlnaznfa .gt_left {
  text-align: left;
}

#iujlnaznfa .gt_center {
  text-align: center;
}

#iujlnaznfa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iujlnaznfa .gt_font_normal {
  font-weight: normal;
}

#iujlnaznfa .gt_font_bold {
  font-weight: bold;
}

#iujlnaznfa .gt_font_italic {
  font-style: italic;
}

#iujlnaznfa .gt_super {
  font-size: 65%;
}

#iujlnaznfa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iujlnaznfa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iujlnaznfa .gt_indent_1 {
  text-indent: 5px;
}

#iujlnaznfa .gt_indent_2 {
  text-indent: 10px;
}

#iujlnaznfa .gt_indent_3 {
  text-indent: 15px;
}

#iujlnaznfa .gt_indent_4 {
  text-indent: 20px;
}

#iujlnaznfa .gt_indent_5 {
  text-indent: 25px;
}

#iujlnaznfa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iujlnaznfa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Quartile Data - Lights</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="id">id<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="enroll_season">enroll_season<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="age">age<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sex">sex<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="sii">sii<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="min_q1">min_q1<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q1_q2">q1_q2<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q2_q3">q2_q3<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>8</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q3_max">q3_max<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>9</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="id" class="gt_row gt_left" style="background-color: #006699; color: #FFFFFF;">00115b9f</td>
<td headers="enroll_season" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">Winter</td>
<td headers="age" class="gt_row gt_center" style="background-color: #2C8FC2; color: #FFFFFF;">9</td>
<td headers="sex" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="sii" class="gt_row gt_center" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="min_q1" class="gt_row gt_right" style="background-color: #CEB197; color: #000000;">23.045631</td>
<td headers="q1_q2" class="gt_row gt_right" style="background-color: #65AFD9; color: #000000;">61.57957</td>
<td headers="q2_q3" class="gt_row gt_right" style="background-color: #268ABD; color: #FFFFFF;">52.81590</td>
<td headers="q3_max" class="gt_row gt_right" style="background-color: #3599CC; color: #FFFFFF;">17.014504</td></tr>
    <tr><td headers="id" class="gt_row gt_left gt_striped" style="background-color: #1477AA; color: #FFFFFF;">001f3379</td>
<td headers="enroll_season" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">Spring</td>
<td headers="age" class="gt_row gt_center gt_striped" style="background-color: #8CBDD9; color: #000000;">13</td>
<td headers="sex" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="min_q1" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">2.091995</td>
<td headers="q1_q2" class="gt_row gt_right gt_striped" style="background-color: #2286B9; color: #FFFFFF;">38.87517</td>
<td headers="q2_q3" class="gt_row gt_right gt_striped" style="background-color: #0D71A4; color: #FFFFFF;">27.36520</td>
<td headers="q3_max" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">3.436843</td></tr>
    <tr><td headers="id" class="gt_row gt_left" style="background-color: #298CC0; color: #FFFFFF;">00f332d1</td>
<td headers="enroll_season" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">Winter</td>
<td headers="age" class="gt_row gt_center" style="background-color: #A8BECA; color: #000000;">14</td>
<td headers="sex" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="sii" class="gt_row gt_center" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="min_q1" class="gt_row gt_right" style="background-color: #B8B9B7; color: #000000;">20.997433</td>
<td headers="q1_q2" class="gt_row gt_right" style="background-color: #8ABCD9; color: #000000;">70.66200</td>
<td headers="q2_q3" class="gt_row gt_right" style="background-color: #D3761C; color: #FFFFFF;">172.14445</td>
<td headers="q3_max" class="gt_row gt_right" style="background-color: #45A7D9; color: #FFFFFF;">20.099417</td></tr>
    <tr><td headers="id" class="gt_row gt_left gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">012e3869</td>
<td headers="enroll_season" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">Summer</td>
<td headers="age" class="gt_row gt_center gt_striped" style="background-color: #0B6FA2; color: #FFFFFF;">6</td>
<td headers="sex" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="sii" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="min_q1" class="gt_row gt_right gt_striped" style="background-color: #42A6D9; color: #FFFFFF;">13.294238</td>
<td headers="q1_q2" class="gt_row gt_right gt_striped" style="background-color: #086CA0; color: #FFFFFF;">21.50671</td>
<td headers="q2_q3" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">14.48623</td>
<td headers="q3_max" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">11.505972</td></tr>
    <tr><td headers="id" class="gt_row gt_left" style="background-color: #80B9D9; color: #000000;">029a19c9</td>
<td headers="enroll_season" class="gt_row gt_center" style="background-color: #98C2D9; color: #000000;">Winter</td>
<td headers="age" class="gt_row gt_center" style="background-color: #DBA16D; color: #000000;">17</td>
<td headers="sex" class="gt_row gt_right" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="min_q1" class="gt_row gt_right" style="background-color: #3599CC; color: #FFFFFF;">11.332134</td>
<td headers="q1_q2" class="gt_row gt_right" style="background-color: #58ABD9; color: #FFFFFF;">58.91847</td>
<td headers="q2_q3" class="gt_row gt_right" style="background-color: #1478AB; color: #FFFFFF;">35.59866</td>
<td headers="q3_max" class="gt_row gt_right" style="background-color: #0F73A6; color: #FFFFFF;">7.528591</td></tr>
    <tr><td headers="id" class="gt_row gt_left gt_striped" style="background-color: #B4BBBC; color: #000000;">02cebf33</td>
<td headers="enroll_season" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">Spring</td>
<td headers="age" class="gt_row gt_center gt_striped" style="background-color: #71B3D9; color: #000000;">12</td>
<td headers="sex" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="min_q1" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">35.523693</td>
<td headers="q1_q2" class="gt_row gt_right gt_striped" style="background-color: #086DA0; color: #FFFFFF;">21.77969</td>
<td headers="q2_q3" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">44.71041</td>
<td headers="q3_max" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">52.702508</td></tr>
    <tr><td headers="id" class="gt_row gt_left" style="background-color: #D9AC82; color: #000000;">02cf7384</td>
<td headers="enroll_season" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">Summer</td>
<td headers="age" class="gt_row gt_center" style="background-color: #D4AF8C; color: #000000;">16</td>
<td headers="sex" class="gt_row gt_right" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="min_q1" class="gt_row gt_right" style="background-color: #197DB0; color: #FFFFFF;">7.042261</td>
<td headers="q1_q2" class="gt_row gt_right" style="background-color: #086C9F; color: #FFFFFF;">21.47413</td>
<td headers="q2_q3" class="gt_row gt_right" style="background-color: #0A6EA1; color: #FFFFFF;">24.09722</td>
<td headers="q3_max" class="gt_row gt_right" style="background-color: #0E72A5; color: #FFFFFF;">7.120843</td></tr>
    <tr><td headers="id" class="gt_row gt_left gt_striped" style="background-color: #DB8C45; color: #FFFFFF;">035c96dd</td>
<td headers="enroll_season" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">Summer</td>
<td headers="age" class="gt_row gt_center gt_striped" style="background-color: #8CBDD9; color: #000000;">13</td>
<td headers="sex" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="min_q1" class="gt_row gt_right gt_striped" style="background-color: #65AFD9; color: #000000;">15.085578</td>
<td headers="q1_q2" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">16.63144</td>
<td headers="q2_q3" class="gt_row gt_right gt_striped" style="background-color: #056A9D; color: #FFFFFF;">19.23520</td>
<td headers="q3_max" class="gt_row gt_right gt_striped" style="background-color: #2A8DC0; color: #FFFFFF;">14.558172</td></tr>
    <tr><td headers="id" class="gt_row gt_left" style="background-color: #CC7017; color: #FFFFFF;">0417c91e</td>
<td headers="enroll_season" class="gt_row gt_center" style="background-color: #1B80B3; color: #FFFFFF;">Spring</td>
<td headers="age" class="gt_row gt_center" style="background-color: #0B6FA2; color: #FFFFFF;">6</td>
<td headers="sex" class="gt_row gt_right" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="min_q1" class="gt_row gt_right" style="background-color: #4FA9D9; color: #FFFFFF;">13.857264</td>
<td headers="q1_q2" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">132.18453</td>
<td headers="q2_q3" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">197.77672</td>
<td headers="q3_max" class="gt_row gt_right" style="background-color: #369ACD; color: #FFFFFF;">17.241575</td></tr>
    <tr><td headers="id" class="gt_row gt_left gt_striped" style="background-color: #B35900; color: #FFFFFF;">04afb6f9</td>
<td headers="enroll_season" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">Summer</td>
<td headers="age" class="gt_row gt_center gt_striped" style="background-color: #DBA16D; color: #000000;">17</td>
<td headers="sex" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="sii" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">2</td>
<td headers="min_q1" class="gt_row gt_right gt_striped" style="background-color: #55ABD9; color: #FFFFFF;">14.194009</td>
<td headers="q1_q2" class="gt_row gt_right gt_striped" style="background-color: #046A9D; color: #FFFFFF;">19.53135</td>
<td headers="q2_q3" class="gt_row gt_right gt_striped" style="background-color: #056A9D; color: #FFFFFF;">19.77159</td>
<td headers="q3_max" class="gt_row gt_right gt_striped" style="background-color: #197DB0; color: #FFFFFF;">10.799413</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="9"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Unique participant identifier.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Participant enrollment into study season.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Age in years.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Sex (0 = Female, 1 = Male)</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> Severity Impairment Index</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span> Mean light exposure across Q1 of a 24 hour time scale.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span> Mean light exposure across Q2 of a 24 hour time scale.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>8</sup></span> Mean light exposure across Q3 of a 24 hour time scale.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>9</sup></span> Mean light exposure across Q4 of a 24 hour time scale.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Join light data with internet use hours data.</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>lightsDict <span class="op">=</span> {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'AggregatedLights'</span>: <span class="st">'InternetUse'</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'AggregatedLightsTest'</span>: <span class="st">'InternetUseTest'</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> from_tbl, join_tbl <span class="kw">in</span> lightsDict.items():</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  conn.sql(<span class="ss">f"""</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="ss">  CREATE OR REPLACE TABLE '</span><span class="sc">{</span>from_tbl<span class="sc">}</span><span class="ss">' AS</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="ss">  SELECT</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="ss">    ft.*</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="ss">    ,jt.preint_eduhx_computerinternet_hoursday::INTEGER::TEXT::internet_hours_enum AS useHrs </span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="ss">  FROM</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="ss">    '</span><span class="sc">{</span>from_tbl<span class="sc">}</span><span class="ss">' ft</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="ss">    LEFT JOIN </span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>join_tbl<span class="sc">}</span><span class="ss"> jt</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="ss">    ON </span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="ss">      ft.id = jt.id;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="ss">  """</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="p-1">
<p>Checking the internet use hours parameter to get an overview along with null percentage to see if we might be able to use it, as-is, for joining with the corresponding lux quartile.</p>
</div>
<div class="code-fold-flex">

</div>
</section>
<section id="sii-lux-and-internet-use" class="level4" data-number="5.1.3">
<h4 data-number="5.1.3" class="anchored" data-anchor-id="sii-lux-and-internet-use"><span class="header-section-number">5.1.3</span> Sii, Lux, and Internet Use</h4>
<div class="p-1">
<p><a href="#tbl-useToSii" class="quarto-xref">Table&nbsp;5</a>, is returning some descriptive statistics, such as count and mean, across the behavioral index, and mean lux by quartile, grouped by internet use hours.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Group-averaging sii, internet use hours, and pre-averaged lux quartile by age and sex.</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pydf <span class="op">=</span> conn.sql(<span class="ss">f"""</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="ss">  useHrs</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,COUNT(*) AS observations</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(sii::INTEGER) AS sii</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(min_q1) AS 'q1'</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(q1_q2) AS 'q2'</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(q2_q3) AS 'q3'</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(q3_max) AS 'q4'</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="ss">FROM </span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="ss">  AggregatedLights al</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="ss">GROUP BY </span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="ss">  useHrs;"""</span>).df()</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>pydf <span class="op">=</span> pydf.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>pydf</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Hours spent on the internet, as reported by caregivers of the participants."</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Count of observations in the dataset."</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Problematic behavior score."</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean lux (12am to 6am)"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean lux (6am to 12pm)"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean lux (12pm to 6pm)"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mean lux (6pm to 12am)"</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"useHrs"</span>, </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"observations"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sii"</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"q1"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"q2"</span>,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"q3"</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"q4"</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> notes_list, </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> locations_list</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval_palette</span>(<span class="st">"harrypotter::ravenclaw"</span>, <span class="dv">7</span>, <span class="st">'c'</span>, <span class="dv">1</span>))</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Problematic Behavior to Internet Usage"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">FALSE</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>                          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-useToSii" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-useToSii-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Grouped averages of lux to sii.
</figcaption>
<div aria-describedby="tbl-useToSii-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rbtrsstddh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rbtrsstddh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rbtrsstddh thead, #rbtrsstddh tbody, #rbtrsstddh tfoot, #rbtrsstddh tr, #rbtrsstddh td, #rbtrsstddh th {
  border-style: none;
}

#rbtrsstddh p {
  margin: 0;
  padding: 0;
}

#rbtrsstddh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rbtrsstddh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rbtrsstddh .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#rbtrsstddh .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#rbtrsstddh .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbtrsstddh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#rbtrsstddh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#rbtrsstddh .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rbtrsstddh .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rbtrsstddh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rbtrsstddh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rbtrsstddh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rbtrsstddh .gt_spanner_row {
  border-bottom-style: hidden;
}

#rbtrsstddh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rbtrsstddh .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rbtrsstddh .gt_from_md > :first-child {
  margin-top: 0;
}

#rbtrsstddh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rbtrsstddh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rbtrsstddh .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtrsstddh .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rbtrsstddh .gt_row_group_first td {
  border-top-width: 2px;
}

#rbtrsstddh .gt_row_group_first th {
  border-top-width: 2px;
}

#rbtrsstddh .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtrsstddh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rbtrsstddh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rbtrsstddh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbtrsstddh .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtrsstddh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rbtrsstddh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rbtrsstddh .gt_striped {
  background-color: #333333;
}

#rbtrsstddh .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#rbtrsstddh .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbtrsstddh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtrsstddh .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbtrsstddh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtrsstddh .gt_left {
  text-align: left;
}

#rbtrsstddh .gt_center {
  text-align: center;
}

#rbtrsstddh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rbtrsstddh .gt_font_normal {
  font-weight: normal;
}

#rbtrsstddh .gt_font_bold {
  font-weight: bold;
}

#rbtrsstddh .gt_font_italic {
  font-style: italic;
}

#rbtrsstddh .gt_super {
  font-size: 65%;
}

#rbtrsstddh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rbtrsstddh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rbtrsstddh .gt_indent_1 {
  text-indent: 5px;
}

#rbtrsstddh .gt_indent_2 {
  text-indent: 10px;
}

#rbtrsstddh .gt_indent_3 {
  text-indent: 15px;
}

#rbtrsstddh .gt_indent_4 {
  text-indent: 20px;
}

#rbtrsstddh .gt_indent_5 {
  text-indent: 25px;
}

#rbtrsstddh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rbtrsstddh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Problematic Behavior to Internet Usage</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="useHrs">useHrs<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="observations">observations<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sii">sii<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q1">q1<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q2">q2<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q3">q3<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q4">q4<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="useHrs" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">0</td>
<td headers="observations" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">474</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.3291139</td>
<td headers="q1" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">12.34923</td>
<td headers="q2" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">54.33614</td>
<td headers="q3" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">75.33046</td>
<td headers="q4" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">14.37498</td></tr>
    <tr><td headers="useHrs" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">1</td>
<td headers="observations" class="gt_row gt_right gt_striped" style="background-color: #076C9F; color: #FFFFFF;">117</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #79B6D9; color: #000000;">0.6666667</td>
<td headers="q1" class="gt_row gt_right gt_striped" style="background-color: #90BFD9; color: #000000;">15.14069</td>
<td headers="q2" class="gt_row gt_right gt_striped" style="background-color: #288BBE; color: #FFFFFF;">46.08189</td>
<td headers="q3" class="gt_row gt_right gt_striped" style="background-color: #177BAE; color: #FFFFFF;">66.78185</td>
<td headers="q4" class="gt_row gt_right gt_striped" style="background-color: #2487BA; color: #FFFFFF;">15.30225</td></tr>
    <tr><td headers="useHrs" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">2</td>
<td headers="observations" class="gt_row gt_right" style="background-color: #98C2D9; color: #000000;">288</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #ACBDC5; color: #000000;">0.7534722</td>
<td headers="q1" class="gt_row gt_right" style="background-color: #40A4D7; color: #FFFFFF;">14.24140</td>
<td headers="q2" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">43.78829</td>
<td headers="q3" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">65.41403</td>
<td headers="q4" class="gt_row gt_right" style="background-color: #2589BC; color: #FFFFFF;">15.33504</td></tr>
    <tr><td headers="useHrs" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">3</td>
<td headers="observations" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">102</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">1.1176471</td>
<td headers="q1" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">18.15549</td>
<td headers="q2" class="gt_row gt_right gt_striped" style="background-color: #75B4D9; color: #000000;">48.21921</td>
<td headers="q3" class="gt_row gt_right gt_striped" style="background-color: #95C1D9; color: #000000;">70.29719</td>
<td headers="q4" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">19.04650</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td class="gt_footnote" colspan="7">
        <div style="padding-bottom:2px;"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Hours spent on the internet, as reported by caregivers of the participants., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Count of observations in the dataset., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Problematic behavior score., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Mean lux (12am to 6am), <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> Mean lux (6am to 12pm), <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span> Mean lux (12pm to 6pm), <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span> Mean lux (6pm to 12am)</div>
      </td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>plot setup</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>r_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> r_df, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> useHrs, <span class="at">y =</span> sii)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sii)) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="fu">muted</span>(<span class="st">"yellow"</span>), <span class="at">high =</span> <span class="fu">muted</span>(<span class="st">"purple"</span>)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Internet Use to Behavioral Index'</span>, </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Hours of Internet Use'</span>, </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Problematic Behavior Index (sii)"</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>r_plot <span class="ot">&lt;-</span> r_plot <span class="sc">+</span> <span class="fu">ggplot_theming</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-useSii" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-useSii-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-useSii-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Categorized bmi risk to internet use and sii."><img src="index_files/figure-html/fig-useSii-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-useSii-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Categorized bmi risk to internet use and sii.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="disease-risk-categories" class="level4" data-number="5.1.4">
<h4 data-number="5.1.4" class="anchored" data-anchor-id="disease-risk-categories"><span class="header-section-number">5.1.4</span> Disease Risk Categories</h4>
<div class="p-1">
<p>Something perhaps not seen everyday is SQL syntax in a Python environment. The performance of the SQL database, in this case, DuckDB, likely outperforms Pandas and Polars. An aim for this project was also to demonstrate some competence with SQL, but also approach practical use-case scenarios.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Combining SQL with Python data structures to organized data according to several conditions, such as: bmi, age, sex, and waist_circumference.</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>riskyDictionary <span class="op">=</span> {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Risk1'</span>: </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    (<span class="ss">f",CASE WHEN ph.physical_bmi &lt; 18.5 THEN 'Underweight'"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'"</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'Increased'"</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'High'"</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'"</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi &gt;= 40 THEN 'Extremely High'"</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"ph.physical_waist_circumference &lt;= 35 AND al.sex = '0'"</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Risk2'</span>:</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    (<span class="ss">f",CASE WHEN ph.physical_bmi &lt; 18.5 THEN 'Underweight'"</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'"</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'High'"</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'Very High'"</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'"</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi &gt;= 40 THEN 'Extremely High'"</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"ph.physical_waist_circumference &gt; 35 AND al.sex = '0'"</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Risk3'</span>:</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    (<span class="ss">f",CASE WHEN ph.physical_bmi &lt; 18.5 THEN 'Underweight'"</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'"</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'Increased'"</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'High'"</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'"</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi &gt;= 40 THEN 'Extremely High'"</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"ph.physical_waist_circumference &lt;= 40 AND al.sex = '1'"</span>),</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Risk4'</span>:</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    (<span class="ss">f",CASE WHEN ph.physical_bmi &lt; 18.5 THEN 'Underweight'"</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'"</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'High'"</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'Very High'"</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'"</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"WHEN ph.physical_bmi &gt;= 40 THEN 'Extremely High'"</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    ,<span class="ss">f"ph.physical_waist_circumference &gt; 40 AND al.sex = '1'"</span>)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>riskyDf <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> riskyDictionary)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> riskyDf.items():</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    conn.sql(<span class="ss">f"""</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="ss">    CREATE OR REPLACE TABLE </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss"> AS</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="ss">    SELECT</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="ss">      al.*</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">0</span>]<span class="sc">}</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">1</span>]<span class="sc">}</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">2</span>]<span class="sc">}</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">3</span>]<span class="sc">}</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">4</span>]<span class="sc">}</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">5</span>]<span class="sc">}</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a><span class="ss">      ELSE NULL</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="ss">      END AS risk_cat</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="ss">    ,risk_cat::disease_risk_enum AS risk_category</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="ss">    FROM </span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="ss">      Physical ph </span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="ss">    LEFT JOIN </span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="ss">      AggregatedLights al</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    ON </span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="ss">      al.id = ph.id</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    WHERE </span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="ss">      </span><span class="sc">{</span>value[<span class="dv">6</span>]<span class="sc">}</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="ss">    ORDER BY </span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="ss">      al.id ASC;</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="ss">      """</span>)</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> conn.sql(<span class="ss">f"SELECT COUNT(*) FROM </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>).fetchone()</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"created table: </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">, </span><span class="ch">\n\t</span><span class="ss">Row count: </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span>:</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error loading this table: </span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>created table: Risk1, 
    Row count: 24

created table: Risk2, 
    Row count: 1

created table: Risk3, 
    Row count: 20

created table: Risk4, 
    Row count: 2</code></pre>
</div>
<details class="code-fold">
<summary>Combining SQL with Python data structures to organized data according to several conditions, such as: bmi, age, sex, and waist_circumference.</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="ss">f"""</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="ss">CREATE OR REPLACE TABLE </span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="ss">  DiseaseRiskDemographic AS</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT * EXCLUDE(risk_cat) FROM Risk1</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="ss">UNION BY NAME</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT * EXCLUDE(risk_cat) FROM Risk2</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="ss">UNION BY NAME</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT * EXCLUDE(risk_cat) FROM Risk3</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="ss">UNION BY NAME </span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT * EXCLUDE(risk_cat) FROM Risk4;</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="p-1">
<p>It might be useful to explore statistics when grouped by risk categories.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Grouped averaging by risk category.</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>conn.sql(<span class="ss">f"""</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ss">CREATE OR REPLACE TABLE RiskCategorySummary AS</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="ss">SELECT </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="ss">  risk_category</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(sii::NUMERIC) AS sii</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(useHrs::INTEGER) AS useHrs</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(min_q1) AS 'q1'</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(q1_q2) AS 'q2'</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(q2_q3) AS 'q3'</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="ss">  ,AVG(q3_max) AS 'q4'</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="ss">FROM </span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="ss">  DiseaseRiskDemographic</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="ss">GROUP BY </span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="ss">  risk_category;</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>pydf <span class="op">=</span> conn.sql(<span class="st">"""</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT * </span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="st">FROM RiskCategorySummary;</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>).df()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>pydf</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(<span class="st">"The disease risk category."</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Problematic behavior index."</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Reported interet usage (hours)."</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"12am to 6am"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6am to 12pm."</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"12pm to 6pm"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"6pm to 12am"</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"risk_category"</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                      ,<span class="st">"sii"</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                      ,<span class="st">"useHrs"</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                      ,<span class="st">"q1"</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                      ,<span class="st">"q2"</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                      ,<span class="st">"q3"</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                      ,<span class="st">"q4"</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">notes =</span> notes_list, </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">locations =</span> locations_list)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(<span class="fu">eval_palette</span>(<span class="st">"harrypotter::ravenclaw"</span>, <span class="dv">7</span>, <span class="st">'c'</span>, <span class="dv">1</span>))</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Disease Risk Categories to Lux"</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">FALSE</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>                          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="p-1">
<p><a href="#tbl-diseaseRiskLux" class="quarto-xref">Table&nbsp;6</a> shows the grouped-averages of the problematic behavior index, internet use hours, and mean lux across the time of day quartiles by disease risk category of participants.</p>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-diseaseRiskLux" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-diseaseRiskLux-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Disease risk categories by lux exposure.
</figcaption>
<div aria-describedby="tbl-diseaseRiskLux-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qoaefwtytl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qoaefwtytl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qoaefwtytl thead, #qoaefwtytl tbody, #qoaefwtytl tfoot, #qoaefwtytl tr, #qoaefwtytl td, #qoaefwtytl th {
  border-style: none;
}

#qoaefwtytl p {
  margin: 0;
  padding: 0;
}

#qoaefwtytl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qoaefwtytl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qoaefwtytl .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#qoaefwtytl .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#qoaefwtytl .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qoaefwtytl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#qoaefwtytl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#qoaefwtytl .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qoaefwtytl .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qoaefwtytl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qoaefwtytl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qoaefwtytl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qoaefwtytl .gt_spanner_row {
  border-bottom-style: hidden;
}

#qoaefwtytl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qoaefwtytl .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qoaefwtytl .gt_from_md > :first-child {
  margin-top: 0;
}

#qoaefwtytl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qoaefwtytl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qoaefwtytl .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qoaefwtytl .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qoaefwtytl .gt_row_group_first td {
  border-top-width: 2px;
}

#qoaefwtytl .gt_row_group_first th {
  border-top-width: 2px;
}

#qoaefwtytl .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qoaefwtytl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qoaefwtytl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qoaefwtytl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qoaefwtytl .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qoaefwtytl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qoaefwtytl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qoaefwtytl .gt_striped {
  background-color: #333333;
}

#qoaefwtytl .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#qoaefwtytl .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qoaefwtytl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#qoaefwtytl .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qoaefwtytl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qoaefwtytl .gt_left {
  text-align: left;
}

#qoaefwtytl .gt_center {
  text-align: center;
}

#qoaefwtytl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qoaefwtytl .gt_font_normal {
  font-weight: normal;
}

#qoaefwtytl .gt_font_bold {
  font-weight: bold;
}

#qoaefwtytl .gt_font_italic {
  font-style: italic;
}

#qoaefwtytl .gt_super {
  font-size: 65%;
}

#qoaefwtytl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qoaefwtytl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qoaefwtytl .gt_indent_1 {
  text-indent: 5px;
}

#qoaefwtytl .gt_indent_2 {
  text-indent: 10px;
}

#qoaefwtytl .gt_indent_3 {
  text-indent: 15px;
}

#qoaefwtytl .gt_indent_4 {
  text-indent: 20px;
}

#qoaefwtytl .gt_indent_5 {
  text-indent: 25px;
}

#qoaefwtytl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qoaefwtytl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Disease Risk Categories to Lux</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="risk_category">risk_category<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sii">sii<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="useHrs">useHrs<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q1">q1<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q2">q2<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q3">q3<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="q4">q4<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">Underweight</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #92BFD9; color: #000000;">0.2424242</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.5757576</td>
<td headers="q1" class="gt_row gt_right" style="background-color: #2C8FC2; color: #FFFFFF;">13.330039</td>
<td headers="q2" class="gt_row gt_right" style="background-color: #D97E25; color: #FFFFFF;">66.41683</td>
<td headers="q3" class="gt_row gt_right" style="background-color: #BD630A; color: #FFFFFF;">115.40578</td>
<td headers="q4" class="gt_row gt_right" style="background-color: #2B8EC1; color: #FFFFFF;">13.214609</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">Normal</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #3194C8; color: #FFFFFF;">1.2000000</td>
<td headers="q1" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">35.113050</td>
<td headers="q2" class="gt_row gt_right gt_striped" style="background-color: #DAA676; color: #000000;">61.22258</td>
<td headers="q3" class="gt_row gt_right gt_striped" style="background-color: #8EBED9; color: #000000;">90.43512</td>
<td headers="q4" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">30.368059</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">Increased</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #C1B7AB; color: #000000;">2.0000000</td>
<td headers="q1" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">6.728299</td>
<td headers="q2" class="gt_row gt_right" style="background-color: #02689B; color: #FFFFFF;">35.98224</td>
<td headers="q3" class="gt_row gt_right" style="background-color: #3A9ED1; color: #FFFFFF;">81.17680</td>
<td headers="q4" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">8.067938</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #D9AC82; color: #000000;">Very High</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #DB883B; color: #FFFFFF;">2.5000000</td>
<td headers="q1" class="gt_row gt_right gt_striped" style="background-color: #C2B6AA; color: #000000;">23.489066</td>
<td headers="q2" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">35.45635</td>
<td headers="q3" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">65.65650</td>
<td headers="q4" class="gt_row gt_right gt_striped" style="background-color: #A2C0D0; color: #000000;">19.591619</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #D97C21; color: #FFFFFF;">Extremely High</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">3.0000000</td>
<td headers="q1" class="gt_row gt_right" style="background-color: #8FBED9; color: #000000;">20.273825</td>
<td headers="q2" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">72.87793</td>
<td headers="q3" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">117.79320</td>
<td headers="q4" class="gt_row gt_right" style="background-color: #DB9250; color: #FFFFFF;">24.963076</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td class="gt_footnote" colspan="7">
        <div style="padding-bottom:2px;"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> The disease risk category., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Problematic behavior index., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Reported interet usage (hours)., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> 12am to 6am, <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> 6am to 12pm., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span> 12pm to 6pm, <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span> 6pm to 12am</div>
      </td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Pivoting the data longer to accommodate more useful plot output.</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> r_df <span class="sc">|&gt;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(q1, q2, q3, q4),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"quarter"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"lux"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quarter =</span> <span class="fu">factor</span>(quarter, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"q1"</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"q2"</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"q3"</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"q4"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"risk_category"</span>, <span class="st">"sii"</span>, <span class="st">"useHrs"</span>, <span class="st">"quarter"</span>, <span class="st">"lux"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(<span class="st">"Disease risk based on BMI, waist circumference, and sex."</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Problematic behavior index."</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Hours of reported internet use."</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Quartile of day."</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Average light exposure."</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">notes =</span> notes_list, <span class="at">locations =</span> locations_list)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(<span class="fu">eval_palette</span>(<span class="st">"harrypotter::ravenclaw"</span>, <span class="dv">7</span>, <span class="st">'c'</span>, <span class="dv">1</span>)))</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(data_long,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Disease Risk Categories to Lux"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="st">"Pivoted Longer"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tbl_font_size =</span> <span class="fu">pct</span>(<span class="dv">80</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>                          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="p-1">
<p><a href="#tbl-longerDiseaseCat" class="quarto-xref">Table&nbsp;7</a> is a pivoted version of the previous table, <a href="#tbl-diseaseRiskLux" class="quarto-xref">Table&nbsp;6</a>.</p>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-longerDiseaseCat" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-longerDiseaseCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7
</figcaption>
<div aria-describedby="tbl-longerDiseaseCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="tgxcrybver" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tgxcrybver table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tgxcrybver thead, #tgxcrybver tbody, #tgxcrybver tfoot, #tgxcrybver tr, #tgxcrybver td, #tgxcrybver th {
  border-style: none;
}

#tgxcrybver p {
  margin: 0;
  padding: 0;
}

#tgxcrybver .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 80%;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tgxcrybver .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tgxcrybver .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#tgxcrybver .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#tgxcrybver .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tgxcrybver .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#tgxcrybver .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#tgxcrybver .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tgxcrybver .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tgxcrybver .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tgxcrybver .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tgxcrybver .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tgxcrybver .gt_spanner_row {
  border-bottom-style: hidden;
}

#tgxcrybver .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tgxcrybver .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tgxcrybver .gt_from_md > :first-child {
  margin-top: 0;
}

#tgxcrybver .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tgxcrybver .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tgxcrybver .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tgxcrybver .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tgxcrybver .gt_row_group_first td {
  border-top-width: 2px;
}

#tgxcrybver .gt_row_group_first th {
  border-top-width: 2px;
}

#tgxcrybver .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgxcrybver .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tgxcrybver .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tgxcrybver .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgxcrybver .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgxcrybver .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tgxcrybver .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tgxcrybver .gt_striped {
  background-color: #333333;
}

#tgxcrybver .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#tgxcrybver .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tgxcrybver .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgxcrybver .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tgxcrybver .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgxcrybver .gt_left {
  text-align: left;
}

#tgxcrybver .gt_center {
  text-align: center;
}

#tgxcrybver .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tgxcrybver .gt_font_normal {
  font-weight: normal;
}

#tgxcrybver .gt_font_bold {
  font-weight: bold;
}

#tgxcrybver .gt_font_italic {
  font-style: italic;
}

#tgxcrybver .gt_super {
  font-size: 65%;
}

#tgxcrybver .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tgxcrybver .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tgxcrybver .gt_indent_1 {
  text-indent: 5px;
}

#tgxcrybver .gt_indent_2 {
  text-indent: 10px;
}

#tgxcrybver .gt_indent_3 {
  text-indent: 15px;
}

#tgxcrybver .gt_indent_4 {
  text-indent: 20px;
}

#tgxcrybver .gt_indent_5 {
  text-indent: 25px;
}

#tgxcrybver .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tgxcrybver div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal" style="">Disease Risk Categories to Lux</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Pivoted Longer</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="risk_category">risk_category<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sii">sii<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="useHrs">useHrs<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="quarter">quarter<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lux">lux<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">Underweight</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #92BFD9; color: #000000;">0.2424242</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.5757576</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">q1</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #0B6FA2; color: #FFFFFF;">13.330039</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">Underweight</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #92BFD9; color: #000000;">0.2424242</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0.5757576</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">q2</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #ACBDC5; color: #000000;">66.416830</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">Underweight</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #92BFD9; color: #000000;">0.2424242</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.5757576</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">q3</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #B85D04; color: #FFFFFF;">115.405777</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #006699; color: #FFFFFF;">Underweight</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #92BFD9; color: #000000;">0.2424242</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0.5757576</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">q4</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #0B6FA2; color: #FFFFFF;">13.214609</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #1B80B3; color: #FFFFFF;">Normal</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #3194C8; color: #FFFFFF;">1.2000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">q1</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #3194C7; color: #FFFFFF;">35.113050</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">Normal</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #3194C8; color: #FFFFFF;">1.2000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">q2</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #94C0D9; color: #000000;">61.222575</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #1B80B3; color: #FFFFFF;">Normal</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #3194C8; color: #FFFFFF;">1.2000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">q3</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #DB9352; color: #000000;">90.435121</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">Normal</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #3194C8; color: #FFFFFF;">1.2000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">q4</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #278ABD; color: #FFFFFF;">30.368059</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">Increased</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #C1B7AB; color: #000000;">2.0000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">q1</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">6.728299</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">Increased</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #C1B7AB; color: #000000;">2.0000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">q2</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #3396C9; color: #FFFFFF;">35.982235</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">Increased</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #C1B7AB; color: #000000;">2.0000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">q3</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #D9AB80; color: #000000;">81.176802</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #41A6D9; color: #FFFFFF;">Increased</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #C1B7AB; color: #000000;">2.0000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">q4</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #02689B; color: #FFFFFF;">8.067938</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #D9AC82; color: #000000;">Very High</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #DB883B; color: #FFFFFF;">2.5000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">q1</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #197DB1; color: #FFFFFF;">23.489066</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #D9AC82; color: #000000;">Very High</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #DB883B; color: #FFFFFF;">2.5000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">q2</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #3295C8; color: #FFFFFF;">35.456346</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #D9AC82; color: #000000;">Very High</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #DB883B; color: #FFFFFF;">2.5000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">q3</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #A9BEC9; color: #000000;">65.656499</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #D9AC82; color: #000000;">Very High</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">0.5000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #DB883B; color: #FFFFFF;">2.5000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">q4</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #1478AB; color: #FFFFFF;">19.591619</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #D97C21; color: #FFFFFF;">Extremely High</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">3.0000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #006699; color: #FFFFFF;">q1</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #1579AC; color: #FFFFFF;">20.273825</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #D97C21; color: #FFFFFF;">Extremely High</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">3.0000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">q2</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #C4B5A7; color: #000000;">72.877935</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center" style="background-color: #D97C21; color: #FFFFFF;">Extremely High</td>
<td headers="sii" class="gt_row gt_right" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">3.0000000</td>
<td headers="quarter" class="gt_row gt_center" style="background-color: #41A6D9; color: #FFFFFF;">q3</td>
<td headers="lux" class="gt_row gt_right" style="background-color: #B35900; color: #FFFFFF;">117.793201</td></tr>
    <tr><td headers="risk_category" class="gt_row gt_center gt_striped" style="background-color: #D97C21; color: #FFFFFF;">Extremely High</td>
<td headers="sii" class="gt_row gt_right gt_striped" style="background-color: #006699; color: #FFFFFF;">0.0000000</td>
<td headers="useHrs" class="gt_row gt_right gt_striped" style="background-color: #B35900; color: #FFFFFF;">3.0000000</td>
<td headers="quarter" class="gt_row gt_center gt_striped" style="background-color: #98C2D9; color: #000000;">q4</td>
<td headers="lux" class="gt_row gt_right gt_striped" style="background-color: #1B80B3; color: #FFFFFF;">24.963076</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="5"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Disease risk based on BMI, waist circumference, and sex.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Problematic behavior index.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Hours of reported internet use.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Quartile of day.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> Average light exposure.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>plot setup</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>r_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data_long, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> quarter, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lux, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> risk_category, </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> risk_category)) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Does disease risk relate to light exposure</span><span class="sc">\n</span><span class="st"> by certain times of the day?"</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time Period"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean Lux Value"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Risk Category"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>r_plot <span class="ot">&lt;-</span> r_plot <span class="sc">+</span> <span class="fu">ggplot_theming</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p><a href="#fig-luxRiskCat" class="quarto-xref">Figure&nbsp;2</a> was an attempt at visualizing the relationship, if any, by mean lux exposure across participants, time of day quartile, and disease risk. Disease risk was based on BMI, waist-circumference, and sex data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-luxRiskCat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-luxRiskCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-luxRiskCat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Grouped risk by lux and time period."><img src="index_files/figure-html/fig-luxRiskCat-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-luxRiskCat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Grouped risk by lux and time period.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summary-profiles" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="summary-profiles"><span class="header-section-number">6</span> Summary Profiles</h2>
<div class="p-1">
<p>In the future, this data could be further explored. For now, the descriptive statistics can be saved to files for quickly restarting and diving deeper.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Create future training and testing data profiles from summary statistics to inform modeling choices.</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>summary_dict <span class="op">=</span> {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ActigraphyTrain'</span>: </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'ActigraphyTrainSummary'</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'data/profiles/actigraphy_train_profile.csv'</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ActigraphyTest'</span>: </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'ActigraphyTestSummary'</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'data/profiles/actigraphy_test_profile.csv'</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'TrainCsv'</span>: </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'TrainCsvSummary'</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'data/profiles/train_csv_profile.csv'</span>),</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">'TestCsv'</span>: </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'TestCsvSummary'</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'data/profiles/test_csv_profile.csv'</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>summary_frame <span class="op">=</span> pd.DataFrame(summary_dict)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> summary_frame.items():</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    py_summary_df <span class="op">=</span> conn.sql(<span class="ss">f"SUMMARIZE SELECT * FROM '</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">';"</span>).df()</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    conn.register(value[<span class="dv">0</span>], py_summary_df)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    conn.sql(<span class="ss">f"COPY </span><span class="sc">{</span>value[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> TO '</span><span class="sc">{</span>value[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">' (HEADER , DELIMITER ',');"</span>)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>value[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">' was CREATED</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span>:</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"'</span><span class="sc">{</span>value[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">' was not CREATED</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0&gt;
'data/profiles/actigraphy_train_profile.csv' was CREATED

&lt;duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0&gt;
'data/profiles/actigraphy_test_profile.csv' was CREATED

&lt;duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0&gt;
'data/profiles/train_csv_profile.csv' was CREATED

&lt;duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0&gt;
'data/profiles/test_csv_profile.csv' was CREATED</code></pre>
</div>
</div>
</div>
</section>
<section id="close-connection" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="close-connection"><span class="header-section-number">7</span> Close Connection</h2>
<p>The in-memory database connection can be closed.</p>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Releases all database memory and de-references the connection variable.</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  conn.close()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"database connection closed"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"could not close the connection"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>database connection closed</code></pre>
</div>
</div>
</div>
</section>
<section id="closing-thoughts" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="closing-thoughts"><span class="header-section-number">8</span> Closing Thoughts</h2>
<div class="p-1">
<p>The purpose of the article was to explore an active Kaggle competition dataset and improve workflow methodologies and output. This analysis can be expanded to be more insightful for this particular domain. The objective has been achieved as much was learned and improved functions have been developed alongside improved CSS styling.</p>
<p>This particular dataset contained a lot of missing data despite being quite large. Due to this incomplete data across many of the columns, some of the data transformations resulted in as low as ~50 observations from the original ~1000. The leaderboard that came along with this dataset from a past competition suggests that the model accuracy tops out only around 0.48, <a href="#tbl-leaderboard" class="quarto-xref">Table&nbsp;8</a>. While some patterns could be gleaned, the predictive power of any modeling attempts might as well have been doomed.</p>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>Reads a recently downloaded the private leaderboard csv (from the competition website’s Leaderboard tab) to a dataframe.</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>leaderboard_path <span class="op">=</span> <span class="st">"data/privateLeaderboard.csv"</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>leaderboard_df <span class="op">=</span> pd.read_csv(leaderboard_path)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>py_df <span class="op">=</span> leaderboard_df.head(n <span class="op">=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="code-fold-flex">
<div class="cell">
<details class="code-fold">
<summary>table setup</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> py<span class="sc">$</span>py_df</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>notes_list <span class="ot">=</span>  <span class="fu">list</span>(<span class="st">"Overall ranking"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Unique team ID."</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Chosen name of the team."</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Their final submission date."</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"The accuracy score of model."</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Total competition submissions."</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Names of the team members."</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>locations_list <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Rank"</span>, </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TeamId"</span>, </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TeamName"</span>, </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LastSubmissionDate"</span>, </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Score"</span>, </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SubmissionCount"</span>, </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TeamMemberUserNames"</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>footnotes_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">notes =</span> notes_list, </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">locations =</span> locations_list)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>pal_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> locations_list,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">pals =</span> <span class="fu">list</span>(<span class="fu">eval_palette</span>(<span class="st">"ggsci::legacy_tron"</span>, <span class="dv">7</span>, <span class="st">'d'</span>, <span class="dv">1</span>))</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>rTable <span class="ot">&lt;-</span> <span class="fu">r_table_theming</span>(r_df,</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Leaderboard Rankings"</span>,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>                          footnotes_df,</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"**source**: Kaggle"</span>),</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>                          pal_df,</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiline_feet =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">target_everything =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color_by_columns =</span> <span class="st">"Rank"</span>,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tbl_font_size =</span> <span class="fu">pct</span>(<span class="dv">75</span>)</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>                          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="table-flex">
<div class="cell">
<div id="tbl-leaderboard" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-leaderboard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8
</figcaption>
<div aria-describedby="tbl-leaderboard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="mdoevtttoy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mdoevtttoy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mdoevtttoy thead, #mdoevtttoy tbody, #mdoevtttoy tfoot, #mdoevtttoy tr, #mdoevtttoy td, #mdoevtttoy th {
  border-style: none;
}

#mdoevtttoy p {
  margin: 0;
  padding: 0;
}

#mdoevtttoy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: 1px;
  margin-right: 1px;
  color: #FFFFFF;
  font-size: 75%;
  font-weight: normal;
  font-style: normal;
  background-color: #222222;
  width: auto;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mdoevtttoy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mdoevtttoy .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #222222;
  border-bottom-width: 0;
}

#mdoevtttoy .gt_subtitle {
  color: #FFFFFF;
  font-size: 110%;
  font-weight: initial;
  padding-top: 19px;
  padding-bottom: 21px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #222222;
  border-top-width: 0;
}

#mdoevtttoy .gt_heading {
  background-color: #222222;
  text-align: center;
  border-bottom-color: #222222;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mdoevtttoy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#mdoevtttoy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
}

#mdoevtttoy .gt_col_heading {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #000000;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 11px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mdoevtttoy .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #333333;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mdoevtttoy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mdoevtttoy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mdoevtttoy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 10px;
  padding-bottom: 10px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mdoevtttoy .gt_spanner_row {
  border-bottom-style: hidden;
}

#mdoevtttoy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mdoevtttoy .gt_empty_group_heading {
  padding: 0.5px;
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mdoevtttoy .gt_from_md > :first-child {
  margin-top: 0;
}

#mdoevtttoy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mdoevtttoy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-left-style: none;
  border-left-width: 0px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mdoevtttoy .gt_stub {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mdoevtttoy .gt_stub_row_group {
  color: #FFFFFF;
  background-color: #222222;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mdoevtttoy .gt_row_group_first td {
  border-top-width: 2px;
}

#mdoevtttoy .gt_row_group_first th {
  border-top-width: 2px;
}

#mdoevtttoy .gt_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mdoevtttoy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mdoevtttoy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mdoevtttoy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mdoevtttoy .gt_grand_summary_row {
  color: #FFFFFF;
  background-color: #222222;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mdoevtttoy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mdoevtttoy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mdoevtttoy .gt_striped {
  background-color: #333333;
}

#mdoevtttoy .gt_table_body {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #000000;
}

#mdoevtttoy .gt_footnotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mdoevtttoy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 5px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
}

#mdoevtttoy .gt_sourcenotes {
  color: #FFFFFF;
  background-color: #222222;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mdoevtttoy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mdoevtttoy .gt_left {
  text-align: left;
}

#mdoevtttoy .gt_center {
  text-align: center;
}

#mdoevtttoy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mdoevtttoy .gt_font_normal {
  font-weight: normal;
}

#mdoevtttoy .gt_font_bold {
  font-weight: bold;
}

#mdoevtttoy .gt_font_italic {
  font-style: italic;
}

#mdoevtttoy .gt_super {
  font-size: 65%;
}

#mdoevtttoy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mdoevtttoy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mdoevtttoy .gt_indent_1 {
  text-indent: 5px;
}

#mdoevtttoy .gt_indent_2 {
  text-indent: 10px;
}

#mdoevtttoy .gt_indent_3 {
  text-indent: 15px;
}

#mdoevtttoy .gt_indent_4 {
  text-indent: 20px;
}

#mdoevtttoy .gt_indent_5 {
  text-indent: 25px;
}

#mdoevtttoy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mdoevtttoy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Leaderboard Rankings</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Rank">Rank<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="TeamId">TeamId<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="TeamName">TeamName<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LastSubmissionDate">LastSubmissionDate<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Score">Score<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SubmissionCount">SubmissionCount<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="TeamMemberUserNames">TeamMemberUserNames<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Rank" class="gt_row gt_right" style="background-color: #FF410D; color: #FFFFFF;">1</td>
<td headers="TeamId" class="gt_row gt_right" style="background-color: #FF410D; color: #FFFFFF;">12642715</td>
<td headers="TeamName" class="gt_row gt_left" style="background-color: #FF410D; color: #FFFFFF;">Lennart Haupts</td>
<td headers="LastSubmissionDate" class="gt_row gt_right" style="background-color: #FF410D; color: #FFFFFF;">2024-12-19 10:51:55</td>
<td headers="Score" class="gt_row gt_right" style="background-color: #FF410D; color: #FFFFFF;">0.482</td>
<td headers="SubmissionCount" class="gt_row gt_right" style="background-color: #FF410D; color: #FFFFFF;">127</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left" style="background-color: #FF410D; color: #FFFFFF;">lennarthaupts</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right gt_striped" style="background-color: #CAB5AF; color: #000000;">2</td>
<td headers="TeamId" class="gt_row gt_right gt_striped" style="background-color: #CAB5AF; color: #000000;">12640776</td>
<td headers="TeamName" class="gt_row gt_left gt_striped" style="background-color: #CAB5AF; color: #000000;">Aradhye Agarwal</td>
<td headers="LastSubmissionDate" class="gt_row gt_right gt_striped" style="background-color: #CAB5AF; color: #000000;">2024-09-21 16:43:26</td>
<td headers="Score" class="gt_row gt_right gt_striped" style="background-color: #CAB5AF; color: #000000;">0.478</td>
<td headers="SubmissionCount" class="gt_row gt_right gt_striped" style="background-color: #CAB5AF; color: #000000;">2</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left gt_striped" style="background-color: #CAB5AF; color: #000000;">aradhyeagarwal</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right" style="background-color: #B9D8BF; color: #000000;">3</td>
<td headers="TeamId" class="gt_row gt_right" style="background-color: #B9D8BF; color: #000000;">12795402</td>
<td headers="TeamName" class="gt_row gt_left" style="background-color: #B9D8BF; color: #000000;">Jobayer Hossain</td>
<td headers="LastSubmissionDate" class="gt_row gt_right" style="background-color: #B9D8BF; color: #000000;">2024-12-19 23:21:50</td>
<td headers="Score" class="gt_row gt_right" style="background-color: #B9D8BF; color: #000000;">0.478</td>
<td headers="SubmissionCount" class="gt_row gt_right" style="background-color: #B9D8BF; color: #000000;">71</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left" style="background-color: #B9D8BF; color: #000000;">jobayerhossain</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right gt_striped" style="background-color: #F7C530; color: #000000;">4</td>
<td headers="TeamId" class="gt_row gt_right gt_striped" style="background-color: #F7C530; color: #000000;">13005648</td>
<td headers="TeamName" class="gt_row gt_left gt_striped" style="background-color: #F7C530; color: #000000;">Underfit Squad</td>
<td headers="LastSubmissionDate" class="gt_row gt_right gt_striped" style="background-color: #F7C530; color: #000000;">2024-12-19 14:49:07</td>
<td headers="Score" class="gt_row gt_right gt_striped" style="background-color: #F7C530; color: #000000;">0.477</td>
<td headers="SubmissionCount" class="gt_row gt_right gt_striped" style="background-color: #F7C530; color: #000000;">43</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left gt_striped" style="background-color: #F7C530; color: #000000;">dungquang8229,minhduonq</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right" style="background-color: #B9CB51; color: #000000;">5</td>
<td headers="TeamId" class="gt_row gt_right" style="background-color: #B9CB51; color: #000000;">12659689</td>
<td headers="TeamName" class="gt_row gt_left" style="background-color: #B9CB51; color: #000000;">peyman armaghan</td>
<td headers="LastSubmissionDate" class="gt_row gt_right" style="background-color: #B9CB51; color: #000000;">2024-12-19 23:22:02</td>
<td headers="Score" class="gt_row gt_right" style="background-color: #B9CB51; color: #000000;">0.477</td>
<td headers="SubmissionCount" class="gt_row gt_right" style="background-color: #B9CB51; color: #000000;">40</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left" style="background-color: #B9CB51; color: #000000;">peymanarmaghan</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right gt_striped" style="background-color: #ACD38C; color: #000000;">6</td>
<td headers="TeamId" class="gt_row gt_right gt_striped" style="background-color: #ACD38C; color: #000000;">12732446</td>
<td headers="TeamName" class="gt_row gt_left gt_striped" style="background-color: #ACD38C; color: #000000;">m_furu</td>
<td headers="LastSubmissionDate" class="gt_row gt_right gt_striped" style="background-color: #ACD38C; color: #000000;">2024-10-27 12:28:49</td>
<td headers="Score" class="gt_row gt_right gt_striped" style="background-color: #ACD38C; color: #000000;">0.476</td>
<td headers="SubmissionCount" class="gt_row gt_right gt_striped" style="background-color: #ACD38C; color: #000000;">21</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left gt_striped" style="background-color: #ACD38C; color: #000000;">miyafuru</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right" style="background-color: #D0DFE6; color: #000000;">7</td>
<td headers="TeamId" class="gt_row gt_right" style="background-color: #D0DFE6; color: #000000;">12633225</td>
<td headers="TeamName" class="gt_row gt_left" style="background-color: #D0DFE6; color: #000000;">sqrt4kaido</td>
<td headers="LastSubmissionDate" class="gt_row gt_right" style="background-color: #D0DFE6; color: #000000;">2024-12-19 13:41:18</td>
<td headers="Score" class="gt_row gt_right" style="background-color: #D0DFE6; color: #000000;">0.475</td>
<td headers="SubmissionCount" class="gt_row gt_right" style="background-color: #D0DFE6; color: #000000;">32</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left" style="background-color: #D0DFE6; color: #000000;">nomorevotch</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right gt_striped" style="background-color: #F3B36A; color: #000000;">8</td>
<td headers="TeamId" class="gt_row gt_right gt_striped" style="background-color: #F3B36A; color: #000000;">12730664</td>
<td headers="TeamName" class="gt_row gt_left gt_striped" style="background-color: #F3B36A; color: #000000;">Kzk Knmt</td>
<td headers="LastSubmissionDate" class="gt_row gt_right gt_striped" style="background-color: #F3B36A; color: #000000;">2024-12-18 15:05:28</td>
<td headers="Score" class="gt_row gt_right gt_striped" style="background-color: #F3B36A; color: #000000;">0.474</td>
<td headers="SubmissionCount" class="gt_row gt_right gt_striped" style="background-color: #F3B36A; color: #000000;">26</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left gt_striped" style="background-color: #F3B36A; color: #000000;">kzkknmt</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right" style="background-color: #D49757; color: #000000;">9</td>
<td headers="TeamId" class="gt_row gt_right" style="background-color: #D49757; color: #000000;">12637841</td>
<td headers="TeamName" class="gt_row gt_left" style="background-color: #D49757; color: #000000;">Sedat Golgiyaz-BingolUniversty</td>
<td headers="LastSubmissionDate" class="gt_row gt_right" style="background-color: #D49757; color: #000000;">2024-12-19 22:44:26</td>
<td headers="Score" class="gt_row gt_right" style="background-color: #D49757; color: #000000;">0.473</td>
<td headers="SubmissionCount" class="gt_row gt_right" style="background-color: #D49757; color: #000000;">384</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left" style="background-color: #D49757; color: #000000;">sedatgolgyaz</td></tr>
    <tr><td headers="Rank" class="gt_row gt_right gt_striped" style="background-color: #748AA6; color: #FFFFFF;">10</td>
<td headers="TeamId" class="gt_row gt_right gt_striped" style="background-color: #748AA6; color: #FFFFFF;">12653466</td>
<td headers="TeamName" class="gt_row gt_left gt_striped" style="background-color: #748AA6; color: #FFFFFF;">Jpmr</td>
<td headers="LastSubmissionDate" class="gt_row gt_right gt_striped" style="background-color: #748AA6; color: #FFFFFF;">2024-12-19 06:59:01</td>
<td headers="Score" class="gt_row gt_right gt_striped" style="background-color: #748AA6; color: #FFFFFF;">0.473</td>
<td headers="SubmissionCount" class="gt_row gt_right gt_striped" style="background-color: #748AA6; color: #FFFFFF;">33</td>
<td headers="TeamMemberUserNames" class="gt_row gt_left gt_striped" style="background-color: #748AA6; color: #FFFFFF;">junpeimorioka</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7"><span data-qmd-base64="PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ=="><span class="gt_from_md"><strong>source</strong>: Kaggle</span></span></td>
    </tr>
  </tfoot>
  <tfoot>
    <tr class="gt_footnotes">
      <td class="gt_footnote" colspan="7">
        <div style="padding-bottom:2px;"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Overall ranking, <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Unique team ID., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Chosen name of the team., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Their final submission date., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> The accuracy score of model., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span> Total competition submissions., <span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span> Names of the team members.</div>
      </td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>



</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>