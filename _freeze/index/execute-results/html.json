{
  "hash": "a93109b12009021c52f2ac599545c533",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Problematic Internet Habits in Children\nauthors:\n  - name: Eric Mossotti\n    affiliation: None\n    roles: data analysis\n    corresponding: true\n\ndate: today\ndate-format: long\n    \nabstract-title: \"Objective\"\nabstract: \"Explore a Kaggle dataset with an in-memory, analytical SQL database. Utilize a 'best-of-both-worlds' hybrid Python and R environment.\"\n\nbibliography: bibliography/references.bib\ncitation-location: margin\ncitations-hover: true\nlink-citations: true\ncsl: bibliography/csl/apa.csl\n\ncode-fold: true\ncode-overflow: wrap\n\nlightbox: auto\nfig-responsive: true\n\ntable-of-contents: true\ntoc-location: left\nnumber-sections: true\n\nlink-external-newwindow: true\n---\n\n\n\n## Dataset Context\n\n::: p-1\nThe grounds for analyses in this case is the problematic behavior as it pertains to the subjects' experience and their parents' via questionnaires, physical fitness tests, worn instrument measurements and demographics. The resulting data is to be processed and connections drawn. [@santorelli_child_2024]\n:::\n\n### Output Notes\n\n#### Palettes\n\nA notable and comprehensive R library was used to give the tables and plots some styling. [@hvitfeldt_paletteer_2021]\n\n#### Tables\n\n::: p-1\nThis is a means to apply formatting to every column in a table using a desired paletteer palette if desired using the gt tables. Table output were customized to a high degree. Some functional programming, in particular, are implemented here as they seem to be most appropriate to achieve the desired effect. [@iannone_gt_2025]\n\nThe following R script defines two functions, *eval_palette* and *r_table_theming*, which work together to create and style a table using the *gt* package. The table is customized with colors, headers, footnotes, and other visual elements.\n\n**Features:**\n\n-   *Dynamic Palette Evaluation*: The eval_palette function is flexible and supports multiple palette types, making it reusable for different visualization needs.\n\n-   *Iterative Styling*: The use of reduce to iteratively apply styles and footnotes is a clean and efficient approach, especially for tables with many columns or complex styling requirements.\n\n-   *Customizability*: The function allows for extensive customization, including font sizes, multiline footnotes, and targeted column coloring.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Table formatting code.\"}\nlibrary(gt)\nlibrary(purrr)\nlibrary(tibble)\nlibrary(reticulate)\nlibrary(paletteer)\n\neval_palette <- function(pal_name, n = 10, pal_type, direction = NULL) {\n  if (pal_type == \"c\") {\n    return(paletteer_c(pal_name, n, direction))\n    } else if (pal_type == \"d\") {\n      return(paletteer_d(pal_name, n, direction))\n    } else if (pal_type == \"dynamic\") {\n      return(paletteer_dynamic(pal_name, n, direction))\n    }\n  }\n\nr_table_theming <- function(r_df,\n                            title,\n                            subtitle,\n                            footnotes_df,\n                            source_note,\n                            pal_df,\n                            multiline_feet = NULL,\n                            tbl_font_size = NULL,\n                            color_by_columns = NULL,\n                            do_col_labels = FALSE,\n                            target_everything = FALSE\n                            ) {\n  \n  r_table <- gt(r_df)\n\n  if(nrow(r_df) > 1 && target_everything == FALSE) {\n    r_table <- seq_len(nrow(pal_df)) |>\n    reduce(\\(acc, i) {\n      data_color(\n        acc,\n        palette = pal_df$pals[[i]],\n        columns = pal_df$cols[[i]]\n        )\n    },.init = r_table)\n  } \n  else if(nrow(r_df) > 1 && target_everything == TRUE) {\n    r_table <- seq_len(nrow(pal_df)) |>\n    reduce(\\(acc, i) {\n      data_color(\n        acc,\n        columns = color_by_columns,\n        palette = pal_df$pals[[i]],\n        target_columns = everything()\n        )\n    },.init = r_table)\n  }\n  \n  r_table <- r_table |>\n    tab_header(title = title, subtitle = subtitle)\n  \n  r_table <- r_table |>\n    tab_options(\n      column_labels.padding = px(10),\n      column_labels.font.weight = \"bold\",\n      column_labels.background.color = '#333',\n      column_labels.border.top.width = px(0),\n      column_labels.border.bottom.color = 'black',\n      column_labels.vlines.width = px(1),\n      column_labels.border.lr.width = px(1),\n      column_labels.border.bottom.width = px(0),\n      column_labels.border.lr.color = 'black',\n      column_labels.vlines.color = 'black',\n      footnotes.padding = px(5),\n      footnotes.background.color = '#222',\n      footnotes.sep = \", \",\n      footnotes.multiline = multiline_feet,\n      heading.padding = px(20),\n      heading.background.color = '#222',\n      heading.title.font.size = pct(125),\n      heading.subtitle.font.size = pct(110),\n      heading.border.bottom.width = px(0),\n      row.striping.include_table_body\t= TRUE,\n      row.striping.background_color = '#333',\n      source_notes.background.color = '#222',\n      table.margin.left = px(1),\n      table.margin.right = px(1),\n      table.align = \"center\",\n      table.border.top.width = px(0),\n      table.border.bottom.width = px(0),\n      table.background.color = '#222',\n      table.font.size = tbl_font_size,\n      table.layout = \"auto\",\n      table_body.hlines.color = 'black',\n      table_body.hlines.width = px(0),\n      table_body.vlines.width = px(0),\n      table_body.border.bottom.color = 'black',\n      table_body.border.top.color = 'black',\n      table_body.border.bottom.width = px(0),\n      table_body.border.top.width = px(0)\n      )\n  \n  r_table <- r_table |>\n    tab_source_note(source_note = source_note)\n  \n  # Footnotes are added to the accumulator, building up to the final result\n  r_table <- seq_len(nrow(footnotes_df)) |>\n    reduce(\\(acc, i) {\n      tab_footnote(\n        acc,\n        footnote = footnotes_df$notes[[i]],\n        location = cells_column_labels(columns = footnotes_df$locations[[i]]),\n        placement = \"auto\"\n        )\n      }, .init = r_table)\n  \n  if(ncol(r_df) > 1 && do_col_labels == TRUE) {\n      cell_col_fills = pal_df$pals[[1]]\n      \n      r_table <- seq_len(nrow(pal_df)) |>\n        reduce(\\(acc, i) {\n          tab_style(\n            acc,\n            style = cell_fill(\n              color = cell_col_fills[i]\n              ), locations = cells_column_labels(columns = pal_df$cols[[i]]))\n        }, .init = r_table)\n  }\n  \n  return(r_table)\n  }\n```\n:::\n\n\n:::\n\n#### Plots\n\n::: p-1\nHere are some relatively simpler functions developed with the intention to append and apply consistent theming to ggplots. R libraries are currently preferred for plotting outputs as they can be extensively customized. [@wickham_ggplot2_2016]\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Plot theming code.\"}\nlibrary(reticulate)\nlibrary(ggplot2)\n\n# normal axes\nggplot_theming <- function() {\n  theme_minimal() +\n    theme(\n      plot.title = element_text(color = 'white',\n                                size = rel(1.5)),\n      plot.background = element_rect(fill = '#222'),\n      panel.background = element_rect(fill = '#222'),\n      panel.grid.major.x = element_line(linetype = 'solid',\n                                        color = 'black'),\n      panel.grid.minor.x = element_line(linetype = \"dotted\",\n                                        color = 'gray'),\n      panel.grid.major.y = element_line(linetype = 'dashed',\n                                        color = 'black'),\n      panel.grid.minor.y = element_line(linetype = 'dotted',\n                                        color = 'gray'),\n      axis.title = element_text(color = 'gray100'),\n      axis.text = element_text(color = 'gray'),\n      legend.background = element_rect(fill = '#222'),\n      legend.text = element_text(color = 'gray'),\n      legend.title = element_text(color = 'white'))\n  }\n\n# flipped axes\nggplot_theming_flipped_axes <- function() {\n  theme_minimal() +\n    theme(\n      plot.title = element_text(color = 'white',\n                                size = rel(2)),\n      plot.background = element_rect(fill = '#222'),\n      panel.background = element_rect(fill = '#222'),\n      panel.grid.major.x = element_line(linetype = 'dashed'),\n      panel.grid.minor.x = element_line(linetype = \"dotted\"),\n      panel.grid.major.y = element_line(linetype = 'solid'),\n      panel.grid.minor.y = element_line(linetype = 'dotted'),\n      axis.title = element_text(color = 'gray100'),\n      axis.text = element_text(color = 'gray'),\n      legend.background = element_rect(fill = '#222'),\n      legend.text = element_text(color = 'gray'),\n      legend.title = element_text(color = 'white'))\n}\n```\n:::\n\n\n:::\n\n## Import/Extract\n\nThe data was imported from Kaggle. It only needed to be done once, so the code chunk's eval setting is set to false during most of this project's development.\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Executed once to import the data from the Kaggle server. \"}\n!kaggle competitions download -c child-mind-institute-problematic-internet-use\n```\n:::\n\n\n:::\n\nAlthough not necessary, creating the data directory can be made programmatic.\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Checked if the directory, 'data', exists.\"}\nimport os\n\ntry:\n  os.mkdir('./data')\nexcept FileExistsError:\n  print(f\"data exists\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndata exists\n```\n\n\n:::\n:::\n\n\n:::\n\n::: p-1\nExtracting the downloaded files was also done programmatically, but it is not necessary. It did seem useful to visualize the data directory following extraction to verify the files and folders that now exist in the ./data directory of this project.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Extracted the compressed files and list files.\"}\nfrom zipfile import ZipFile\nimport pandas as pd\n\nzip_path = \"child-mind-institute-problematic-internet-use.zip\"\n\nif not os.path.exists('./data/train.csv'):\n  with ZipFile(zip_path) as zf:\n    ZipFile.extractall(zf, path = './data')\n    print(\"Extracted files\", sep = \"\\n\"*2)\nelse:\n  print(\"Files already exist\", sep = \"\\n\"*2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFiles already exist\n```\n\n\n:::\n\n```{.python .cell-code  code-summary=\"Extracted the compressed files and list files.\"}\n\nextracts = pd.DataFrame(\n  data = os.listdir(path = './data'), columns = ['./data'])\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$extracts\n\nnotes_list =  list(\"directory contents\")\nlocations_list = list(\"./data\")\n\n# Create a table dataframe, or tibble, of footnotes\nfootnotes_df <- tibble(notes = notes_list, locations = locations_list)\n\npal_df <- tibble(\n  cols = list(\n  \"./data\"),\n  pals = list(\n    eval_palette(\"ggsci::legacy_tron\", 7, 'd', 1)\n    )\n  )\n\nrTable <- r_table_theming(r_df,\n                          title = \"Directory Files\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: '/data/'\"),\n                          pal_df,\n                          tbl_font_size = pct(80))\n```\n:::\n\n\n:::\n\n::: table-flex\n\n\n::: {#tbl-dataDirectory .cell tbl-cap='Files and folders'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wwlmcmgviu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wwlmcmgviu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wwlmcmgviu thead, #wwlmcmgviu tbody, #wwlmcmgviu tfoot, #wwlmcmgviu tr, #wwlmcmgviu td, #wwlmcmgviu th {\n  border-style: none;\n}\n\n#wwlmcmgviu p {\n  margin: 0;\n  padding: 0;\n}\n\n#wwlmcmgviu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 80%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wwlmcmgviu .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#wwlmcmgviu .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#wwlmcmgviu .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#wwlmcmgviu .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wwlmcmgviu .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wwlmcmgviu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wwlmcmgviu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wwlmcmgviu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wwlmcmgviu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wwlmcmgviu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wwlmcmgviu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wwlmcmgviu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wwlmcmgviu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wwlmcmgviu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wwlmcmgviu .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wwlmcmgviu .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wwlmcmgviu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wwlmcmgviu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wwlmcmgviu .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wwlmcmgviu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wwlmcmgviu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wwlmcmgviu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_striped {\n  background-color: #333333;\n}\n\n#wwlmcmgviu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#wwlmcmgviu .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wwlmcmgviu .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wwlmcmgviu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wwlmcmgviu .gt_left {\n  text-align: left;\n}\n\n#wwlmcmgviu .gt_center {\n  text-align: center;\n}\n\n#wwlmcmgviu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wwlmcmgviu .gt_font_normal {\n  font-weight: normal;\n}\n\n#wwlmcmgviu .gt_font_bold {\n  font-weight: bold;\n}\n\n#wwlmcmgviu .gt_font_italic {\n  font-style: italic;\n}\n\n#wwlmcmgviu .gt_super {\n  font-size: 65%;\n}\n\n#wwlmcmgviu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wwlmcmgviu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wwlmcmgviu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wwlmcmgviu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wwlmcmgviu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wwlmcmgviu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wwlmcmgviu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wwlmcmgviu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wwlmcmgviu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"1\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Directory Files</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a./data\">./data<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"./data\" class=\"gt_row gt_left\" style=\"background-color: #A3CFDC; color: #000000;\">privateLeaderboard.csv</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #E89A3C; color: #000000;\">test.csv</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left\" style=\"background-color: #FF410D; color: #FFFFFF;\">data_dictionary.csv</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #C3CA4D; color: #000000;\">sample_submission.csv</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left\" style=\"background-color: #B1D499; color: #000000;\">series_test.parquet</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #E5CCB1; color: #000000;\">series_train.parquet</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left\" style=\"background-color: #748AA6; color: #FFFFFF;\">train.csv</td></tr>\n    <tr><td headers=\"./data\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #E3CD75; color: #000000;\">profiles</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"1\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IOKAmC9kYXRhL+KAmQ==\"><span class='gt_from_md'><strong>source</strong>: ‘/data/’</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"1\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> directory contents</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n## Establish Connection\n\n::: p-1\nAn in-memory, DuckDB database connection was established for this project. The analysis in this project heavily relies on SQL syntax, and most of the computations are performed in database for efficiency.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Set up an in-memory database.\"}\nimport duckdb\n\nconn = duckdb.connect(':memory:')\n```\n:::\n\n\n:::\n\n### Customize Database Settings\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Set the database memory limit.\"}\ntry:\n  conn.sql(f\"SET memory_limit = '24GB';\")\n  print(f\"Successfully changed memory limit to 24GB\")\nexcept:\n  print(f\"An error occurred in changing the memory limit.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSuccessfully changed memory limit to 24GB\n```\n\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Set the default ordering for the database.\"}\ntry:\n  conn.sql(f\"SET default_order = 'ASC';\")\n  print(f\"Successfully changed the default order to ascending.\")\nexcept:\n  print(f\"The default order could not be changed.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSuccessfully changed the default order to ascending.\n```\n\n\n:::\n:::\n\n\n:::\n\n## Setup Database\n\n### Create New Data Types\n\n::: p-1\nEnum data types significantly sped up many database operations. Enums are similar to the category data type in Python, and the factor datatype in R. [@holanda_duckdb_2021]\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Data structures setup for new data types.\"}\nimport pandas as pd\n\nenums = ['internet_hours_enum'\n         ,'enroll_season_enum'\n         ,'disease_risk_enum'\n         ,'sii_enum', 'age_enum'\n         ,'sex_enum'\n         ,'pciat_season_enum'\n         ,'weekday_enum'\n         ,'quarter_enum'\n         ,'hour_enum'\n         ,'minute_enum'\n         ,'second_enum'\n         ,'id_actigraphy_enum']\n\n#siiSeries = pd.Series(data = ['None', 'Mild', 'Moderate', 'Severe'], dtype = str)\nsiiSeries = pd.Series(data = ['0', '1', '2', '3'], dtype = str)\nageSeries = pd.Series(data = range(5, 23), dtype = str)\nsexSeries = pd.Series(data = ['0', '1'], dtype = str)\npciatSeasonSeries = pd.Series(data = ['Fall'\n                                      ,'Spring'\n                                      ,'Summer'\n                                      ,'Winter'], dtype = str)\n\ninternetHrsSeries = pd.Series(data = ['0', '1', '2', '3'], dtype = str)\nquarterSeries = pd.Series(data = range(1, 5), dtype = str)\nweekdaySeries = pd.Series(data = range(1, 8), dtype = str)\nhourSeries = pd.Series(data = range(0, 24), dtype = str)\nminuteSeries = pd.Series(data = range(0, 60), dtype = str)\nsecondSeries = pd.Series(data = range(0, 60), dtype = str)\ndiseaseRiskSeries = pd.Series(data = ['Underweight'\n                                      ,'Normal'\n                                      ,'Increased'\n                                      ,'High'\n                                      ,'Very High'\n                                      ,'Extremely High'], dtype = str)\n\nid_df = conn.execute(f\"\"\"\n     SELECT \n         DISTINCT(id) AS id\n     FROM \n         read_parquet('data/series_train*/*/*'\n         ,hive_partitioning = true)\n     ORDER BY \n         id ASC;\n     \"\"\").df() \n\nidList = id_df['id'].to_list()\nidSeries = pd.Series(data = idList, dtype = str)\n\nenumDict = {\n  'disease_risk_enum': f\"{tuple(diseaseRiskSeries)}\"\n  ,'enroll_season_enum': f\"{tuple(pciatSeasonSeries)}\"\n  ,'sii_enum': f\"{tuple(siiSeries)}\"\n  ,'age_enum': f\"{tuple(ageSeries)}\"\n  ,'sex_enum': f\"{tuple(sexSeries)}\"\n  ,'pciat_season_enum': f\"{tuple(pciatSeasonSeries)}\"\n  ,'quarter_enum': f\"{tuple(quarterSeries)}\"\n  ,'weekday_enum': f\"{tuple(weekdaySeries)}\"\n  ,'hour_enum': f\"{tuple(hourSeries)}\"\n  ,'minute_enum': f\"{tuple(minuteSeries)}\"\n  ,'second_enum': f\"{tuple(secondSeries)}\"\n  ,'id_actigraphy_enum': f\"{tuple(idSeries)}\"\n  ,'internet_hours_enum': f\"{tuple(internetHrsSeries)}\"\n  }\n\nif len(enumDict) == len(enums):\n  print(f\"drops and creates are same length\")\nelse:\n  print(f\"drops and creates are not the same length\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndrops and creates are same length\n```\n\n\n:::\n:::\n\n\n:::\n\n::: p-1\nThis is designed to manage ENUM types in a DuckDB database in a modular and user-friendly way. It provides functions to create and drop ENUM types, and it uses Python data structures like pandas Series and dictionaries to handle inputs and outputs.\n\nIt is part of the data preprocessing and database setup pipeline in this project. It ensures that the database schema (specifically ENUM types) is properly configured before performing further operations, such as aggregating light exposure data.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"An approach for defining and verifying custom data types in the database.\"}\ndef try_create(conn,type_str: str, enum_str: str) -> pd.Series:\n  \"\"\"\n  :::WHY(s):::\n    Is there a modular approach to creating ENUM types in a database?\n  :::HOW(s):::\n    Utilize python data structures such as pandas Series and dictionary as parameters.\n  \"\"\"\n  # the try, except can help categorize the outputs for ui/ux\n  try:\n    conn.execute(f\"CREATE TYPE {type_str} AS ENUM {enum_str};\")\n    return pd.Series(type_str, index = ['created'])\n  except duckdb.duckdb.CatalogException:\n    return pd.Series(type_str, index = ['already existed'])\n\ndef try_drop(conn, type_str: str) -> pd.Series:\n  \"\"\"\n  :::WHY(s):::\n    Is there a modular approach to dropping ENUM types in a database?\n  :::HOW(s):::\n    Utilize python data structures such as pandas Series and dictionary as parameters.\n  \"\"\"\n  try:\n    conn.execute(f\"DROP TYPE {type_str};\")\n    return pd.Series(type_str, index = ['dropped'])\n  except duckdb.duckdb.CatalogException:\n    return pd.Series(type_str, index = ['did not exist'])\n  \ndroplist = []\nfor e in enums:   \n   droplist.append(try_drop(conn, type_str = e))\n   \ndropFrame = pd.DataFrame(droplist)\ndropFrame = dropFrame.sort_values(by = dropFrame.columns.to_list(),\n                                  ascending = True,\n                                  ignore_index = True)\ncreateList = []\nfor eType, eSeries in enumDict.items():\n    createList.append(try_create(conn,\n                                 type_str = eType,\n                                 enum_str = eSeries))\ncreateFrame = pd.DataFrame(createList)\ncreateFrame = createFrame.sort_values(by = createFrame.columns.to_list(),\n                                      ascending = True,\n                                      ignore_index = True)\n\npydf = pd.concat([dropFrame, createFrame], axis = 1)\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$pydf\n\nif (colnames(r_df[1]) == \"did not exist\"){\n  locations_list = list(\"did not exist\", \"created\") \n  notes_list =  list(\"Enums that did not exist.\",\n                     \"Enums that now exist.\")\n  } else {\n  locations_list = list(\"dropped\", \"created\")\n  notes_list =  list(\"Enums that were dropped.\",\n                     \"Enums that now exist.\")\n  }\n\n# Create a table dataframe, or tibble, of footnotes\nfootnotes_df <- tibble(notes = notes_list, locations = locations_list)\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(\n    eval_palette(\"ggsci::legacy_tron\", 7, 'd', 1))\n  )\n\n#tbl_font_size = pct(80))\nrTable <- r_table_theming(r_df,\n                          title = \"Custom Data Types\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = TRUE,\n                          tbl_font_size = pct(80)\n                          )\n```\n:::\n\n\n:::\n\n::: table-flex\n\n\n::: {#tbl-enumOutput .cell tbl-cap='Enums dropped and created.'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qksswmfrji\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qksswmfrji table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qksswmfrji thead, #qksswmfrji tbody, #qksswmfrji tfoot, #qksswmfrji tr, #qksswmfrji td, #qksswmfrji th {\n  border-style: none;\n}\n\n#qksswmfrji p {\n  margin: 0;\n  padding: 0;\n}\n\n#qksswmfrji .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 80%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qksswmfrji .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#qksswmfrji .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#qksswmfrji .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#qksswmfrji .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qksswmfrji .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qksswmfrji .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qksswmfrji .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qksswmfrji .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qksswmfrji .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qksswmfrji .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qksswmfrji .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qksswmfrji .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qksswmfrji .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qksswmfrji .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qksswmfrji .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qksswmfrji .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qksswmfrji .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qksswmfrji .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qksswmfrji .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qksswmfrji .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qksswmfrji .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qksswmfrji .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_striped {\n  background-color: #333333;\n}\n\n#qksswmfrji .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#qksswmfrji .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qksswmfrji .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qksswmfrji .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qksswmfrji .gt_left {\n  text-align: left;\n}\n\n#qksswmfrji .gt_center {\n  text-align: center;\n}\n\n#qksswmfrji .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qksswmfrji .gt_font_normal {\n  font-weight: normal;\n}\n\n#qksswmfrji .gt_font_bold {\n  font-weight: bold;\n}\n\n#qksswmfrji .gt_font_italic {\n  font-style: italic;\n}\n\n#qksswmfrji .gt_super {\n  font-size: 65%;\n}\n\n#qksswmfrji .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qksswmfrji .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qksswmfrji .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qksswmfrji .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qksswmfrji .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qksswmfrji .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qksswmfrji .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qksswmfrji .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qksswmfrji div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Custom Data Types</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"did-not-exist\">did not exist<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"created\">created<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #FF410D; color: #FFFFFF;\">age_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #FF410D; color: #FFFFFF;\">age_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #E09D88; color: #000000;\">disease_risk_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #E09D88; color: #000000;\">disease_risk_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #6EE2FF; color: #000000;\">enroll_season_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #6EE2FF; color: #000000;\">enroll_season_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #CED39F; color: #000000;\">hour_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #CED39F; color: #000000;\">hour_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #F7C530; color: #000000;\">id_actigraphy_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #F7C530; color: #000000;\">id_actigraphy_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #CACA49; color: #000000;\">internet_hours_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #CACA49; color: #000000;\">internet_hours_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #95CC5E; color: #000000;\">minute_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #95CC5E; color: #000000;\">minute_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #B6D6A3; color: #000000;\">pciat_season_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #B6D6A3; color: #000000;\">pciat_season_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #D0DFE6; color: #000000;\">quarter_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #D0DFE6; color: #000000;\">quarter_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #EEBE89; color: #000000;\">second_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #EEBE89; color: #000000;\">second_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #F79D1E; color: #000000;\">sex_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #F79D1E; color: #000000;\">sex_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #C1936C; color: #FFFFFF;\">sii_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #C1936C; color: #FFFFFF;\">sii_enum</td></tr>\n    <tr><td headers=\"did not exist\" class=\"gt_row gt_left\" style=\"background-color: #748AA6; color: #FFFFFF;\">weekday_enum</td>\n<td headers=\"created\" class=\"gt_row gt_left\" style=\"background-color: #748AA6; color: #FFFFFF;\">weekday_enum</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"2\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> Enums that did not exist.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Enums that now exist.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n### Initial Extraction Transformation and Load Pipeline\n\n::: p-1\nTransformations are applied while reading in data from files to minimize steps needed. Not sure why the data had hyphens in the columns names, originally. These hyphens interfere with SQL database queries, so it might be useful to replace them with underscore characters. There is no need to overwrite the original CSV's to maintain a clear trail of data transformations.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Initial data pipeline extraction, transformation and loading to the database.\"}\ndef setup_duckdb_pipeline(\n  csvDict: dict, \n  parquetDict: dict, \n  conn: duckdb.DuckDBPyConnection) -> None:\n    \n  try:\n    {\n      table_name: duckdb.sql(f\"\"\"\n      CREATE OR REPLACE TABLE {table_name} AS \n      SELECT \n        *\n      FROM \n        df;\n      \"\"\", connection = conn) \n      for table_name, df in csvDict.items()\n      }\n    for key, value in csvDict.items():\n      result = conn.execute(f\"SELECT COUNT(*) FROM {key}\").fetchone()\n      print(f\"Successfully created table: {key}, Row count: {result[0]}\")\n  except Exception as e:\n    print(f\"Error loading table: {str(e)}\")\n    raise\n  \n  if parquetDict:\n    write_datasets(conn, parquetDict)\n  \n# Create tables from Parquet files\ndef write_datasets (\n  conn: duckdb.DuckDBPyConnection, parquetDict: dict):\n      try:\n        {\n          table_name: duckdb.sql(f\"\"\"\n           CREATE OR REPLACE TABLE {table_name} AS\n           SELECT \n             id::id_actigraphy_enum AS id\n             ,quarter::TEXT::quarter_enum AS quarter\n             ,weekday::TEXT::weekday_enum AS weekday\n             ,light\n             ,(time_of_day / 3_600_000_000_000) AS hour_of_day\n             ,relative_date_PCIAT\n           FROM read_parquet(\n             '{file_path}'\n             ,hive_partitioning = true\n             );\"\"\", connection=conn)\n           for table_name, file_path in parquetDict.items()\n           }\n        for key, value in parquetDict.items():\n          result = conn.execute(f\"SELECT COUNT(*) FROM {key}\").fetchone()\n          print(\n            f\"Successfully created table: {key}, Row count, {result[0]}\")\n      except Exception as e:\n        print(f\"Error writing dataset: {str(e)}\")\n        raise\n\ntrainCsvDf = pd.read_csv(\"data/train.csv\")\ntestCsvDf = pd.read_csv(\"data/test.csv\")\n\ndictDf = pd.read_csv(\"data/data_dictionary.csv\")\n\ntrainCsvDf.columns = trainCsvDf.columns.str.replace('-','_') \ntrainCsvDf.columns = trainCsvDf.columns.str.lower() \ntestCsvDf.columns = testCsvDf.columns.str.replace('-','_') \ntestCsvDf.columns = testCsvDf.columns.str.lower() \n\ndictDf.Field = dictDf.Field.replace(\"-\", \"_\", regex = True)\n\ncsvDict = {\n  \"TrainCsv\": trainCsvDf\n  ,\"TestCsv\": testCsvDf\n  ,\"DataDict\": dictDf\n  }\n\nparquetDict = {\n  \"ActigraphyTrain\": 'data/series_train.parquet*/*/*'\n  ,\"ActigraphyTest\": 'data/series_test*/*/*'\n  }\n\ntry:\n  setup_duckdb_pipeline(csvDict, parquetDict, conn)\nexcept:\n  print(f\"Could not set up data pipeline.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSuccessfully created table: TrainCsv, Row count: 3960\nSuccessfully created table: TestCsv, Row count: 20\nSuccessfully created table: DataDict, Row count: 81\nSuccessfully created table: ActigraphyTrain, Row count, 314569149\nSuccessfully created table: ActigraphyTest, Row count, 439726\n```\n\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Verify ActigraphyTrain in the database.\"}\npydf = conn.sql(f\"\"\"\nSELECT *\nFROM ActigraphyTrain\nORDER BY \n  id ASC\n  ,relative_date_PCIAT ASC\n  ,hour_of_day ASC\nLIMIT 10;\"\"\").df()\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$pydf\n\nr_df <- r_df |>\n  dplyr::select(id, quarter, weekday, relative_date_PCIAT, light, hour_of_day)\n\nnotes_list =  list(\n  \"Unique participant identifier code, to track related data from actigraphy to hbn datasets.\",\n  \"Annual quarter related to month of observation.\",\n  \"Day of the week (Monday = 1)\",\n  \"Light exposure, measured in 'lux'\",\n  \"24-hour time converted to a float for easier conversion for time-series analysis.\",\n  \"Days since questionairre, also convenient to help order daily values for time-series analysis.\"\n  )\n\nlocations_list = list(\"id\",\n                      \"quarter\",\n                      \"weekday\",\n                      \"light\",\n                      \"hour_of_day\",\n                      \"relative_date_PCIAT\")\n\nfootnotes_df <- tibble(\n  notes = notes_list, \n  locations = locations_list)\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(eval_palette(\"harrypotter::ravenclaw\", 7, 'c', 1)))\n\nrTable <- r_table_theming(r_df,\n                          title = \"Actigraphy Data - Training Set\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = TRUE\n                          #tbl_font_size = pct(85)\n                          )\n```\n:::\n\n\n:::\n\n::: table-flex\n\n\n::: {#tbl-ActigraphyTrain .cell tbl-cap='A preview of ActigraphyTrain database table.'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"acbizmcmzq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#acbizmcmzq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#acbizmcmzq thead, #acbizmcmzq tbody, #acbizmcmzq tfoot, #acbizmcmzq tr, #acbizmcmzq td, #acbizmcmzq th {\n  border-style: none;\n}\n\n#acbizmcmzq p {\n  margin: 0;\n  padding: 0;\n}\n\n#acbizmcmzq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#acbizmcmzq .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#acbizmcmzq .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#acbizmcmzq .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#acbizmcmzq .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#acbizmcmzq .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#acbizmcmzq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#acbizmcmzq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#acbizmcmzq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#acbizmcmzq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#acbizmcmzq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#acbizmcmzq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#acbizmcmzq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#acbizmcmzq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#acbizmcmzq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#acbizmcmzq .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#acbizmcmzq .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#acbizmcmzq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#acbizmcmzq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#acbizmcmzq .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#acbizmcmzq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#acbizmcmzq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#acbizmcmzq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_striped {\n  background-color: #333333;\n}\n\n#acbizmcmzq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#acbizmcmzq .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#acbizmcmzq .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#acbizmcmzq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#acbizmcmzq .gt_left {\n  text-align: left;\n}\n\n#acbizmcmzq .gt_center {\n  text-align: center;\n}\n\n#acbizmcmzq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#acbizmcmzq .gt_font_normal {\n  font-weight: normal;\n}\n\n#acbizmcmzq .gt_font_bold {\n  font-weight: bold;\n}\n\n#acbizmcmzq .gt_font_italic {\n  font-style: italic;\n}\n\n#acbizmcmzq .gt_super {\n  font-size: 65%;\n}\n\n#acbizmcmzq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#acbizmcmzq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#acbizmcmzq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#acbizmcmzq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#acbizmcmzq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#acbizmcmzq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#acbizmcmzq .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#acbizmcmzq .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#acbizmcmzq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Actigraphy Data - Training Set</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"id\">id<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"quarter\">quarter<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weekday\">weekday<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"relative_date_PCIAT\">relative_date_PCIAT<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"light\">light<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hour_of_day\">hour_of_day<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"id\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">53.00000</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">15.81667</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #BD630A; color: #FFFFFF;\">51.66667</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #03689B; color: #FFFFFF;\">15.81806</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right\" style=\"background-color: #C86C14; color: #FFFFFF;\">50.33333</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right\" style=\"background-color: #066B9E; color: #FFFFFF;\">15.81944</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C76B12; color: #FFFFFF;\">50.50000</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #096DA0; color: #FFFFFF;\">15.82083</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right\" style=\"background-color: #3EA2D5; color: #FFFFFF;\">33.16667</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right\" style=\"background-color: #C56911; color: #FFFFFF;\">15.89861</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #3093C6; color: #FFFFFF;\">31.33333</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C1660D; color: #FFFFFF;\">15.90000</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right\" style=\"background-color: #2185B8; color: #FFFFFF;\">29.50000</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right\" style=\"background-color: #BE630A; color: #FFFFFF;\">15.90139</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #167AAD; color: #FFFFFF;\">27.66667</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #BA5F06; color: #FFFFFF;\">15.90278</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right\" style=\"background-color: #0C70A3; color: #FFFFFF;\">25.83333</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right\" style=\"background-color: #B75C03; color: #FFFFFF;\">15.90417</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">3</td>\n<td headers=\"weekday\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">4</td>\n<td headers=\"relative_date_PCIAT\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">41</td>\n<td headers=\"light\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">24.00000</td>\n<td headers=\"hour_of_day\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">15.90556</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"6\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> Unique participant identifier code, to track related data from actigraphy to hbn datasets.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Annual quarter related to month of observation.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span> Day of the week (Monday = 1)</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span> Days since questionairre, also convenient to help order daily values for time-series analysis.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span> Light exposure, measured in 'lux'</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"6\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span> 24-hour time converted to a float for easier conversion for time-series analysis.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n## EDA\n\n::: p-1\nThis is designed to filter and create new database tables based on regular expression (regexp) patterns applied to column names. It is part of the data preprocessing pipeline. The code modularizes the process of selecting columns and creating new tables, making it reusable and efficient.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Creates several tables based on column label strings.\"}\nimport re\n\ndef filter_columns_by_regex(col_dict: dict, regex_pattern: str) -> dict:\n  \"\"\"\n  :::WHY(s):::\n    Can there be a way to use dictionaries to specify columns?\n\n  :::GOAL(s):::\n    Regex selection of column names from a dictionary.\n  \"\"\"\n  return {\n    col: dtype \n    for col, dtype in col_dict.items() \n    if re.search(regex_pattern, col)\n    }\n\ndef create_table_with_regex_columns(\n  conn: duckdb.duckdb\n  ,source_table: str\n  ,new_table_name: str \n  ,regex_pattern: str \n  ,col_dict: dict\n  ) -> None:  \n\n  \"\"\"\n  :::WHY(s):::\n    There should to be a more streamlined way to utilize columnar information following regular string patterns to generate tables based on such information. This could follow and carry out pre-existing data modeling plans.\n\n  :::GOAL(s):::\n    To create new database tables with modularized SQL queries generated with the help of regex pattern matching selection.\n\n  :::EXAMPLE(s):::\n    The dictionary item:\n      \"Demographic\": r\"^id|^sii|^basic\\S+\"\n \n    Would generate a table named 'Demographic' from data with columns for 'id', 'sii' and all columns starting with 'basic' strings. \n  \"\"\"\n\n  # filter columns\n  filtered_col_dict = filter_columns_by_regex(col_dict, regex_pattern)\n  \n  # regex column selecting via dict comprehension and vectorized filtering\n  regex_select_sql = f\"\"\"\n  CREATE OR REPLACE TABLE {new_table_name} AS \n  SELECT\n    {', '.join([f'\"{col}\"' for col in filtered_col_dict.keys()])}\n  FROM {source_table};\n  \"\"\"\n\n  conn.execute(regex_select_sql)\n\n# It'd be useful to get the data types for creating a new table of values\ncoltype_overview = conn.sql(f\"\"\"\n  SELECT column_name\n         ,data_type\n  FROM \n    information_schema.columns\n  WHERE \n    table_name = 'TrainCsv';\"\"\").df()\n\n# Map the column names with data types\ncol_dict = dict(zip(coltype_overview.column_name, coltype_overview.data_type))\n\nregex_dict_train = {\n  \"Demographic\": r\"^id|^sii|^basic\\S+\"\n  ,\"Physical\": r\"^id|^sii|^physical\\S+\"\n  ,\"FgVital\": r\"^id|^sii|^fitness_E\\S+\"\n  ,\"FgChild\": r\"^id|^sii|^fgc\\S+\"\n  ,\"Bia\": r\"^id|^sii|^bia\\S+\"\n  ,\"Paqa\": r\"^id|^sii|^paq_a\\S+\"\n  ,\"Pciat\": r\"^id|^sii|^pciat\\S+\"\n  ,\"Sds\": r\"^id|^sii|^sds\\S+\"\n  ,\"InternetUse\": r\"^id|^sii|^preint\\S+\"\n  }\n\n# There's no Pciat in the test set\nregex_dict_test = {\n  \"DemographicTest\": r\"^id|^basic\\S+\"\n  ,\"PhysicalTest\": r\"^id|^physical\\S+\"\n  ,\"FgVitalTest\": r\"^id|^fitness_E\\S+\"\n  ,\"FgChildTest\": r\"^id|^fgc\\S+\"\n  ,\"BiaTest\": r\"^id|^bia\\S+\"\n  ,\"PaqaTest\": r\"^id|^paq_a\\S+\"\n  ,\"SdsTest\": r\"^id|^sds\\S+\"\n  ,\"InternetUseTest\": r\"^id|^preint\\S+\"\n  }\n\n# Loop through the data structures to create tables for the train set\nfor new_table_name, regex_pattern in regex_dict_train.items():\n  create_table_with_regex_columns(\n    conn \n    ,'TrainCsv'\n    ,new_table_name\n    ,regex_pattern\n    ,col_dict\n    ) \n\n# Loop through the data structures to create tables for the test set\nfor new_table_name, regex_pattern in regex_dict_test.items():\n  create_table_with_regex_columns(\n    conn\n    ,'TestCsv'\n    ,new_table_name\n    ,regex_pattern \n    ,col_dict\n    )\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Perform a join on matching Ids to combine demographics data with actigraphy data such as time and light exposure.\"}\nconn.sql(\"\"\"\nCREATE OR REPLACE TABLE IntermediateActigraphy AS\nSELECT id\n       ,basic_demos_enroll_season::TEXT::enroll_season_enum AS enroll_season\n       ,basic_demos_age::TEXT::age_enum AS age\n       ,basic_demos_sex::TEXT AS sex\n       ,sii::INTEGER::TEXT::sii_enum AS sii\nFROM \n  Demographic\nORDER BY\n  id ASC;\n\"\"\")\n\nconn.sql(\"\"\"\nCREATE OR REPLACE TABLE \n  ActigraphyTrain\nAS\n  SELECT\n    ia.*\n    ,at.hour_of_day\n    ,at.weekday\n    ,at.quarter\n    ,at.light\n  FROM \n    ActigraphyTrain at \n  LEFT JOIN \n    IntermediateActigraphy ia\n  ON \n    ia.id = at.id;\n\"\"\")\n\nconn.sql(\"\"\"\nCREATE OR REPLACE TABLE IntermediateActigraphy AS\nSELECT\n  id\n  ,basic_demos_enroll_season::TEXT::enroll_season_enum AS enroll_season\n  ,basic_demos_age::TEXT::age_enum AS age\n  ,basic_demos_sex::TEXT AS sex\nFROM \n  DemographicTest\nORDER BY\n  id ASC;\n\"\"\")\n\nconn.sql(\"\"\"\nCREATE OR REPLACE TABLE \n  ActigraphyTest\nAS\n  SELECT\n    ia.*\n    ,at.hour_of_day\n    ,at.quarter\n    ,at.weekday\n    ,at.light\n  FROM \n    ActigraphyTest at \n  LEFT JOIN \n    IntermediateActigraphy ia\n  ON \n    ia.id = at.id;\n\"\"\")\n\nconn.sql(\"DROP TABLE IntermediateActigraphy;\")\n\ntry:\n conn.sql(f\"CHECKPOINT;\")\n print(f\"Cleared unused allocated space from memory.\")\nexcept:\n  print(f\"Could not clear from memory.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n┌─────────┐\n│ Success │\n│ boolean │\n├─────────┤\n│ 0 rows  │\n└─────────┘\n\nCleared unused allocated space from memory.\n```\n\n\n:::\n:::\n\n\n:::\n\n### Actigraphy, Physical, and Demographics\n\n::: p-1\nIt might be useful to explore how the time of day and associated exposure to light might correlate to other factors, such as sii, physical characteristics, and internet use.\n:::\n\n#### Informal Hypothesis\n\n::: p-1\n*Hypothesis*: More time spent indoors on the internet might be associated with lower light exposure during daytime (Q1-Q2, Q2-Q3) and higher light exposure during nighttime (min-Q1, Q3-max).\n\nThe BMI risk categories found at, [@zierle_physiology_2024], have been borrowed for this project. The SQL query syntax, therefore, aims to reflect a structure of evidence-based classification. Though not used in this project, it might be useful to classify lux statistics in a way that reflect a classification standard [@actigraphcorp_lux_2024].\n:::\n\n#### Lux by Hour of Day Quartile\n\n::: p-1\nRepetitive SQL commands are quite verbose and repetitive, at times. Python functions, alongside data structures, such as dataframes, and dictionaries could actually help make running SQL commands less repetitive and more modular.\n\nThe code is designed to process and aggregate light exposure data from actigraphy datasets (likely from wearable devices) using DuckDB as an in-memory database. The code is modularized into several functions to handle different tasks, such as calculating quartiles, detecting specific columns, creating intermediate tables, and joining these tables into a final aggregated result.\n\nAdditionally, the code is useful for analyzing light exposure data over different times of the day (based on quartiles of hour_of_day). It aggregates the data into meaningful segments and creates a final table that can be used for further analysis or visualization. Included is a try-except block to handle any potential errors during the table joining process, ensuring that the user is informed if something goes wrong.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Extract actigraphy data based on the time of day quartile.\"}\ndef quartiler(\n  conn: duckdb.duckdb, \n  col_name: str, \n  source_name: str) -> dict:\n  \"\"\"\n  ::WHY(s):: \n    SQL can sometimes require a lot of code for repetitive commands, but in a Python environment, database queries can be modularized.\n  \n  ::GOAL(s)::  \n    To process SQL queries into useful quartile information represented by intuitive key labels.\n  \"\"\"\n  summaryDf = conn.sql(f\"\"\"\n  SUMMARIZE\n  SELECT\n    {col_name}\n  FROM \n    {source_name};\"\"\").df()\n\n  quartileDict = {\n    'min': summaryDf['min'][0]\n    ,'Q1': summaryDf.q25[0]\n    ,'Q2': summaryDf.q50[0]\n    ,'Q3': summaryDf.q75[0]\n    ,'max': summaryDf['max'][0]\n    }\n  \n  return quartileDict\n\ndef siiDetect (detect_frame: pd.DataFrame) -> bool:\n  if 'sii' in detect_frame.column_name.values:\n    return True\n\ndef intermediateLighter(\n  conn: duckdb.duckdb,\n  new_tables: list,\n  quarters: dict, \n  quartuples: pd.Series,\n  from_table: str) -> None:\n  \"\"\"\n  :::WHY(s):::\n    Tables based on the same parameters but different parameter values could be modularized.\n    \n  :::GOAL(s):::\n    Process repetitive SQL efficiently and intuitively using data structures that simplify the process. \n  \"\"\"\n  \n  detect_frame = conn.execute(f\"\"\"\n  SELECT *\n  FROM \n    information_schema.columns\n  WHERE \n    table_name = '{from_table}';\n  \"\"\").df()\n  \n  for i in list(range(4)):\n    if siiDetect(detect_frame) == True:\n      conn.sql(f\"\"\"\n        CREATE OR REPLACE TABLE {new_tables[i]} AS\n        SELECT\n          id\n          ,enroll_season\n          ,age\n          ,sex\n          ,sii\n          ,AVG(light) AS {quartuples.index[i]}\n        FROM \n          '{from_table}'\n        WHERE \n          hour_of_day BETWEEN \n              {quarters[quartuples.iloc[i][0]]}::DOUBLE \n            AND \n              {quarters[quartuples.iloc[i][1]]}::DOUBLE\n        GROUP BY \n          ALL\n        ORDER BY \n          id ASC;\"\"\")\n    else:\n      conn.sql(f\"\"\"\n        CREATE OR REPLACE TABLE {new_tables[i]} AS\n        SELECT\n          id\n          ,enroll_season\n          ,age\n          ,sex\n          ,AVG(light) AS {quartuples.index[i]}\n        FROM \n          '{from_table}'\n        WHERE \n          hour_of_day BETWEEN \n              {quarters[quartuples.iloc[i][0]]}::DOUBLE \n            AND \n              {quarters[quartuples.iloc[i][1]]}::DOUBLE\n        GROUP BY \n          ALL\n        ORDER BY \n          id ASC;\"\"\")\n\ndef joinLights (from_to_tables: dict) -> None:\n  \n  for from_table, to_table in from_to_tables.items():\n    \n    new_tables = ['Light1', 'Light2', 'Light3', 'Light4']\n    \n    quarters = quartiler(conn, 'hour_of_day', from_table)\n\n    intermediateLighter(conn, new_tables, quarters, quartuples, from_table)\n  \n    conn.sql(f\"\"\"\n    CREATE OR REPLACE TABLE {to_table} AS\n    SELECT \n      l1.*\n      ,l2.q1_q2\n      ,l3.q2_q3\n      ,l4.q3_max\n    FROM \n      Light1 l1\n    LEFT JOIN Light2 l2 ON l1.id = l2.id\n    LEFT JOIN Light3 l3 ON l1.id = l3.id\n    LEFT JOIN Light4 l4 ON l1.id = l4.id;\n    \"\"\")\n    \n    for table in new_tables:\n      conn.sql(f\"DROP TABLE {table};\")\n      \nquartuples = pd.Series(\n  data = \n  [('min','Q1')\n  ,('Q1', 'Q2')\n  ,('Q2', 'Q3')\n  ,('Q3' ,'max')]\n  ,index =\n  ['min_q1'\n  ,'q1_q2'\n  ,'q2_q3'\n  ,'q3_max'])\n\nfrom_to_tables = {\n  'ActigraphyTrain': 'AggregatedLights'\n  ,'ActigraphyTest': 'AggregatedLightsTest'\n  }\n\ntry:\n  joinLights(from_to_tables)\n  pydf = conn.sql(\"SELECT * FROM AggregatedLights LIMIT 10;\").df()\n  print(f\"Joined the lux tables and saved a preview of the aggregated table.\")\nexcept:\n  print(f\"Lux tables were not joined.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nJoined the lux tables and saved a preview of the aggregated table.\n```\n\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Free unused database memory from dropped tables and such.\"}\ntry:\n  conn.sql(f\"CHECKPOINT;\")\n  print(f\"Cleared unused memory.\")\nexcept:\n  print(f\"Could not clean unused memory.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n┌─────────┐\n│ Success │\n│ boolean │\n├─────────┤\n│ 0 rows  │\n└─────────┘\n\nCleared unused memory.\n```\n\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$pydf\n\nnotes_list =  list(\n  \"Unique participant identifier.\",\n  \"Participant enrollment into study season.\",\n  \"Age in years.\",\n  \"Sex (0 = Female, 1 = Male)\",\n  \"Severity Impairment Index\",\n  \"Mean light exposure across Q1 of a 24 hour time scale.\",\n  \"Mean light exposure across Q2 of a 24 hour time scale.\",\n  \"Mean light exposure across Q3 of a 24 hour time scale.\",\n  \"Mean light exposure across Q4 of a 24 hour time scale.\"\n  )\n\nlocations_list = list(\n  \"id\"\n  ,\"enroll_season\"\n  ,\"age\"\n  ,\"sex\"\n  ,\"sii\"\n  ,'min_q1'\n  ,'q1_q2'\n  ,'q2_q3'\n  ,'q3_max')\n\nfootnotes_df <- tibble(notes = notes_list, \n                       locations = locations_list)\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(\n    eval_palette(\"harrypotter::ravenclaw\", 7, 'c', 1))\n  )\n\nrTable <- r_table_theming(r_df,\n                          title = \"Quartile Data - Lights\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = TRUE)\n```\n:::\n\n\n:::\n\n::: p-1\n@tbl-AggregatedLights, returns the averages of light exposure, grouped by individual participants across the 4 6-hour time-frames of the day.\n:::\n\n::: table-flex\n\n\n::: {#tbl-AggregatedLights .cell tbl-cap='Quantiles related to mean lux exposure.'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"iujlnaznfa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#iujlnaznfa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#iujlnaznfa thead, #iujlnaznfa tbody, #iujlnaznfa tfoot, #iujlnaznfa tr, #iujlnaznfa td, #iujlnaznfa th {\n  border-style: none;\n}\n\n#iujlnaznfa p {\n  margin: 0;\n  padding: 0;\n}\n\n#iujlnaznfa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#iujlnaznfa .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#iujlnaznfa .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#iujlnaznfa .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#iujlnaznfa .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#iujlnaznfa .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#iujlnaznfa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#iujlnaznfa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#iujlnaznfa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#iujlnaznfa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#iujlnaznfa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#iujlnaznfa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#iujlnaznfa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#iujlnaznfa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#iujlnaznfa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#iujlnaznfa .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iujlnaznfa .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#iujlnaznfa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#iujlnaznfa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#iujlnaznfa .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iujlnaznfa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#iujlnaznfa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iujlnaznfa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_striped {\n  background-color: #333333;\n}\n\n#iujlnaznfa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#iujlnaznfa .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iujlnaznfa .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#iujlnaznfa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#iujlnaznfa .gt_left {\n  text-align: left;\n}\n\n#iujlnaznfa .gt_center {\n  text-align: center;\n}\n\n#iujlnaznfa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#iujlnaznfa .gt_font_normal {\n  font-weight: normal;\n}\n\n#iujlnaznfa .gt_font_bold {\n  font-weight: bold;\n}\n\n#iujlnaznfa .gt_font_italic {\n  font-style: italic;\n}\n\n#iujlnaznfa .gt_super {\n  font-size: 65%;\n}\n\n#iujlnaznfa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#iujlnaznfa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#iujlnaznfa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#iujlnaznfa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#iujlnaznfa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#iujlnaznfa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#iujlnaznfa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#iujlnaznfa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#iujlnaznfa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"9\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Quartile Data - Lights</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"id\">id<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"enroll_season\">enroll_season<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"age\">age<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sex\">sex<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sii\">sii<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"min_q1\">min_q1<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q1_q2\">q1_q2<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q2_q3\">q2_q3<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>8</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q3_max\">q3_max<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>9</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"id\" class=\"gt_row gt_left\" style=\"background-color: #006699; color: #FFFFFF;\">00115b9f</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">Winter</td>\n<td headers=\"age\" class=\"gt_row gt_center\" style=\"background-color: #2C8FC2; color: #FFFFFF;\">9</td>\n<td headers=\"sex\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"sii\" class=\"gt_row gt_center\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right\" style=\"background-color: #CEB197; color: #000000;\">23.045631</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right\" style=\"background-color: #65AFD9; color: #000000;\">61.57957</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right\" style=\"background-color: #268ABD; color: #FFFFFF;\">52.81590</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right\" style=\"background-color: #3599CC; color: #FFFFFF;\">17.014504</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #1477AA; color: #FFFFFF;\">001f3379</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Spring</td>\n<td headers=\"age\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #8CBDD9; color: #000000;\">13</td>\n<td headers=\"sex\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">2.091995</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #2286B9; color: #FFFFFF;\">38.87517</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #0D71A4; color: #FFFFFF;\">27.36520</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">3.436843</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left\" style=\"background-color: #298CC0; color: #FFFFFF;\">00f332d1</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">Winter</td>\n<td headers=\"age\" class=\"gt_row gt_center\" style=\"background-color: #A8BECA; color: #000000;\">14</td>\n<td headers=\"sex\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"sii\" class=\"gt_row gt_center\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right\" style=\"background-color: #B8B9B7; color: #000000;\">20.997433</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right\" style=\"background-color: #8ABCD9; color: #000000;\">70.66200</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right\" style=\"background-color: #D3761C; color: #FFFFFF;\">172.14445</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right\" style=\"background-color: #45A7D9; color: #FFFFFF;\">20.099417</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">012e3869</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Summer</td>\n<td headers=\"age\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #0B6FA2; color: #FFFFFF;\">6</td>\n<td headers=\"sex\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"sii\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #42A6D9; color: #FFFFFF;\">13.294238</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #086CA0; color: #FFFFFF;\">21.50671</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">14.48623</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">11.505972</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left\" style=\"background-color: #80B9D9; color: #000000;\">029a19c9</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center\" style=\"background-color: #98C2D9; color: #000000;\">Winter</td>\n<td headers=\"age\" class=\"gt_row gt_center\" style=\"background-color: #DBA16D; color: #000000;\">17</td>\n<td headers=\"sex\" class=\"gt_row gt_right\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right\" style=\"background-color: #3599CC; color: #FFFFFF;\">11.332134</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right\" style=\"background-color: #58ABD9; color: #FFFFFF;\">58.91847</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right\" style=\"background-color: #1478AB; color: #FFFFFF;\">35.59866</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right\" style=\"background-color: #0F73A6; color: #FFFFFF;\">7.528591</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #B4BBBC; color: #000000;\">02cebf33</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Spring</td>\n<td headers=\"age\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #71B3D9; color: #000000;\">12</td>\n<td headers=\"sex\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">35.523693</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #086DA0; color: #FFFFFF;\">21.77969</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">44.71041</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">52.702508</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left\" style=\"background-color: #D9AC82; color: #000000;\">02cf7384</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Summer</td>\n<td headers=\"age\" class=\"gt_row gt_center\" style=\"background-color: #D4AF8C; color: #000000;\">16</td>\n<td headers=\"sex\" class=\"gt_row gt_right\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right\" style=\"background-color: #197DB0; color: #FFFFFF;\">7.042261</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right\" style=\"background-color: #086C9F; color: #FFFFFF;\">21.47413</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right\" style=\"background-color: #0A6EA1; color: #FFFFFF;\">24.09722</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right\" style=\"background-color: #0E72A5; color: #FFFFFF;\">7.120843</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #DB8C45; color: #FFFFFF;\">035c96dd</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Summer</td>\n<td headers=\"age\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #8CBDD9; color: #000000;\">13</td>\n<td headers=\"sex\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #65AFD9; color: #000000;\">15.085578</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">16.63144</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #056A9D; color: #FFFFFF;\">19.23520</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #2A8DC0; color: #FFFFFF;\">14.558172</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left\" style=\"background-color: #CC7017; color: #FFFFFF;\">0417c91e</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Spring</td>\n<td headers=\"age\" class=\"gt_row gt_center\" style=\"background-color: #0B6FA2; color: #FFFFFF;\">6</td>\n<td headers=\"sex\" class=\"gt_row gt_right\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right\" style=\"background-color: #4FA9D9; color: #FFFFFF;\">13.857264</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">132.18453</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">197.77672</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right\" style=\"background-color: #369ACD; color: #FFFFFF;\">17.241575</td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">04afb6f9</td>\n<td headers=\"enroll_season\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Summer</td>\n<td headers=\"age\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #DBA16D; color: #000000;\">17</td>\n<td headers=\"sex\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"sii\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">2</td>\n<td headers=\"min_q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #55ABD9; color: #FFFFFF;\">14.194009</td>\n<td headers=\"q1_q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #046A9D; color: #FFFFFF;\">19.53135</td>\n<td headers=\"q2_q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #056A9D; color: #FFFFFF;\">19.77159</td>\n<td headers=\"q3_max\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #197DB0; color: #FFFFFF;\">10.799413</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"9\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> Unique participant identifier.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Participant enrollment into study season.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span> Age in years.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span> Sex (0 = Female, 1 = Male)</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span> Severity Impairment Index</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span> Mean light exposure across Q1 of a 24 hour time scale.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span> Mean light exposure across Q2 of a 24 hour time scale.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>8</sup></span> Mean light exposure across Q3 of a 24 hour time scale.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"9\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>9</sup></span> Mean light exposure across Q4 of a 24 hour time scale.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Join light data with internet use hours data.\"}\nlightsDict = {\n  'AggregatedLights': 'InternetUse', \n  'AggregatedLightsTest': 'InternetUseTest'\n  }\n\nfor from_tbl, join_tbl in lightsDict.items():\n  conn.sql(f\"\"\"\n  CREATE OR REPLACE TABLE '{from_tbl}' AS\n  SELECT\n    ft.*\n    ,jt.preint_eduhx_computerinternet_hoursday::INTEGER::TEXT::internet_hours_enum AS useHrs \n  FROM\n    '{from_tbl}' ft\n    LEFT JOIN \n      {join_tbl} jt\n    ON \n      ft.id = jt.id;\n  \"\"\")\n```\n:::\n\n\n:::\n\n::: p-1\nChecking the internet use hours parameter to get an overview along with null percentage to see if we might be able to use it, as-is, for joining with the corresponding lux quartile.\n:::\n\n::: code-fold-flex\n\n\n\n\n\n:::\n\n#### Sii, Lux, and Internet Use\n\n::: p-1\n@tbl-useToSii, is returning some descriptive statistics, such as count and mean, across the behavioral index, and mean lux by quartile, grouped by internet use hours.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Group-averaging sii, internet use hours, and pre-averaged lux quartile by age and sex.\"}\npydf = conn.sql(f\"\"\"\nSELECT\n  useHrs\n  ,COUNT(*) AS observations\n  ,AVG(sii::INTEGER) AS sii\n  ,AVG(min_q1) AS 'q1'\n  ,AVG(q1_q2) AS 'q2'\n  ,AVG(q2_q3) AS 'q3'\n  ,AVG(q3_max) AS 'q4'\nFROM \n  AggregatedLights al\nGROUP BY \n  useHrs;\"\"\").df()\n\npydf = pydf.dropna()\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$pydf\n\nnotes_list =  list(\n  \"Hours spent on the internet, as reported by caregivers of the participants.\",\n  \"Count of observations in the dataset.\",\n  \"Problematic behavior score.\",\n  \"Mean lux (12am to 6am)\",\n  \"Mean lux (6am to 12pm)\",\n  \"Mean lux (12pm to 6pm)\",\n  \"Mean lux (6pm to 12am)\"\n  )\n\nlocations_list = list(\n  \"useHrs\", \n  \"observations\",\n  \"sii\",\n  \"q1\",\n  \"q2\",\n  \"q3\",\n  \"q4\"\n  )\n\nfootnotes_df <- tibble(\n  notes = notes_list, \n  locations = locations_list\n  )\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(\n    eval_palette(\"harrypotter::ravenclaw\", 7, 'c', 1))\n  )\n\nrTable <- r_table_theming(r_df,\n                          title = \"Problematic Behavior to Internet Usage\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = FALSE\n                          )\n```\n:::\n\n\n:::\n\n::: table-flex\n\n\n::: {#tbl-useToSii .cell tbl-cap='Grouped averages of lux to sii.'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rbtrsstddh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rbtrsstddh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rbtrsstddh thead, #rbtrsstddh tbody, #rbtrsstddh tfoot, #rbtrsstddh tr, #rbtrsstddh td, #rbtrsstddh th {\n  border-style: none;\n}\n\n#rbtrsstddh p {\n  margin: 0;\n  padding: 0;\n}\n\n#rbtrsstddh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rbtrsstddh .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#rbtrsstddh .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#rbtrsstddh .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#rbtrsstddh .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rbtrsstddh .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rbtrsstddh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rbtrsstddh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rbtrsstddh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rbtrsstddh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rbtrsstddh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rbtrsstddh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rbtrsstddh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rbtrsstddh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rbtrsstddh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rbtrsstddh .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rbtrsstddh .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rbtrsstddh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rbtrsstddh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rbtrsstddh .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rbtrsstddh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rbtrsstddh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rbtrsstddh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_striped {\n  background-color: #333333;\n}\n\n#rbtrsstddh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#rbtrsstddh .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rbtrsstddh .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rbtrsstddh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rbtrsstddh .gt_left {\n  text-align: left;\n}\n\n#rbtrsstddh .gt_center {\n  text-align: center;\n}\n\n#rbtrsstddh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rbtrsstddh .gt_font_normal {\n  font-weight: normal;\n}\n\n#rbtrsstddh .gt_font_bold {\n  font-weight: bold;\n}\n\n#rbtrsstddh .gt_font_italic {\n  font-style: italic;\n}\n\n#rbtrsstddh .gt_super {\n  font-size: 65%;\n}\n\n#rbtrsstddh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rbtrsstddh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rbtrsstddh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rbtrsstddh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rbtrsstddh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rbtrsstddh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rbtrsstddh .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#rbtrsstddh .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#rbtrsstddh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Problematic Behavior to Internet Usage</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"useHrs\">useHrs<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"observations\">observations<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sii\">sii<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q1\">q1<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q2\">q2<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q3\">q3<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q4\">q4<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"useHrs\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">0</td>\n<td headers=\"observations\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">474</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.3291139</td>\n<td headers=\"q1\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">12.34923</td>\n<td headers=\"q2\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">54.33614</td>\n<td headers=\"q3\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">75.33046</td>\n<td headers=\"q4\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">14.37498</td></tr>\n    <tr><td headers=\"useHrs\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">1</td>\n<td headers=\"observations\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #076C9F; color: #FFFFFF;\">117</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #79B6D9; color: #000000;\">0.6666667</td>\n<td headers=\"q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #90BFD9; color: #000000;\">15.14069</td>\n<td headers=\"q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #288BBE; color: #FFFFFF;\">46.08189</td>\n<td headers=\"q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #177BAE; color: #FFFFFF;\">66.78185</td>\n<td headers=\"q4\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #2487BA; color: #FFFFFF;\">15.30225</td></tr>\n    <tr><td headers=\"useHrs\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">2</td>\n<td headers=\"observations\" class=\"gt_row gt_right\" style=\"background-color: #98C2D9; color: #000000;\">288</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #ACBDC5; color: #000000;\">0.7534722</td>\n<td headers=\"q1\" class=\"gt_row gt_right\" style=\"background-color: #40A4D7; color: #FFFFFF;\">14.24140</td>\n<td headers=\"q2\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">43.78829</td>\n<td headers=\"q3\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">65.41403</td>\n<td headers=\"q4\" class=\"gt_row gt_right\" style=\"background-color: #2589BC; color: #FFFFFF;\">15.33504</td></tr>\n    <tr><td headers=\"useHrs\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">3</td>\n<td headers=\"observations\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">102</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">1.1176471</td>\n<td headers=\"q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">18.15549</td>\n<td headers=\"q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #75B4D9; color: #000000;\">48.21921</td>\n<td headers=\"q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #95C1D9; color: #000000;\">70.29719</td>\n<td headers=\"q4\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">19.04650</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot>\n    <tr class=\"gt_footnotes\">\n      <td class=\"gt_footnote\" colspan=\"7\">\n        <div style=\"padding-bottom:2px;\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> Hours spent on the internet, as reported by caregivers of the participants., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Count of observations in the dataset., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span> Problematic behavior score., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span> Mean lux (12am to 6am), <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span> Mean lux (6am to 12pm), <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span> Mean lux (12pm to 6pm), <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span> Mean lux (6pm to 12am)</div>\n      </td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"plot setup\"}\nlibrary(scales)\n\nr_plot <- ggplot(data = r_df, \n                 mapping = aes(x = useHrs, y = sii)\n                 ) +\n  geom_col(aes(fill = sii)) +\n  scale_fill_gradient(low = muted(\"yellow\"), high = muted(\"purple\")) +\n  labs(title = 'Internet Use to Behavioral Index', \n       x = 'Hours of Internet Use', \n       y = \"Problematic Behavior Index (sii)\")\n\nr_plot <- r_plot + ggplot_theming()\n```\n:::\n\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Categorized bmi risk to internet use and sii.](index_files/figure-html/fig-useSii-1.png){#fig-useSii width=672}\n:::\n:::\n\n\n\n#### Disease Risk Categories\n\n::: p-1\nSomething perhaps not seen everyday is SQL syntax in a Python environment. The performance of the SQL database, in this case, DuckDB, likely outperforms Pandas and Polars. An aim for this project was also to demonstrate some competence with SQL, but also approach practical use-case scenarios.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Combining SQL with Python data structures to organized data according to several conditions, such as: bmi, age, sex, and waist_circumference.\"}\nriskyDictionary = {\n  'Risk1': \n    (f\",CASE WHEN ph.physical_bmi < 18.5 THEN 'Underweight'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'Increased'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'High'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'\"\n    ,f\"WHEN ph.physical_bmi >= 40 THEN 'Extremely High'\"\n    ,f\"ph.physical_waist_circumference <= 35 AND al.sex = '0'\"),\n  'Risk2':\n    (f\",CASE WHEN ph.physical_bmi < 18.5 THEN 'Underweight'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'High'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'Very High'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'\"\n    ,f\"WHEN ph.physical_bmi >= 40 THEN 'Extremely High'\"\n    ,f\"ph.physical_waist_circumference > 35 AND al.sex = '0'\"),\n  'Risk3':\n    (f\",CASE WHEN ph.physical_bmi < 18.5 THEN 'Underweight'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'Increased'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'High'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'\"\n    ,f\"WHEN ph.physical_bmi >= 40 THEN 'Extremely High'\"\n    ,f\"ph.physical_waist_circumference <= 40 AND al.sex = '1'\"),\n  'Risk4':\n    (f\",CASE WHEN ph.physical_bmi < 18.5 THEN 'Underweight'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 18.5 AND 24.9 THEN 'Normal'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 25.0 AND 29.9 THEN 'High'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 30.0 AND 34.9 THEN 'Very High'\"\n    ,f\"WHEN ph.physical_bmi BETWEEN 35.0 AND 39.9 THEN 'Very High'\"\n    ,f\"WHEN ph.physical_bmi >= 40 THEN 'Extremely High'\"\n    ,f\"ph.physical_waist_circumference > 40 AND al.sex = '1'\")\n    }\n\nriskyDf = pd.DataFrame(data = riskyDictionary)\n\nfor key, value in riskyDf.items():\n  try:\n    conn.sql(f\"\"\"\n    CREATE OR REPLACE TABLE {key} AS\n    SELECT\n      al.*\n      {value[0]}\n      {value[1]}\n      {value[2]}\n      {value[3]}\n      {value[4]}\n      {value[5]}\n      ELSE NULL\n      END AS risk_cat\n    ,risk_cat::disease_risk_enum AS risk_category\n    FROM \n      Physical ph \n    LEFT JOIN \n      AggregatedLights al\n    ON \n      al.id = ph.id\n    WHERE \n      {value[6]}\n    ORDER BY \n      al.id ASC;\n      \"\"\")\n    result = conn.sql(f\"SELECT COUNT(*) FROM {key}\").fetchone()\n    print(f\"created table: {key}, \\n\\tRow count: {result[0]}\\n\")\n  except:\n    print(f\"Error loading this table: {key}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ncreated table: Risk1, \n\tRow count: 24\n\ncreated table: Risk2, \n\tRow count: 1\n\ncreated table: Risk3, \n\tRow count: 20\n\ncreated table: Risk4, \n\tRow count: 2\n```\n\n\n:::\n\n```{.python .cell-code  code-summary=\"Combining SQL with Python data structures to organized data according to several conditions, such as: bmi, age, sex, and waist_circumference.\"}\n\nconn.sql(f\"\"\"\nCREATE OR REPLACE TABLE \n  DiseaseRiskDemographic AS\nSELECT * EXCLUDE(risk_cat) FROM Risk1\nUNION BY NAME\nSELECT * EXCLUDE(risk_cat) FROM Risk2\nUNION BY NAME\nSELECT * EXCLUDE(risk_cat) FROM Risk3\nUNION BY NAME \nSELECT * EXCLUDE(risk_cat) FROM Risk4;\n\"\"\")\n```\n:::\n\n\n:::\n\n::: p-1\nIt might be useful to explore statistics when grouped by risk categories.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Grouped averaging by risk category.\"}\nconn.sql(f\"\"\"\nCREATE OR REPLACE TABLE RiskCategorySummary AS\nSELECT \n  risk_category\n  ,AVG(sii::NUMERIC) AS sii\n  ,AVG(useHrs::INTEGER) AS useHrs\n  ,AVG(min_q1) AS 'q1'\n  ,AVG(q1_q2) AS 'q2'\n  ,AVG(q2_q3) AS 'q3'\n  ,AVG(q3_max) AS 'q4'\nFROM \n  DiseaseRiskDemographic\nGROUP BY \n  risk_category;\n\"\"\")\n\npydf = conn.sql(\"\"\"\nSELECT * \nFROM RiskCategorySummary;\n\"\"\").df()\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$pydf\n\nnotes_list =  list(\"The disease risk category.\",\n                   \"Problematic behavior index.\",\n                   \"Reported interet usage (hours).\",\n                   \"12am to 6am\",\n                   \"6am to 12pm.\",\n                   \"12pm to 6pm\",\n                   \"6pm to 12am\")\n\nlocations_list = list(\"risk_category\"\n                      ,\"sii\"\n                      ,\"useHrs\"\n                      ,\"q1\"\n                      ,\"q2\"\n                      ,\"q3\"\n                      ,\"q4\")\n\nfootnotes_df <- tibble(notes = notes_list, \n                       locations = locations_list)\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(eval_palette(\"harrypotter::ravenclaw\", 7, 'c', 1))\n  )\n\nrTable <- r_table_theming(r_df,\n                          title = \"Disease Risk Categories to Lux\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = FALSE\n                          )\n```\n:::\n\n\n:::\n\n::: p-1\n@tbl-diseaseRiskLux shows the grouped-averages of the problematic behavior index, internet use hours, and mean lux across the time of day quartiles by disease risk category of participants.\n:::\n\n::: table-flex\n\n\n::: {#tbl-diseaseRiskLux .cell tbl-cap='Disease risk categories by lux exposure.'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qoaefwtytl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qoaefwtytl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qoaefwtytl thead, #qoaefwtytl tbody, #qoaefwtytl tfoot, #qoaefwtytl tr, #qoaefwtytl td, #qoaefwtytl th {\n  border-style: none;\n}\n\n#qoaefwtytl p {\n  margin: 0;\n  padding: 0;\n}\n\n#qoaefwtytl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qoaefwtytl .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#qoaefwtytl .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#qoaefwtytl .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#qoaefwtytl .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qoaefwtytl .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qoaefwtytl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qoaefwtytl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qoaefwtytl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qoaefwtytl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qoaefwtytl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qoaefwtytl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qoaefwtytl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qoaefwtytl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qoaefwtytl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qoaefwtytl .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qoaefwtytl .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qoaefwtytl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qoaefwtytl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qoaefwtytl .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qoaefwtytl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qoaefwtytl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qoaefwtytl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_striped {\n  background-color: #333333;\n}\n\n#qoaefwtytl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#qoaefwtytl .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qoaefwtytl .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qoaefwtytl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qoaefwtytl .gt_left {\n  text-align: left;\n}\n\n#qoaefwtytl .gt_center {\n  text-align: center;\n}\n\n#qoaefwtytl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qoaefwtytl .gt_font_normal {\n  font-weight: normal;\n}\n\n#qoaefwtytl .gt_font_bold {\n  font-weight: bold;\n}\n\n#qoaefwtytl .gt_font_italic {\n  font-style: italic;\n}\n\n#qoaefwtytl .gt_super {\n  font-size: 65%;\n}\n\n#qoaefwtytl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qoaefwtytl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qoaefwtytl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qoaefwtytl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qoaefwtytl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qoaefwtytl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qoaefwtytl .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qoaefwtytl .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qoaefwtytl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Disease Risk Categories to Lux</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"risk_category\">risk_category<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sii\">sii<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"useHrs\">useHrs<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q1\">q1<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q2\">q2<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q3\">q3<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q4\">q4<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">Underweight</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #92BFD9; color: #000000;\">0.2424242</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.5757576</td>\n<td headers=\"q1\" class=\"gt_row gt_right\" style=\"background-color: #2C8FC2; color: #FFFFFF;\">13.330039</td>\n<td headers=\"q2\" class=\"gt_row gt_right\" style=\"background-color: #D97E25; color: #FFFFFF;\">66.41683</td>\n<td headers=\"q3\" class=\"gt_row gt_right\" style=\"background-color: #BD630A; color: #FFFFFF;\">115.40578</td>\n<td headers=\"q4\" class=\"gt_row gt_right\" style=\"background-color: #2B8EC1; color: #FFFFFF;\">13.214609</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Normal</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #3194C8; color: #FFFFFF;\">1.2000000</td>\n<td headers=\"q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">35.113050</td>\n<td headers=\"q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #DAA676; color: #000000;\">61.22258</td>\n<td headers=\"q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #8EBED9; color: #000000;\">90.43512</td>\n<td headers=\"q4\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">30.368059</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Increased</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #C1B7AB; color: #000000;\">2.0000000</td>\n<td headers=\"q1\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">6.728299</td>\n<td headers=\"q2\" class=\"gt_row gt_right\" style=\"background-color: #02689B; color: #FFFFFF;\">35.98224</td>\n<td headers=\"q3\" class=\"gt_row gt_right\" style=\"background-color: #3A9ED1; color: #FFFFFF;\">81.17680</td>\n<td headers=\"q4\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">8.067938</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #D9AC82; color: #000000;\">Very High</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #DB883B; color: #FFFFFF;\">2.5000000</td>\n<td headers=\"q1\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C2B6AA; color: #000000;\">23.489066</td>\n<td headers=\"q2\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">35.45635</td>\n<td headers=\"q3\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">65.65650</td>\n<td headers=\"q4\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #A2C0D0; color: #000000;\">19.591619</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #D97C21; color: #FFFFFF;\">Extremely High</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">3.0000000</td>\n<td headers=\"q1\" class=\"gt_row gt_right\" style=\"background-color: #8FBED9; color: #000000;\">20.273825</td>\n<td headers=\"q2\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">72.87793</td>\n<td headers=\"q3\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">117.79320</td>\n<td headers=\"q4\" class=\"gt_row gt_right\" style=\"background-color: #DB9250; color: #FFFFFF;\">24.963076</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot>\n    <tr class=\"gt_footnotes\">\n      <td class=\"gt_footnote\" colspan=\"7\">\n        <div style=\"padding-bottom:2px;\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> The disease risk category., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Problematic behavior index., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span> Reported interet usage (hours)., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span> 12am to 6am, <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span> 6am to 12pm., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span> 12pm to 6pm, <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span> 6pm to 12am</div>\n      </td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Pivoting the data longer to accommodate more useful plot output.\"}\nlibrary(tidyr)\nlibrary(dplyr)\n\ndata_long <- r_df |>\n  pivot_longer(\n    cols = c(q1, q2, q3, q4),\n    names_to = \"quarter\",\n    values_to = \"lux\") |>\n  mutate(quarter = factor(quarter, \n                          levels = c(\"q1\",\n                                     \"q2\",\n                                     \"q3\",\n                                     \"q4\")))\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nlocations_list = list(\"risk_category\", \"sii\", \"useHrs\", \"quarter\", \"lux\")\nnotes_list =  list(\"Disease risk based on BMI, waist circumference, and sex.\",\n                   \"Problematic behavior index.\",\n                   \"Hours of reported internet use.\",\n                   \"Quartile of day.\",\n                   \"Average light exposure.\")\n\nfootnotes_df <- tibble(notes = notes_list, locations = locations_list)\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(eval_palette(\"harrypotter::ravenclaw\", 7, 'c', 1)))\n\nrTable <- r_table_theming(data_long,\n                          title = \"Disease Risk Categories to Lux\",\n                          subtitle = \"Pivoted Longer\",\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = TRUE,\n                          tbl_font_size = pct(80)\n                          )\n```\n:::\n\n\n:::\n\n::: p-1\n@tbl-longerDiseaseCat is a pivoted version of the previous table, @tbl-diseaseRiskLux.\n:::\n\n::: table-flex\n\n\n::: {#tbl-longerDiseaseCat .cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"tgxcrybver\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tgxcrybver table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tgxcrybver thead, #tgxcrybver tbody, #tgxcrybver tfoot, #tgxcrybver tr, #tgxcrybver td, #tgxcrybver th {\n  border-style: none;\n}\n\n#tgxcrybver p {\n  margin: 0;\n  padding: 0;\n}\n\n#tgxcrybver .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 80%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tgxcrybver .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#tgxcrybver .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#tgxcrybver .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#tgxcrybver .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tgxcrybver .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tgxcrybver .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tgxcrybver .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tgxcrybver .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tgxcrybver .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tgxcrybver .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tgxcrybver .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tgxcrybver .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tgxcrybver .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tgxcrybver .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tgxcrybver .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tgxcrybver .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tgxcrybver .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tgxcrybver .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tgxcrybver .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tgxcrybver .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tgxcrybver .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tgxcrybver .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_striped {\n  background-color: #333333;\n}\n\n#tgxcrybver .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#tgxcrybver .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tgxcrybver .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tgxcrybver .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tgxcrybver .gt_left {\n  text-align: left;\n}\n\n#tgxcrybver .gt_center {\n  text-align: center;\n}\n\n#tgxcrybver .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tgxcrybver .gt_font_normal {\n  font-weight: normal;\n}\n\n#tgxcrybver .gt_font_bold {\n  font-weight: bold;\n}\n\n#tgxcrybver .gt_font_italic {\n  font-style: italic;\n}\n\n#tgxcrybver .gt_super {\n  font-size: 65%;\n}\n\n#tgxcrybver .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tgxcrybver .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tgxcrybver .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tgxcrybver .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tgxcrybver .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tgxcrybver .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tgxcrybver .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#tgxcrybver .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#tgxcrybver div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>Disease Risk Categories to Lux</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Pivoted Longer</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"risk_category\">risk_category<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sii\">sii<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"useHrs\">useHrs<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"quarter\">quarter<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lux\">lux<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">Underweight</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #92BFD9; color: #000000;\">0.2424242</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.5757576</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">q1</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #0B6FA2; color: #FFFFFF;\">13.330039</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">Underweight</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #92BFD9; color: #000000;\">0.2424242</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0.5757576</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">q2</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #ACBDC5; color: #000000;\">66.416830</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">Underweight</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #92BFD9; color: #000000;\">0.2424242</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.5757576</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">q3</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #B85D04; color: #FFFFFF;\">115.405777</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">Underweight</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #92BFD9; color: #000000;\">0.2424242</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0.5757576</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">q4</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #0B6FA2; color: #FFFFFF;\">13.214609</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Normal</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #3194C8; color: #FFFFFF;\">1.2000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">q1</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #3194C7; color: #FFFFFF;\">35.113050</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Normal</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #3194C8; color: #FFFFFF;\">1.2000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">q2</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #94C0D9; color: #000000;\">61.222575</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Normal</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #3194C8; color: #FFFFFF;\">1.2000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">q3</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #DB9352; color: #000000;\">90.435121</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">Normal</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #3194C8; color: #FFFFFF;\">1.2000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">q4</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #278ABD; color: #FFFFFF;\">30.368059</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Increased</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #C1B7AB; color: #000000;\">2.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">q1</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">6.728299</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Increased</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C1B7AB; color: #000000;\">2.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">q2</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #3396C9; color: #FFFFFF;\">35.982235</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Increased</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #C1B7AB; color: #000000;\">2.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">q3</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #D9AB80; color: #000000;\">81.176802</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #41A6D9; color: #FFFFFF;\">Increased</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C1B7AB; color: #000000;\">2.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">q4</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #02689B; color: #FFFFFF;\">8.067938</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #D9AC82; color: #000000;\">Very High</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #DB883B; color: #FFFFFF;\">2.5000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">q1</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #197DB1; color: #FFFFFF;\">23.489066</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #D9AC82; color: #000000;\">Very High</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #DB883B; color: #FFFFFF;\">2.5000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">q2</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #3295C8; color: #FFFFFF;\">35.456346</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #D9AC82; color: #000000;\">Very High</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #DB883B; color: #FFFFFF;\">2.5000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">q3</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #A9BEC9; color: #000000;\">65.656499</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #D9AC82; color: #000000;\">Very High</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">0.5000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #DB883B; color: #FFFFFF;\">2.5000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">q4</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1478AB; color: #FFFFFF;\">19.591619</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #D97C21; color: #FFFFFF;\">Extremely High</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">3.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #006699; color: #FFFFFF;\">q1</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #1579AC; color: #FFFFFF;\">20.273825</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #D97C21; color: #FFFFFF;\">Extremely High</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">3.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">q2</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C4B5A7; color: #000000;\">72.877935</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center\" style=\"background-color: #D97C21; color: #FFFFFF;\">Extremely High</td>\n<td headers=\"sii\" class=\"gt_row gt_right\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">3.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center\" style=\"background-color: #41A6D9; color: #FFFFFF;\">q3</td>\n<td headers=\"lux\" class=\"gt_row gt_right\" style=\"background-color: #B35900; color: #FFFFFF;\">117.793201</td></tr>\n    <tr><td headers=\"risk_category\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #D97C21; color: #FFFFFF;\">Extremely High</td>\n<td headers=\"sii\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #006699; color: #FFFFFF;\">0.0000000</td>\n<td headers=\"useHrs\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #B35900; color: #FFFFFF;\">3.0000000</td>\n<td headers=\"quarter\" class=\"gt_row gt_center gt_striped\" style=\"background-color: #98C2D9; color: #000000;\">q4</td>\n<td headers=\"lux\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #1B80B3; color: #FFFFFF;\">24.963076</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"5\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> Disease risk based on BMI, waist circumference, and sex.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Problematic behavior index.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span> Hours of reported internet use.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span> Quartile of day.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span> Average light exposure.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"plot setup\"}\nr_plot <- ggplot(data = data_long, \n                 aes(x = quarter, \n                     y = lux, \n                     group = risk_category, \n                     color = risk_category)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 3) +\n  labs(title = \"Does disease risk relate to light exposure\\n by certain times of the day?\",\n       x = \"Time Period\",\n       y = \"Mean Lux Value\",\n       color = \"Risk Category\")\n\nr_plot <- r_plot + ggplot_theming()\n```\n:::\n\n\n:::\n\n@fig-luxRiskCat was an attempt at visualizing the relationship, if any, by mean lux exposure across participants, time of day quartile, and disease risk. Disease risk was based on BMI, waist-circumference, and sex data.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Grouped risk by lux and time period.](index_files/figure-html/fig-luxRiskCat-1.png){#fig-luxRiskCat width=672}\n:::\n:::\n\n\n\n## Summary Profiles\n\n::: p-1\nIn the future, this data could be further explored. For now, the descriptive statistics can be saved to files for quickly restarting and diving deeper.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Create future training and testing data profiles from summary statistics to inform modeling choices.\"}\nsummary_dict = {\n  'ActigraphyTrain': \n    ('ActigraphyTrainSummary'\n    ,'data/profiles/actigraphy_train_profile.csv'),\n  'ActigraphyTest': \n    ('ActigraphyTestSummary'\n    ,'data/profiles/actigraphy_test_profile.csv'),\n  'TrainCsv': \n    ('TrainCsvSummary'\n    ,'data/profiles/train_csv_profile.csv'),\n  'TestCsv': \n    ('TestCsvSummary'\n    ,'data/profiles/test_csv_profile.csv')\n    }\n\nsummary_frame = pd.DataFrame(summary_dict)\n\nfor key, value in summary_frame.items():\n  try:\n    py_summary_df = conn.sql(f\"SUMMARIZE SELECT * FROM '{key}';\").df()\n    conn.register(value[0], py_summary_df)\n    conn.sql(f\"COPY {value[0]} TO '{value[1]}' (HEADER , DELIMITER ',');\")\n    print(f\"'{value[1]}' was CREATED\\n\")\n  except:\n    print(f\"'{value[1]}' was not CREATED\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0>\n'data/profiles/actigraphy_train_profile.csv' was CREATED\n\n<duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0>\n'data/profiles/actigraphy_test_profile.csv' was CREATED\n\n<duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0>\n'data/profiles/train_csv_profile.csv' was CREATED\n\n<duckdb.duckdb.DuckDBPyConnection object at 0x7b887484d4b0>\n'data/profiles/test_csv_profile.csv' was CREATED\n```\n\n\n:::\n:::\n\n\n:::\n\n\n\n\n\n\n\n## Close Connection\n\nThe in-memory database connection can be closed.\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Releases all database memory and de-references the connection variable.\"}\ntry:\n  conn.close()\n  print(f\"database connection closed\")\nexcept:\n  print(f\"could not close the connection\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndatabase connection closed\n```\n\n\n:::\n:::\n\n\n:::\n\n## Closing Thoughts\n\n::: p-1\nThe purpose of the article was to explore an active Kaggle competition dataset and improve workflow methodologies and output. This analysis can be expanded to be more insightful for this particular domain. The objective has been achieved as much was learned and improved functions have been developed alongside improved CSS styling.\n\nThis particular dataset contained a lot of missing data despite being quite large. Due to this incomplete data across many of the columns, some of the data transformations resulted in as low as \\~50 observations from the original \\~1000. The leaderboard that came along with this dataset from a past competition suggests that the model accuracy tops out only around 0.48, [@tbl-leaderboard]. While some patterns could be gleaned, the predictive power of any modeling attempts might as well have been doomed.\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.python .cell-code  code-summary=\"Reads a recently downloaded the private leaderboard csv (from the competition website's Leaderboard tab) to a dataframe.\"}\nleaderboard_path = \"data/privateLeaderboard.csv\"\nleaderboard_df = pd.read_csv(leaderboard_path)\n\npy_df = leaderboard_df.head(n = 10)\n```\n:::\n\n\n:::\n\n::: code-fold-flex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"table setup\"}\nr_df <- py$py_df\n\nnotes_list =  list(\"Overall ranking\",\n                   \"Unique team ID.\",\n                   \"Chosen name of the team.\",\n                   \"Their final submission date.\",\n                   \"The accuracy score of model.\",\n                   \"Total competition submissions.\",\n                   \"Names of the team members.\")\n\nlocations_list = list(\n  \"Rank\", \n  \"TeamId\", \n  \"TeamName\", \n  \"LastSubmissionDate\", \n  \"Score\", \n  \"SubmissionCount\", \n  \"TeamMemberUserNames\")\n\nfootnotes_df <- tibble(notes = notes_list, \n                       locations = locations_list)\n\npal_df <- tibble(\n  cols = locations_list,\n  pals = list(eval_palette(\"ggsci::legacy_tron\", 7, 'd', 1))\n  )\n\nrTable <- r_table_theming(r_df,\n                          title = \"Leaderboard Rankings\",\n                          subtitle = NULL,\n                          footnotes_df,\n                          source_note = md(\"**source**: Kaggle\"),\n                          pal_df,\n                          multiline_feet = FALSE,\n                          target_everything = TRUE,\n                          color_by_columns = \"Rank\",\n                          tbl_font_size = pct(75)\n                          )\n```\n:::\n\n\n:::\n\n::: table-flex\n\n\n::: {#tbl-leaderboard .cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mdoevtttoy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mdoevtttoy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mdoevtttoy thead, #mdoevtttoy tbody, #mdoevtttoy tfoot, #mdoevtttoy tr, #mdoevtttoy td, #mdoevtttoy th {\n  border-style: none;\n}\n\n#mdoevtttoy p {\n  margin: 0;\n  padding: 0;\n}\n\n#mdoevtttoy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: 1px;\n  margin-right: 1px;\n  color: #FFFFFF;\n  font-size: 75%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #222222;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mdoevtttoy .gt_title {\n  color: #FFFFFF;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #222222;\n  border-bottom-width: 0;\n}\n\n#mdoevtttoy .gt_subtitle {\n  color: #FFFFFF;\n  font-size: 110%;\n  font-weight: initial;\n  padding-top: 19px;\n  padding-bottom: 21px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #222222;\n  border-top-width: 0;\n}\n\n#mdoevtttoy .gt_heading {\n  background-color: #222222;\n  text-align: center;\n  border-bottom-color: #222222;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n}\n\n#mdoevtttoy .gt_col_heading {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #000000;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 11px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mdoevtttoy .gt_column_spanner_outer {\n  color: #FFFFFF;\n  background-color: #333333;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mdoevtttoy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mdoevtttoy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mdoevtttoy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 10px;\n  padding-bottom: 10px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mdoevtttoy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mdoevtttoy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mdoevtttoy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mdoevtttoy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mdoevtttoy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mdoevtttoy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-left-style: none;\n  border-left-width: 0px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 0px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mdoevtttoy .gt_stub {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mdoevtttoy .gt_stub_row_group {\n  color: #FFFFFF;\n  background-color: #222222;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mdoevtttoy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mdoevtttoy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mdoevtttoy .gt_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mdoevtttoy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mdoevtttoy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_grand_summary_row {\n  color: #FFFFFF;\n  background-color: #222222;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mdoevtttoy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_striped {\n  background-color: #333333;\n}\n\n#mdoevtttoy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 0px;\n  border-top-color: #000000;\n  border-bottom-style: solid;\n  border-bottom-width: 0px;\n  border-bottom-color: #000000;\n}\n\n#mdoevtttoy .gt_footnotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mdoevtttoy .gt_sourcenotes {\n  color: #FFFFFF;\n  background-color: #222222;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mdoevtttoy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mdoevtttoy .gt_left {\n  text-align: left;\n}\n\n#mdoevtttoy .gt_center {\n  text-align: center;\n}\n\n#mdoevtttoy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mdoevtttoy .gt_font_normal {\n  font-weight: normal;\n}\n\n#mdoevtttoy .gt_font_bold {\n  font-weight: bold;\n}\n\n#mdoevtttoy .gt_font_italic {\n  font-style: italic;\n}\n\n#mdoevtttoy .gt_super {\n  font-size: 65%;\n}\n\n#mdoevtttoy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mdoevtttoy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mdoevtttoy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mdoevtttoy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mdoevtttoy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mdoevtttoy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mdoevtttoy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mdoevtttoy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mdoevtttoy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Leaderboard Rankings</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rank\">Rank<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"TeamId\">TeamId<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"TeamName\">TeamName<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"LastSubmissionDate\">LastSubmissionDate<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Score\">Score<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SubmissionCount\">SubmissionCount<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"TeamMemberUserNames\">TeamMemberUserNames<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right\" style=\"background-color: #FF410D; color: #FFFFFF;\">1</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right\" style=\"background-color: #FF410D; color: #FFFFFF;\">12642715</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left\" style=\"background-color: #FF410D; color: #FFFFFF;\">Lennart Haupts</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right\" style=\"background-color: #FF410D; color: #FFFFFF;\">2024-12-19 10:51:55</td>\n<td headers=\"Score\" class=\"gt_row gt_right\" style=\"background-color: #FF410D; color: #FFFFFF;\">0.482</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right\" style=\"background-color: #FF410D; color: #FFFFFF;\">127</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left\" style=\"background-color: #FF410D; color: #FFFFFF;\">lennarthaupts</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">2</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">12640776</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">Aradhye Agarwal</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">2024-09-21 16:43:26</td>\n<td headers=\"Score\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">0.478</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">2</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #CAB5AF; color: #000000;\">aradhyeagarwal</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right\" style=\"background-color: #B9D8BF; color: #000000;\">3</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right\" style=\"background-color: #B9D8BF; color: #000000;\">12795402</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left\" style=\"background-color: #B9D8BF; color: #000000;\">Jobayer Hossain</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right\" style=\"background-color: #B9D8BF; color: #000000;\">2024-12-19 23:21:50</td>\n<td headers=\"Score\" class=\"gt_row gt_right\" style=\"background-color: #B9D8BF; color: #000000;\">0.478</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right\" style=\"background-color: #B9D8BF; color: #000000;\">71</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left\" style=\"background-color: #B9D8BF; color: #000000;\">jobayerhossain</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F7C530; color: #000000;\">4</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F7C530; color: #000000;\">13005648</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #F7C530; color: #000000;\">Underfit Squad</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F7C530; color: #000000;\">2024-12-19 14:49:07</td>\n<td headers=\"Score\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F7C530; color: #000000;\">0.477</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F7C530; color: #000000;\">43</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #F7C530; color: #000000;\">dungquang8229,minhduonq</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right\" style=\"background-color: #B9CB51; color: #000000;\">5</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right\" style=\"background-color: #B9CB51; color: #000000;\">12659689</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left\" style=\"background-color: #B9CB51; color: #000000;\">peyman armaghan</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right\" style=\"background-color: #B9CB51; color: #000000;\">2024-12-19 23:22:02</td>\n<td headers=\"Score\" class=\"gt_row gt_right\" style=\"background-color: #B9CB51; color: #000000;\">0.477</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right\" style=\"background-color: #B9CB51; color: #000000;\">40</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left\" style=\"background-color: #B9CB51; color: #000000;\">peymanarmaghan</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">6</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">12732446</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">m_furu</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">2024-10-27 12:28:49</td>\n<td headers=\"Score\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">0.476</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">21</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #ACD38C; color: #000000;\">miyafuru</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right\" style=\"background-color: #D0DFE6; color: #000000;\">7</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right\" style=\"background-color: #D0DFE6; color: #000000;\">12633225</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left\" style=\"background-color: #D0DFE6; color: #000000;\">sqrt4kaido</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right\" style=\"background-color: #D0DFE6; color: #000000;\">2024-12-19 13:41:18</td>\n<td headers=\"Score\" class=\"gt_row gt_right\" style=\"background-color: #D0DFE6; color: #000000;\">0.475</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right\" style=\"background-color: #D0DFE6; color: #000000;\">32</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left\" style=\"background-color: #D0DFE6; color: #000000;\">nomorevotch</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">8</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">12730664</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">Kzk Knmt</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">2024-12-18 15:05:28</td>\n<td headers=\"Score\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">0.474</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">26</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #F3B36A; color: #000000;\">kzkknmt</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right\" style=\"background-color: #D49757; color: #000000;\">9</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right\" style=\"background-color: #D49757; color: #000000;\">12637841</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left\" style=\"background-color: #D49757; color: #000000;\">Sedat Golgiyaz-BingolUniversty</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right\" style=\"background-color: #D49757; color: #000000;\">2024-12-19 22:44:26</td>\n<td headers=\"Score\" class=\"gt_row gt_right\" style=\"background-color: #D49757; color: #000000;\">0.473</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right\" style=\"background-color: #D49757; color: #000000;\">384</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left\" style=\"background-color: #D49757; color: #000000;\">sedatgolgyaz</td></tr>\n    <tr><td headers=\"Rank\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">10</td>\n<td headers=\"TeamId\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">12653466</td>\n<td headers=\"TeamName\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">Jpmr</td>\n<td headers=\"LastSubmissionDate\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">2024-12-19 06:59:01</td>\n<td headers=\"Score\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">0.473</td>\n<td headers=\"SubmissionCount\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">33</td>\n<td headers=\"TeamMemberUserNames\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #748AA6; color: #FFFFFF;\">junpeimorioka</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"PHN0cm9uZz5zb3VyY2U8L3N0cm9uZz46IEthZ2dsZQ==\"><span class='gt_from_md'><strong>source</strong>: Kaggle</span></span></td>\n    </tr>\n  </tfoot>\n  <tfoot>\n    <tr class=\"gt_footnotes\">\n      <td class=\"gt_footnote\" colspan=\"7\">\n        <div style=\"padding-bottom:2px;\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> Overall ranking, <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>2</sup></span> Unique team ID., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>3</sup></span> Chosen name of the team., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>4</sup></span> Their final submission date., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>5</sup></span> The accuracy score of model., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>6</sup></span> Total competition submissions., <span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>7</sup></span> Names of the team members.</div>\n      </td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}